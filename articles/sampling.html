<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Learn how to use sample_* functions.
">
<title>sampling • sgsR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="sampling">
<meta property="og:description" content="Learn how to use sample_* functions.
">
<meta property="og:image" content="/reference/figures/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-115082821-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-115082821-1');
</script><script defer data-domain="pkgdown.r-lib.org,all.tidyverse.org" src="https://plausible.io/js/plausible.js"></script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">sgsR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.3.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/sgsR.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/calculating.html">calculating</a>
    <a class="dropdown-item" href="../articles/sampling.html">sampling</a>
    <a class="dropdown-item" href="../articles/stratification.html">stratification</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/tgoodbody/sgsR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>sampling</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/tgoodbody/sgsR/blob/HEAD/vignettes/sampling.Rmd" class="external-link"><code>vignettes/sampling.Rmd</code></a></small>
      <div class="d-none name"><code>sampling.Rmd</code></div>
    </div>

    
    
<p>Currently, there are 8 functions associated with the <code>sample</code> verb in the <code>sgsR</code> package:</p>
<ul>
<li><p><code><a href="../reference/sample_srs.html">sample_srs()</a></code> - simple random sampling</p></li>
<li><p><code><a href="../reference/sample_systematic.html">sample_systematic()</a></code>- systematic sampling in a grid or hexagon tessellation</p></li>
<li><p><code><a href="../reference/sample_strat.html">sample_strat()</a></code> - stratified sampling within a <code>sraster</code></p></li>
<li><p><code><a href="../reference/sample_nc.html">sample_nc()</a></code> - Nearest centroid sampling. See <a href="https://doi.org/10.1080/00049158.2016.1218265" class="external-link">Melville &amp; Stone (2016)</a></p></li>
<li><p><code><a href="../reference/sample_clhs.html">sample_clhs()</a></code> - Latin hypercube sampling</p></li>
<li><p><code><a href="../reference/sample_balanced.html">sample_balanced()</a></code> - see <a href="http://www.antongrafstrom.se/balancedsampling/" class="external-link">BalancedSampling</a></p></li>
<li><p><code><a href="../reference/sample_ahels.html">sample_ahels()</a></code> - adapted hypercube evaluation of a legacy sample (ahels)</p></li>
<li><p><code><a href="../reference/sample_existing.html">sample_existing()</a></code> - Sub-sample within an existing sample using <a href="https://CRAN.R-project.org/package=clhs" class="external-link">clhs</a></p></li>
</ul>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="access">Access<a class="anchor" aria-label="anchor" href="#access"></a>
</h2>
<p>One key feature of using some <code>sample_*</code> functions is its ability to define <code>access</code> corridors. Users can supply a road <code>access</code> network (must be <code>sf</code> line objects) and define buffers around <code>access</code> where samples should be excluded and included.</p>
<p>Relevant and applicable parameters when <code>access</code> is defined are:</p>
<ul>
<li><p><code>buff_inner</code> - Can be left as <code>NULL</code> (default). Inner buffer parameter that defines the distance from <code>access</code> where samples cannot be taken (i.e. if you don’t want samples within 50 m of your <code>access</code> layer set <code>buff_inner = 50</code>).</p></li>
<li><p><code>buff_outer</code> - Outer buffer parameter that defines the maximum distance that the samples can be located from <code>access</code> (i.e. if you don’t want samples more than 200 meters from your <code>access</code> layer set <code>buff_inner = 200</code>).</p></li>
</ul>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="srs">
<code>sample_srs</code><a class="anchor" aria-label="anchor" href="#srs"></a>
</h2>
<p>We have demonstrated a simple example of using the <code><a href="../reference/sample_srs.html">sample_srs()</a></code> function in <code><a href="../articles/sgsR.html">vignette("sgsR")</a></code>. We will demonstrate additional examples below.</p>
<p>The input required for <code><a href="../reference/sample_srs.html">sample_srs()</a></code> is a <code>raster</code>. This means that <code>sraster</code> and <code>mraster</code> are supported for this function.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- perform simple random sampling ---#</span></span>
<span><span class="fu"><a href="../reference/sample_srs.html">sample_srs</a></span><span class="op">(</span>raster <span class="op">=</span> <span class="va">sraster</span>, <span class="co"># input sraster</span></span>
<span>           nSamp <span class="op">=</span> <span class="fl">200</span>, <span class="co"># number of desired samples</span></span>
<span>           plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># plot</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; Simple feature collection with 200 features and 0 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431110 ymin: 5337750 xmax: 438510 ymax: 5343230</span></span>
<span><span class="co">#&gt; CRS:           +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;                  geometry</span></span>
<span><span class="co">#&gt; 1  POINT (431870 5342990)</span></span>
<span><span class="co">#&gt; 2  POINT (431870 5342990)</span></span>
<span><span class="co">#&gt; 3  POINT (433230 5342190)</span></span>
<span><span class="co">#&gt; 4  POINT (437190 5340930)</span></span>
<span><span class="co">#&gt; 5  POINT (437610 5339470)</span></span>
<span><span class="co">#&gt; 6  POINT (435250 5342730)</span></span>
<span><span class="co">#&gt; 7  POINT (437990 5342870)</span></span>
<span><span class="co">#&gt; 8  POINT (436850 5342310)</span></span>
<span><span class="co">#&gt; 9  POINT (435210 5339730)</span></span>
<span><span class="co">#&gt; 10 POINT (432270 5341690)</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sample_srs.html">sample_srs</a></span><span class="op">(</span>raster <span class="op">=</span> <span class="va">mraster</span>, <span class="co"># input mraster</span></span>
<span>           nSamp <span class="op">=</span> <span class="fl">200</span>, <span class="co"># number of desired samples</span></span>
<span>           access <span class="op">=</span> <span class="va">access</span>, <span class="co"># define access road network</span></span>
<span>           mindist <span class="op">=</span> <span class="fl">200</span>, <span class="co"># minimum distance samples must be apart from one another</span></span>
<span>           buff_inner <span class="op">=</span> <span class="fl">50</span>, <span class="co"># inner buffer - no samples within this distance from road</span></span>
<span>           buff_outer <span class="op">=</span> <span class="fl">200</span>, <span class="co"># outer buffer - no samples further than this distance from road</span></span>
<span>           plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># plot</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; Simple feature collection with 200 features and 0 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431190 ymin: 5337710 xmax: 438530 ymax: 5343170</span></span>
<span><span class="co">#&gt; CRS:           +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;                  geometry</span></span>
<span><span class="co">#&gt; 1  POINT (435090 5337830)</span></span>
<span><span class="co">#&gt; 2  POINT (437810 5342750)</span></span>
<span><span class="co">#&gt; 3  POINT (434390 5339810)</span></span>
<span><span class="co">#&gt; 4  POINT (434870 5337810)</span></span>
<span><span class="co">#&gt; 5  POINT (435150 5339990)</span></span>
<span><span class="co">#&gt; 6  POINT (433030 5339530)</span></span>
<span><span class="co">#&gt; 7  POINT (433490 5340790)</span></span>
<span><span class="co">#&gt; 8  POINT (435230 5339170)</span></span>
<span><span class="co">#&gt; 9  POINT (433850 5342890)</span></span>
<span><span class="co">#&gt; 10 POINT (435850 5342810)</span></span></code></pre>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="systematic">
<code>sample_systematic</code><a class="anchor" aria-label="anchor" href="#systematic"></a>
</h2>
<p>The <code><a href="../reference/sample_systematic.html">sample_systematic()</a></code> function applies systematic sampling across an area with the <code>cellsize</code> parameter defining the resolution of the tessellation. The tessellation shape can be modified using the <code>square</code> parameter. Assigning <code>TRUE</code> (default) to the <code>square</code> parameter results in a regular grid and assigning <code>FALSE</code> results in a hexagonal grid. The location of samples can also be adjusted using the <code>locations</code> parameter, where <code>centers</code> takes the center, <code>corners</code> takes all corners, and <code>random</code> takes a random location within each tessellation.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- perform grid sampling ---#</span></span>
<span><span class="fu"><a href="../reference/sample_systematic.html">sample_systematic</a></span><span class="op">(</span>raster <span class="op">=</span> <span class="va">sraster</span>, <span class="co"># input sraster</span></span>
<span>                  cellsize <span class="op">=</span> <span class="fl">1000</span>, <span class="co"># grid distance</span></span>
<span>                  plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># plot</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; Simple feature collection with 38 features and 0 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431409.8 ymin: 5337789 xmax: 438559.4 ymax: 5343172</span></span>
<span><span class="co">#&gt; CRS:           +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;                    geometry</span></span>
<span><span class="co">#&gt; 1  POINT (431841.6 5337817)</span></span>
<span><span class="co">#&gt; 2  POINT (432292.7 5338710)</span></span>
<span><span class="co">#&gt; 3  POINT (433185.2 5338259)</span></span>
<span><span class="co">#&gt; 4  POINT (434077.7 5337808)</span></span>
<span><span class="co">#&gt; 5  POINT (431851.2 5340054)</span></span>
<span><span class="co">#&gt; 6  POINT (432743.7 5339602)</span></span>
<span><span class="co">#&gt; 7  POINT (433636.2 5339151)</span></span>
<span><span class="co">#&gt; 8  POINT (434528.7 5338700)</span></span>
<span><span class="co">#&gt; 9  POINT (435421.2 5338249)</span></span>
<span><span class="co">#&gt; 10 POINT (431409.8 5341397)</span></span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- perform grid sampling ---#</span></span>
<span><span class="fu"><a href="../reference/sample_systematic.html">sample_systematic</a></span><span class="op">(</span>raster <span class="op">=</span> <span class="va">sraster</span>, <span class="co"># input sraster</span></span>
<span>                  cellsize <span class="op">=</span> <span class="fl">500</span>, <span class="co"># grid distance</span></span>
<span>                  square <span class="op">=</span> <span class="cn">FALSE</span>, <span class="co"># hexagonal tessellation</span></span>
<span>                  location <span class="op">=</span> <span class="st">"random"</span>, <span class="co"># random sample within tessellation</span></span>
<span>                  plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># plot</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; Simple feature collection with 172 features and 0 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431129.5 ymin: 5337744 xmax: 438500.6 ymax: 5343226</span></span>
<span><span class="co">#&gt; CRS:           +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;                    geometry</span></span>
<span><span class="co">#&gt; 1  POINT (438437.5 5342803)</span></span>
<span><span class="co">#&gt; 2  POINT (437969.2 5343225)</span></span>
<span><span class="co">#&gt; 3  POINT (438358.2 5341610)</span></span>
<span><span class="co">#&gt; 4  POINT (437894.2 5342718)</span></span>
<span><span class="co">#&gt; 5  POINT (437997.5 5342005)</span></span>
<span><span class="co">#&gt; 6  POINT (438132.8 5341371)</span></span>
<span><span class="co">#&gt; 7  POINT (438394.1 5340167)</span></span>
<span><span class="co">#&gt; 8    POINT (437574 5342554)</span></span>
<span><span class="co">#&gt; 9  POINT (438059.9 5341385)</span></span>
<span><span class="co">#&gt; 10 POINT (438361.2 5340769)</span></span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sample_systematic.html">sample_systematic</a></span><span class="op">(</span>raster <span class="op">=</span> <span class="va">sraster</span>, <span class="co"># input sraster</span></span>
<span>            cellsize <span class="op">=</span> <span class="fl">500</span>, <span class="co"># grid distance</span></span>
<span>            access <span class="op">=</span> <span class="va">access</span>, <span class="co"># define access road network</span></span>
<span>            buff_outer <span class="op">=</span> <span class="fl">200</span>, <span class="co"># outer buffer - no samples further than this distance from road</span></span>
<span>            square <span class="op">=</span> <span class="cn">FALSE</span>, <span class="co"># hexagonal tessellation</span></span>
<span>            location <span class="op">=</span> <span class="st">"corners"</span>, <span class="co"># take corners instead of centers</span></span>
<span>            plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; Simple feature collection with 613 features and 0 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431113.2 ymin: 5337738 xmax: 438544.6 ymax: 5343216</span></span>
<span><span class="co">#&gt; CRS:           +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;                    geometry</span></span>
<span><span class="co">#&gt; 1  POINT (437762.5 5342869)</span></span>
<span><span class="co">#&gt; 2    POINT (437522 5343029)</span></span>
<span><span class="co">#&gt; 3    POINT (437522 5343029)</span></span>
<span><span class="co">#&gt; 4  POINT (437762.5 5342869)</span></span>
<span><span class="co">#&gt; 5    POINT (437985 5342421)</span></span>
<span><span class="co">#&gt; 6  POINT (437744.5 5342581)</span></span>
<span><span class="co">#&gt; 7  POINT (437762.5 5342869)</span></span>
<span><span class="co">#&gt; 8  POINT (436764.5 5342931)</span></span>
<span><span class="co">#&gt; 9    POINT (437522 5343029)</span></span>
<span><span class="co">#&gt; 10 POINT (437762.5 5342869)</span></span></code></pre>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="sstrat">
<code>sample_strat</code><a class="anchor" aria-label="anchor" href="#sstrat"></a>
</h2>
<p>The <code><a href="../reference/sample_strat.html">sample_strat()</a></code> contains two <code>method</code>s to perform sampling:</p>
<ul>
<li><p><code>"Queinnec"</code> - Hierarchical sampling using a focal window to isolate contiguous groups of stratum pixels, which was originally developed by Martin Queinnec.</p></li>
<li><p><code>"random"</code> - Traditional stratified random sampling. This <code>method</code> ignores much of the functionality of the algorithm to allow users the capability to use standard stratified random sampling approaches without the use of a focal window to locate contiguous stratum cells.</p></li>
</ul>
<div class="section level3 unnumbered">
<h3 class="unnumbered" id="queinnec">
<code>method = "Queinnec"</code><a class="anchor" aria-label="anchor" href="#queinnec"></a>
</h3>
<p><em>Queinnec, M., White, J. C., &amp; Coops, N. C. (2021). Comparing airborne and spaceborne photon-counting LiDAR canopy structural estimates across different boreal forest types. Remote Sensing of Environment, 262(August 2020), 112510.</em></p>
<p>This algorithm uses moving window (<code>wrow</code> and <code>wcol</code> parameters) to filter the input <code>sraster</code> to prioritize sample locations where stratum pixels are spatially grouped, rather than dispersed individuals across the landscape.</p>
<p>Sampling is performed using 2 rules:</p>
<ul>
<li><p><strong>Rule 1</strong> - Sample within spatially grouped stratum pixels. Moving window defined by <code>wrow</code> and <code>wcol</code>.</p></li>
<li><p><strong>Rule 2</strong> - If no more samples exist to satisfy desired sampling count, individual stratum pixels are sampled.</p></li>
</ul>
<p>The rule applied to a select a particular sample is defined in the <code>rule</code> attribute of output samples. We give a few examples below:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- perform stratified sampling random sampling ---#</span></span>
<span><span class="fu"><a href="../reference/sample_strat.html">sample_strat</a></span><span class="op">(</span>sraster <span class="op">=</span> <span class="va">sraster</span>, <span class="co"># input sraster</span></span>
<span>             nSamp <span class="op">=</span> <span class="fl">200</span>, <span class="co"># desired sample number</span></span>
<span>             plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># plot</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; Simple feature collection with 200 features and 3 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431110 ymin: 5337770 xmax: 438510 ymax: 5343230</span></span>
<span><span class="co">#&gt; CRS:           NA</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;    strata type  rule               geometry</span></span>
<span><span class="co">#&gt; x       1  new rule1 POINT (434110 5340750)</span></span>
<span><span class="co">#&gt; x1      1  new rule2 POINT (437630 5338370)</span></span>
<span><span class="co">#&gt; x2      1  new rule2 POINT (435690 5342190)</span></span>
<span><span class="co">#&gt; x3      1  new rule2 POINT (433930 5341470)</span></span>
<span><span class="co">#&gt; x4      1  new rule2 POINT (436710 5339130)</span></span>
<span><span class="co">#&gt; x5      1  new rule2 POINT (434590 5341870)</span></span>
<span><span class="co">#&gt; x6      1  new rule2 POINT (436070 5342650)</span></span>
<span><span class="co">#&gt; x7      1  new rule2 POINT (434290 5342610)</span></span>
<span><span class="co">#&gt; x8      1  new rule2 POINT (433210 5341530)</span></span>
<span><span class="co">#&gt; x9      1  new rule2 POINT (438290 5338470)</span></span></code></pre>
<p>In some cases, users might want to include <code>existing</code> samples within the algorithm. In order to adjust the total number of samples needed per stratum to reflect those already present in <code>existing</code>, we can use the intermediate function <code><a href="../reference/extract_strata.html">extract_strata()</a></code>.</p>
<p>This function uses the <code>sraster</code> and <code>existing</code> samples and extracts the stratum for each. These samples can be included within <code><a href="../reference/sample_strat.html">sample_strat()</a></code>, which adjusts total samples required per class based on representation in <code>existing</code>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- extract strata values to existing samples ---#              </span></span>
<span><span class="va">e.sr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_strata.html">extract_strata</a></span><span class="op">(</span>sraster <span class="op">=</span> <span class="va">sraster</span>, <span class="co"># input sraster</span></span>
<span>                       existing <span class="op">=</span> <span class="va">existing</span><span class="op">)</span> <span class="co"># existing samples to add strata value to</span></span></code></pre></div>
<p>Notice that <code>e.sr</code> now has an attribute named strata. If that parameter is not there, <code><a href="../reference/sample_strat.html">sample_strat()</a></code> will give an error.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sample_strat.html">sample_strat</a></span><span class="op">(</span>sraster <span class="op">=</span> <span class="va">sraster</span>, <span class="co"># input sraster</span></span>
<span>             nSamp <span class="op">=</span> <span class="fl">200</span>, <span class="co"># desired sample number</span></span>
<span>             access <span class="op">=</span> <span class="va">access</span>, <span class="co"># define access road network</span></span>
<span>             existing <span class="op">=</span> <span class="va">e.sr</span>, <span class="co"># existing samples with strata values</span></span>
<span>             mindist <span class="op">=</span> <span class="fl">200</span>, <span class="co"># minimum distance samples must be apart from one another</span></span>
<span>             buff_inner <span class="op">=</span> <span class="fl">50</span>, <span class="co"># inner buffer - no samples within this distance from road</span></span>
<span>             buff_outer <span class="op">=</span> <span class="fl">200</span>, <span class="co"># outer buffer - no samples further than this distance from road</span></span>
<span>             plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># plot</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; Simple feature collection with 400 features and 3 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431110 ymin: 5337710 xmax: 438530 ymax: 5343210</span></span>
<span><span class="co">#&gt; CRS:           NA</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;    strata     type     rule               geometry</span></span>
<span><span class="co">#&gt; 1       1 existing existing POINT (437770 5343030)</span></span>
<span><span class="co">#&gt; 2       1 existing existing POINT (435730 5342130)</span></span>
<span><span class="co">#&gt; 3       1 existing existing POINT (437590 5342530)</span></span>
<span><span class="co">#&gt; 4       1 existing existing POINT (431770 5339730)</span></span>
<span><span class="co">#&gt; 5       1 existing existing POINT (437610 5340650)</span></span>
<span><span class="co">#&gt; 6       1 existing existing POINT (437970 5343090)</span></span>
<span><span class="co">#&gt; 7       1 existing existing POINT (438090 5338030)</span></span>
<span><span class="co">#&gt; 8       1 existing existing POINT (432410 5338450)</span></span>
<span><span class="co">#&gt; 9       1 existing existing POINT (433710 5342990)</span></span>
<span><span class="co">#&gt; 10      1 existing existing POINT (433910 5341030)</span></span></code></pre>
<p>As seen on the code in the example above, the defined <code>mindist</code> parameter specifies the minimum euclidean distance that samples must be apart from one another.</p>
<p>Notice that the sample outputs have <code>type</code> and <code>rule</code> attributes which outline whether the samples are <code>existing</code> or <code>new</code> and whether <code>rule1</code> or <code>rule2</code> were used to select the individual samples. If <code>type</code> is <em>existing</em> (a user provided <code>existing</code> sample), <code>rule</code> will be <em>existing</em> as well as seen above.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sample_strat.html">sample_strat</a></span><span class="op">(</span>sraster <span class="op">=</span> <span class="va">sraster</span>, <span class="co"># input</span></span>
<span>             nSamp <span class="op">=</span> <span class="fl">200</span>, <span class="co"># desired sample number</span></span>
<span>             access <span class="op">=</span> <span class="va">access</span>, <span class="co"># define access road network</span></span>
<span>             existing <span class="op">=</span> <span class="va">e.sr</span>, <span class="co"># existing samples with strata values</span></span>
<span>             include <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># include existing plots in nSamp total</span></span>
<span>             buff_outer <span class="op">=</span> <span class="fl">200</span>, <span class="co"># outer buffer - no samples further than this distance from road</span></span>
<span>             plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># plot</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; Simple feature collection with 200 features and 3 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431110 ymin: 5337710 xmax: 438530 ymax: 5343210</span></span>
<span><span class="co">#&gt; CRS:           NA</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;    strata     type     rule               geometry</span></span>
<span><span class="co">#&gt; 1       1 existing existing POINT (437770 5343030)</span></span>
<span><span class="co">#&gt; 2       1 existing existing POINT (435730 5342130)</span></span>
<span><span class="co">#&gt; 3       1 existing existing POINT (437590 5342530)</span></span>
<span><span class="co">#&gt; 4       1 existing existing POINT (431770 5339730)</span></span>
<span><span class="co">#&gt; 5       1 existing existing POINT (437610 5340650)</span></span>
<span><span class="co">#&gt; 6       1 existing existing POINT (437970 5343090)</span></span>
<span><span class="co">#&gt; 7       1 existing existing POINT (438090 5338030)</span></span>
<span><span class="co">#&gt; 8       1 existing existing POINT (432410 5338450)</span></span>
<span><span class="co">#&gt; 9       1 existing existing POINT (433710 5342990)</span></span>
<span><span class="co">#&gt; 10      1 existing existing POINT (433910 5341030)</span></span></code></pre>
<p>The <code>include</code> parameter determines whether <code>existing</code> samples should be included in the total count of samples defined by <code>nSamp</code>. By default, the <code>include</code> parameter is set as <code>FALSE</code>.</p>
</div>
<div class="section level3 unnumbered">
<h3 class="unnumbered" id="stratrandom">
<code>method = "random</code><a class="anchor" aria-label="anchor" href="#stratrandom"></a>
</h3>
<p>Stratified random sampling with equal probability for all cells (using default algorithm values for <code>mindist</code> and no use of <code>access</code> functionality). In essence this method perform the <code>sample_srs</code> algorithm for each stratum separately to meet the specified sample allocation.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- perform stratified sampling random sampling ---#</span></span>
<span><span class="fu"><a href="../reference/sample_strat.html">sample_strat</a></span><span class="op">(</span>sraster <span class="op">=</span> <span class="va">sraster</span>, <span class="co"># input sraster</span></span>
<span>             method <span class="op">=</span> <span class="st">"random"</span>, <span class="co">#stratified random sampling</span></span>
<span>             nSamp <span class="op">=</span> <span class="fl">200</span>, <span class="co"># desired sample number</span></span>
<span>             plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># plot</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; Simple feature collection with 200 features and 1 field</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431270 ymin: 5337750 xmax: 438530 ymax: 5343210</span></span>
<span><span class="co">#&gt; Projected CRS: UTM Zone 17, Northern Hemisphere</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;    strata               geometry</span></span>
<span><span class="co">#&gt; 1       1 POINT (436970 5342910)</span></span>
<span><span class="co">#&gt; 2       1 POINT (436970 5342910)</span></span>
<span><span class="co">#&gt; 3       1 POINT (435090 5342730)</span></span>
<span><span class="co">#&gt; 4       1 POINT (435690 5338210)</span></span>
<span><span class="co">#&gt; 5       1 POINT (433190 5341570)</span></span>
<span><span class="co">#&gt; 6       1 POINT (437890 5338130)</span></span>
<span><span class="co">#&gt; 7       1 POINT (435850 5342990)</span></span>
<span><span class="co">#&gt; 8       1 POINT (438350 5337750)</span></span>
<span><span class="co">#&gt; 9       1 POINT (438270 5338270)</span></span>
<span><span class="co">#&gt; 10      1 POINT (437950 5342510)</span></span></code></pre>
</div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="nc">
<code>sample_nc</code><a class="anchor" aria-label="anchor" href="#nc"></a>
</h2>
<p><code><a href="../reference/sample_nc.html">sample_nc()</a></code> function implements the Nearest Centroid sampling algorithm described in <a href="https://doi.org/10.1080/00049158.2016.1218265" class="external-link">Melville &amp; Stone (2016)</a>. The algorithm uses kmeans clustering where the number of clusters (centroids) is equal to the desired number of samples (<code>nSamp</code>). Cluster centers are located, which then prompts the nearest neighbour <code>mraster</code> pixel for each cluster to be located (assuming default <code>k</code> parameter). These nearest neighbours are the output samples. Basic usage is as follows:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- perform simple random sampling ---#</span></span>
<span><span class="fu"><a href="../reference/sample_nc.html">sample_nc</a></span><span class="op">(</span>mraster <span class="op">=</span> <span class="va">mraster</span>, <span class="co"># input</span></span>
<span>          nSamp <span class="op">=</span> <span class="fl">25</span>, <span class="co"># desired sample number</span></span>
<span>          plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; K-means being performed on 3 layers with 25 centers.</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; Simple feature collection with 25 features and 4 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431370 ymin: 5338050 xmax: 437950 ymax: 5342670</span></span>
<span><span class="co">#&gt; CRS:           +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;        zq90 pzabove2  zsd kcenter               geometry</span></span>
<span><span class="co">#&gt; 43226  5.81     57.2 1.34       1 POINT (437710 5340930)</span></span>
<span><span class="co">#&gt; 50219 21.80     91.9 5.60       2 POINT (435830 5340550)</span></span>
<span><span class="co">#&gt; 96780 11.40     91.3 2.55       3 POINT (434550 5338050)</span></span>
<span><span class="co">#&gt; 32884 16.10     89.4 3.83       4 POINT (432290 5341470)</span></span>
<span><span class="co">#&gt; 93149  8.06     82.7 1.78       5 POINT (436530 5338250)</span></span>
<span><span class="co">#&gt; 67382  8.55     38.0 2.25       6 POINT (435930 5339630)</span></span>
<span><span class="co">#&gt; 78170 20.80     25.4 6.82       7 POINT (435350 5339050)</span></span>
<span><span class="co">#&gt; 51686  9.73     58.8 2.52       8 POINT (435330 5340470)</span></span>
<span><span class="co">#&gt; 82930 23.10     88.5 6.77       9 POINT (433570 5338790)</span></span>
<span><span class="co">#&gt; 42413 17.40     82.4 4.59      10 POINT (436370 5340970)</span></span></code></pre>
<p>Altering the <code>k</code> parameter leads to a multiplicative increase in output samples where total output samples = <span class="math inline">\(`nSamp` * `k`\)</span>.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- perform simple random sampling ---#</span></span>
<span><span class="va">samples</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sample_nc.html">sample_nc</a></span><span class="op">(</span>mraster <span class="op">=</span> <span class="va">mraster</span>, <span class="co"># input</span></span>
<span>                    k <span class="op">=</span> <span class="fl">2</span>, <span class="co"># number of nearest neighbours to take for each kmeans center</span></span>
<span>                    nSamp <span class="op">=</span> <span class="fl">25</span>, <span class="co"># desired sample number</span></span>
<span>                    plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; K-means being performed on 3 layers with 25 centers.</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">#--- total samples = nSamp * k (25 * 2) = 50 ---#</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">samples</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 50</span></span></code></pre></div>
<p>Visualizing what the kmeans centers and samples nearest neighbours looks like is possible when using <code>details = TRUE</code>. The <code>$kplot</code> output provides a quick visualization of where the centers are based on a scatter plot of the first 2 layers in <code>mraster</code>. Notice that the centers are well distributed in covariate space and chosen samples are the closest pixels to each center (nearest neighbours).</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- perform simple random sampling with details ---#</span></span>
<span><span class="va">details</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sample_nc.html">sample_nc</a></span><span class="op">(</span>mraster <span class="op">=</span> <span class="va">mraster</span>, <span class="co"># input</span></span>
<span>                     nSamp <span class="op">=</span> <span class="fl">25</span>, <span class="co"># desired sample number</span></span>
<span>                     details <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; K-means being performed on 3 layers with 25 centers.</span></span>
<span></span>
<span><span class="co">#--- plot ggplot output ---#</span></span>
<span></span>
<span><span class="va">details</span><span class="op">$</span><span class="va">kplot</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="clhs">
<code>sample_clhs</code><a class="anchor" aria-label="anchor" href="#clhs"></a>
</h2>
<p><code><a href="../reference/sample_clhs.html">sample_clhs()</a></code> function implements conditioned Latin hypercube (clhs) sampling methodology from the <a href="https://CRAN.R-project.org/package=clhs/" class="external-link"><code>clhs</code></a> package. A number of other functions in the <code>sgsR</code> package help to provide guidance on clhs sampling including <code><a href="../reference/calculate_pop.html">calculate_pop()</a></code> and <code><a href="../reference/calculate_lhsOpt.html">calculate_lhsOpt()</a></code>. Check out these functions to better understand how sample numbers could be optimized.</p>
<p>The syntax for this function is similar to others shown above, although parameters like <code>iter</code>, which define the number of iterations within the Metropolis-Hastings process are important to consider. In these examples we use a low <code>iter</code> value because it takes less time to run. Default values for <code>iter</code> within the <code>clhs</code> package are 10,000.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sample_clhs.html">sample_clhs</a></span><span class="op">(</span>mraster <span class="op">=</span> <span class="va">mraster</span>, <span class="co"># input</span></span>
<span>            nSamp <span class="op">=</span> <span class="fl">200</span>, <span class="co"># desired sample number</span></span>
<span>            plot <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># plot </span></span>
<span>            iter <span class="op">=</span> <span class="fl">100</span><span class="op">)</span> <span class="co"># number of iterations</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sample_clhs.html">sample_clhs</a></span><span class="op">(</span>mraster <span class="op">=</span> <span class="va">mraster</span>, <span class="co"># input</span></span>
<span>            nSamp <span class="op">=</span> <span class="fl">300</span>, <span class="co"># desired sample number</span></span>
<span>            iter <span class="op">=</span> <span class="fl">100</span>, <span class="co"># number of iterations</span></span>
<span>            existing <span class="op">=</span> <span class="va">existing</span>, <span class="co"># existing samples</span></span>
<span>            access <span class="op">=</span> <span class="va">access</span>, <span class="co"># define access road network</span></span>
<span>            buff_inner <span class="op">=</span> <span class="fl">100</span>, <span class="co"># inner buffer - no samples within this distance from road</span></span>
<span>            buff_outer <span class="op">=</span> <span class="fl">300</span>, <span class="co"># outer buffer - no samples further than this distance from road</span></span>
<span>            plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># plot</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-19-1.png" width="700"></p>
<p>The <code>cost</code> parameter defines the <code>mraster</code> covariate, which is used to constrain the clhs sampling. This could be any number of variables. An example could be the distance a pixel is from road <code>access</code> (e.g. from <code><a href="../reference/calculate_distance.html">calculate_distance()</a></code> see example below), terrain slope, the output from <code><a href="../reference/calculate_coobs.html">calculate_coobs()</a></code>, or many others.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- cost constrained examples ---#</span></span>
<span><span class="co">#--- calculate distance to access layer for each pixel in mr ---#</span></span>
<span><span class="va">mr.c</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_distance.html">calculate_distance</a></span><span class="op">(</span>raster <span class="op">=</span> <span class="va">mraster</span>, <span class="co"># input</span></span>
<span>                           access <span class="op">=</span> <span class="va">access</span>,</span>
<span>                           plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># define access road network</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-20-1.png" width="700"></p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sample_clhs.html">sample_clhs</a></span><span class="op">(</span>mraster <span class="op">=</span> <span class="va">mr.c</span>, <span class="co"># input</span></span>
<span>            nSamp <span class="op">=</span> <span class="fl">250</span>, <span class="co"># desired sample number</span></span>
<span>            iter <span class="op">=</span> <span class="fl">100</span>, <span class="co"># number of iterations</span></span>
<span>            cost <span class="op">=</span> <span class="st">"dist2access"</span>, <span class="co"># cost parameter - name defined in calculate_distance()</span></span>
<span>            plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># plot</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-22-1.png" width="700"></p>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="balanced">
<code>sample_balanced</code><a class="anchor" aria-label="anchor" href="#balanced"></a>
</h2>
<p>The <code><a href="../reference/sample_balanced.html">sample_balanced()</a></code> algorithm performs a balanced sampling methodology from the <a href="http://www.antongrafstrom.se/balancedsampling/" class="external-link"><code>stratifyR / SamplingBigData</code></a> packages.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sample_balanced.html">sample_balanced</a></span><span class="op">(</span>mraster <span class="op">=</span> <span class="va">mraster</span>, <span class="co"># input</span></span>
<span>                nSamp <span class="op">=</span> <span class="fl">200</span>, <span class="co"># desired sample number</span></span>
<span>                plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># plot</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-23-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; Simple feature collection with 200 features and 0 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431150 ymin: 5337750 xmax: 438490 ymax: 5343190</span></span>
<span><span class="co">#&gt; CRS:           +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;                  geometry</span></span>
<span><span class="co">#&gt; 1  POINT (436170 5343190)</span></span>
<span><span class="co">#&gt; 2  POINT (435950 5343170)</span></span>
<span><span class="co">#&gt; 3  POINT (432550 5343090)</span></span>
<span><span class="co">#&gt; 4  POINT (431870 5343070)</span></span>
<span><span class="co">#&gt; 5  POINT (432150 5343070)</span></span>
<span><span class="co">#&gt; 6  POINT (437370 5342990)</span></span>
<span><span class="co">#&gt; 7  POINT (432070 5342950)</span></span>
<span><span class="co">#&gt; 8  POINT (432410 5342910)</span></span>
<span><span class="co">#&gt; 9  POINT (433670 5342890)</span></span>
<span><span class="co">#&gt; 10 POINT (434130 5342810)</span></span></code></pre>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sample_balanced.html">sample_balanced</a></span><span class="op">(</span>mraster <span class="op">=</span> <span class="va">mraster</span>, <span class="co"># input</span></span>
<span>                nSamp <span class="op">=</span> <span class="fl">100</span>, <span class="co"># desired sample number</span></span>
<span>                algorithm <span class="op">=</span> <span class="st">"lcube"</span>, <span class="co"># algorithm type</span></span>
<span>                access <span class="op">=</span> <span class="va">access</span>, <span class="co"># define access road network</span></span>
<span>                buff_inner <span class="op">=</span> <span class="fl">50</span>, <span class="co"># inner buffer - no samples within this distance from road</span></span>
<span>                buff_outer <span class="op">=</span> <span class="fl">200</span><span class="op">)</span> <span class="co"># outer buffer - no samples further than this distance from road</span></span>
<span><span class="co">#&gt; Simple feature collection with 100 features and 0 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431190 ymin: 5337830 xmax: 438430 ymax: 5343230</span></span>
<span><span class="co">#&gt; CRS:           +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;                  geometry</span></span>
<span><span class="co">#&gt; 1  POINT (432890 5342890)</span></span>
<span><span class="co">#&gt; 2  POINT (434150 5343170)</span></span>
<span><span class="co">#&gt; 3  POINT (433990 5337970)</span></span>
<span><span class="co">#&gt; 4  POINT (432790 5340670)</span></span>
<span><span class="co">#&gt; 5  POINT (435650 5342490)</span></span>
<span><span class="co">#&gt; 6  POINT (436150 5339370)</span></span>
<span><span class="co">#&gt; 7  POINT (431990 5342650)</span></span>
<span><span class="co">#&gt; 8  POINT (431850 5338370)</span></span>
<span><span class="co">#&gt; 9  POINT (432410 5339370)</span></span>
<span><span class="co">#&gt; 10 POINT (431930 5338610)</span></span></code></pre></div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="ahels">
<code>sample_ahels</code><a class="anchor" aria-label="anchor" href="#ahels"></a>
</h2>
<p>The <code><a href="../reference/sample_ahels.html">sample_ahels()</a></code> function performs the adapted Hypercube Evaluation of a Legacy Sample (ahels) algorithm using<code>existing</code> sample data and an <code>mraster</code>. New samples are allocated based on quantile ratios between the <code>existing</code> sample and <code>mraster</code> covariate dataset.</p>
<p>This algorithm was adapted from that presented in the paper below, which we highly recommend.</p>
<p><em>Malone BP, Minansy B, Brungard C. 2019. Some methods to improve the utility of conditioned Latin hypercube sampling. PeerJ 7:e6451 DOI 10.7717/peerj.6451</em></p>
<p>This algorithm:</p>
<ol style="list-style-type: decimal">
<li><p>Determines the quantile distributions of <code>existing</code> samples and <code>mraster</code> covariates.</p></li>
<li><p>Determines quantiles where there is a disparity between samples and covariates.</p></li>
<li><p>Prioritizes sampling within those quantile to improve representation.</p></li>
</ol>
<p>To use this function, user must first specify the number of quantiles (<code>nQuant</code>) followed by either the <code>nSamp</code> (total number of desired samples to be added) or the <code>threshold</code> (sampling ratio vs. covariate coverage ratio for quantiles - default is 0.9) parameters. We recommended you setting the <code>threshold</code> values at or below 0.9.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sample_ahels.html">sample_ahels</a></span><span class="op">(</span>mraster <span class="op">=</span> <span class="va">mraster</span>, </span>
<span>             existing <span class="op">=</span> <span class="va">existing</span>, <span class="co"># existing samples</span></span>
<span>             plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># plot</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-26-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; Simple feature collection with 230 features and 7 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431110 ymin: 5337710 xmax: 438530 ymax: 5343210</span></span>
<span><span class="co">#&gt; CRS:           +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;      type.x zq90 pzabove2  zsd strata type.y  rule</span></span>
<span><span class="co">#&gt; 1  existing 2.15      0.2 0.29      1    new rule1</span></span>
<span><span class="co">#&gt; 2  existing 6.08     26.9 1.48      1    new rule2</span></span>
<span><span class="co">#&gt; 3  existing 2.65      2.3 1.08      1    new rule2</span></span>
<span><span class="co">#&gt; 4  existing 9.26     37.1 2.54      1    new rule2</span></span>
<span><span class="co">#&gt; 5  existing 9.41     29.0 2.88      1    new rule2</span></span>
<span><span class="co">#&gt; 6  existing 4.22      6.8 0.94      1    new rule2</span></span>
<span><span class="co">#&gt; 7  existing 3.83     26.1 0.85      1    new rule2</span></span>
<span><span class="co">#&gt; 8  existing 9.62     67.6 2.70      1    new rule2</span></span>
<span><span class="co">#&gt; 9  existing 5.98     53.9 1.34      1    new rule2</span></span>
<span><span class="co">#&gt; 10 existing 4.79     30.5 1.07      1    new rule2</span></span>
<span><span class="co">#&gt;                  geometry</span></span>
<span><span class="co">#&gt; 1  POINT (437770 5343030)</span></span>
<span><span class="co">#&gt; 2  POINT (435730 5342130)</span></span>
<span><span class="co">#&gt; 3  POINT (437590 5342530)</span></span>
<span><span class="co">#&gt; 4  POINT (431770 5339730)</span></span>
<span><span class="co">#&gt; 5  POINT (437610 5340650)</span></span>
<span><span class="co">#&gt; 6  POINT (437970 5343090)</span></span>
<span><span class="co">#&gt; 7  POINT (438090 5338030)</span></span>
<span><span class="co">#&gt; 8  POINT (432410 5338450)</span></span>
<span><span class="co">#&gt; 9  POINT (433710 5342990)</span></span>
<span><span class="co">#&gt; 10 POINT (433910 5341030)</span></span></code></pre>
<p>Notice that no <code>threshold</code>, <code>nSamp</code>, or <code>nQuant</code> were defined. That is because the default setting for <code>threshold = 0.9</code> and <code>nQuant = 10</code>.</p>
<p>The first matrix output shows the quantile ratios between the sample and the covariates. A value of 1.0 indicates that samples are represented relative to the quantile coverage. Values &gt; 1.0 indicate over representation of samples, while &lt; 1.0 indicate under representation of samples.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sample_ahels.html">sample_ahels</a></span><span class="op">(</span>mraster <span class="op">=</span> <span class="va">mraster</span>, </span>
<span>             existing <span class="op">=</span> <span class="va">existing</span>, <span class="co"># existing samples</span></span>
<span>             nQuant <span class="op">=</span> <span class="fl">20</span>, <span class="co"># define 20 quantiles</span></span>
<span>             nSamp <span class="op">=</span> <span class="fl">300</span><span class="op">)</span> <span class="co"># total samples desired</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-29-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; Simple feature collection with 500 features and 7 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431110 ymin: 5337710 xmax: 438550 ymax: 5343230</span></span>
<span><span class="co">#&gt; CRS:           +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;      type.x zq90 pzabove2  zsd strata type.y  rule</span></span>
<span><span class="co">#&gt; 1  existing 2.15      0.2 0.29      1    new rule1</span></span>
<span><span class="co">#&gt; 2  existing 6.08     26.9 1.48      1    new rule2</span></span>
<span><span class="co">#&gt; 3  existing 2.65      2.3 1.08      1    new rule2</span></span>
<span><span class="co">#&gt; 4  existing 9.26     37.1 2.54      1    new rule2</span></span>
<span><span class="co">#&gt; 5  existing 9.41     29.0 2.88      1    new rule2</span></span>
<span><span class="co">#&gt; 6  existing 4.22      6.8 0.94      1    new rule2</span></span>
<span><span class="co">#&gt; 7  existing 3.83     26.1 0.85      1    new rule2</span></span>
<span><span class="co">#&gt; 8  existing 9.62     67.6 2.70      1    new rule2</span></span>
<span><span class="co">#&gt; 9  existing 5.98     53.9 1.34      1    new rule2</span></span>
<span><span class="co">#&gt; 10 existing 4.79     30.5 1.07      1    new rule2</span></span>
<span><span class="co">#&gt;                  geometry</span></span>
<span><span class="co">#&gt; 1  POINT (437770 5343030)</span></span>
<span><span class="co">#&gt; 2  POINT (435730 5342130)</span></span>
<span><span class="co">#&gt; 3  POINT (437590 5342530)</span></span>
<span><span class="co">#&gt; 4  POINT (431770 5339730)</span></span>
<span><span class="co">#&gt; 5  POINT (437610 5340650)</span></span>
<span><span class="co">#&gt; 6  POINT (437970 5343090)</span></span>
<span><span class="co">#&gt; 7  POINT (438090 5338030)</span></span>
<span><span class="co">#&gt; 8  POINT (432410 5338450)</span></span>
<span><span class="co">#&gt; 9  POINT (433710 5342990)</span></span>
<span><span class="co">#&gt; 10 POINT (433910 5341030)</span></span></code></pre>
<p>Notice that the total number of samples is 500. This value is the sum of existing samples (200) and number of samples defined by <code>nSamp = 300</code>.</p>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="samp-existing">
<code>sample_existing</code><a class="anchor" aria-label="anchor" href="#samp-existing"></a>
</h2>
<p>Acknowledging that <code>existing</code> sample networks exist is important. There is significant investment into these samples, and in order to keep inventories up-to-date, we often need to collect new data at these locations. The <code>sample_existing</code> algorithm provides a method for sub-sampling an <code>existing</code> sample network should the financial / logistical resources not be available to collect data at all sample units. The algorithm leverages latin hypercube sampling using the <a href="https://CRAN.R-project.org/package=clhs" class="external-link">clhs</a> package to effectively sample within an <code>existing</code> network.</p>
<p>The algorithm has two fundamental approaches:</p>
<ol style="list-style-type: decimal">
<li><p>Sample exclusively using the sample network and the attributes it contains</p></li>
<li><p>Should <code>raster</code> information be available and co-located with the sample, use these data as population values to improve sub-sampling of <code>existing</code>.</p></li>
</ol>
<p>Much like the <code><a href="../reference/sample_clhs.html">sample_clhs()</a></code> algorithm, users can define a <code>cost</code> parameter, which will be used to constrain sub-sampling. A cost parameters is a user defined metric/attribute such as distance from roads (e.g. <code><a href="../reference/calculate_distance.html">calculate_distance()</a></code>), elevation, etc.</p>
<p>Here some some basic examples:</p>
<div class="section level3">
<h3 id="basic-sub-sampling-of-existing">Basic sub-sampling of <code>existing</code><a class="anchor" aria-label="anchor" href="#basic-sub-sampling-of-existing"></a>
</h3>
<p>First we can create an existing dataset for our example. Lets imagine we have a systematically sampled dataset of ~900 samples, and we know we only have resources to sample 300 of them. We have some ALS data available (<code>mraster</code>), which we will use as our distributions to sample within.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- generate existing samples and extract metrics ---#</span></span>
<span><span class="va">existing</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sample_systematic.html">sample_systematic</a></span><span class="op">(</span>raster <span class="op">=</span> <span class="va">mraster</span>, cellsize <span class="op">=</span> <span class="fl">200</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="../reference/extract_metrics.html">extract_metrics</a></span><span class="op">(</span>mraster <span class="op">=</span> <span class="va">mraster</span>, existing <span class="op">=</span> <span class="va">.</span><span class="op">)</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-31-1.png" width="700"></p>
<p>We see our systematic sample. Notice that we used <code><a href="../reference/extract_metrics.html">extract_metrics()</a></code> after creating it. If the user provides a <code>raster</code> for the algorithm this isn’t neccesary, it will be handled internally in the algorithm if no attributes are present, but if only samples are given, attributes must be provided and <em>sampling will be conducted on all included attributes</em>. Now lets sub-sample within it.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- sub sample using ---#</span></span>
<span><span class="fu"><a href="../reference/sample_existing.html">sample_existing</a></span><span class="op">(</span>existing <span class="op">=</span> <span class="va">existing</span>, <span class="co"># our existing sample</span></span>
<span>                nSamp <span class="op">=</span> <span class="fl">300</span>, <span class="co"># the number of samples we want</span></span>
<span>                plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># plot</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-32-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; Simple feature collection with 300 features and 3 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431143.1 ymin: 5337701 xmax: 438530.1 ymax: 5343189</span></span>
<span><span class="co">#&gt; CRS:           +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;      zq90 pzabove2  zsd                 geometry</span></span>
<span><span class="co">#&gt; 205 18.70     86.5 4.67 POINT (432524.1 5341100)</span></span>
<span><span class="co">#&gt; 312 17.50     85.9 4.66 POINT (432997.8 5341981)</span></span>
<span><span class="co">#&gt; 858 20.10     84.9 5.75 POINT (437144.9 5343021)</span></span>
<span><span class="co">#&gt; 766  9.46     34.0 2.66 POINT (438423.6 5337882)</span></span>
<span><span class="co">#&gt; 572  6.08     34.9 1.35 POINT (435976.2 5339834)</span></span>
<span><span class="co">#&gt; 623 11.90     84.1 2.54 POINT (436591.4 5339458)</span></span>
<span><span class="co">#&gt; 696 16.80     57.2 4.78 POINT (436967.7 5340073)</span></span>
<span><span class="co">#&gt; 101 14.40     75.9 4.29 POINT (432218.6 5339857)</span></span>
<span><span class="co">#&gt; 191  3.67      5.2 0.70 POINT (433603.8 5338294)</span></span>
<span><span class="co">#&gt; 147 13.30     95.0 2.67 POINT (431908.9 5341476)</span></span></code></pre>
<p>We see from the output that we get 300 samples that are a sub-sample of the original <code>existing</code> sample. The plotted output shows sumulative frequency distributions of the population (all <code>existing</code> samples) and the sub-sample (the 300 samples we requested). Notice that the distributions match quite well. This is a simple example, so lets do another with a bit more complexity.</p>
</div>
<div class="section level3">
<h3 id="sub-sampling-using-raster-distributions">Sub-sampling using <code>raster</code> distributions<a class="anchor" aria-label="anchor" href="#sub-sampling-using-raster-distributions"></a>
</h3>
<p>Our systematic sample of ~900 plots is fairly comprehensive, however we can generate a true population distribution through the inclusion of the ALS metrics in the sampling process. The metrics will be included in internal latin hypercube sampling to help guide sub-sampling of <code>existing</code>.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- sub sample using ---#</span></span>
<span><span class="fu"><a href="../reference/sample_existing.html">sample_existing</a></span><span class="op">(</span>existing <span class="op">=</span> <span class="va">existing</span>, <span class="co"># our existing sample</span></span>
<span>                nSamp <span class="op">=</span> <span class="fl">300</span>, <span class="co"># the number of samples we want</span></span>
<span>                raster <span class="op">=</span> <span class="va">mraster</span>, <span class="co"># include mraster metrics to guide sampling of existing</span></span>
<span>                plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># plot</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-33-1.png" width="700"><img src="sampling_files/figure-html/unnamed-chunk-33-2.png" width="700"></p>
<pre><code><span><span class="co">#&gt; Simple feature collection with 300 features and 3 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431116.5 ymin: 5337701 xmax: 438556.7 ymax: 5343225</span></span>
<span><span class="co">#&gt; CRS:           +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;         zq90 pzabove2  zsd                 geometry</span></span>
<span><span class="co">#&gt; 3172    4.73     16.7 1.16 POINT (433418.2 5341074)</span></span>
<span><span class="co">#&gt; 202100 18.30     90.8 3.43 POINT (432271.9 5341645)</span></span>
<span><span class="co">#&gt; 9026   14.70     72.8 3.67 POINT (431293.8 5341853)</span></span>
<span><span class="co">#&gt; 86115  13.90     86.6 3.62 POINT (437481.2 5342295)</span></span>
<span><span class="co">#&gt; 271    15.50     93.5 3.40 POINT (434232.3 5338365)</span></span>
<span><span class="co">#&gt; 674    10.70     88.0 2.78 POINT (436954.3 5339626)</span></span>
<span><span class="co">#&gt; 58619  11.60     92.5 2.92 POINT (435148.8 5342096)</span></span>
<span><span class="co">#&gt; 69760  14.30     85.7 3.81 POINT (437051.7 5339892)</span></span>
<span><span class="co">#&gt; 77432  24.00     91.9 6.47 POINT (436755.3 5341958)</span></span>
<span><span class="co">#&gt; 58719   6.64     28.7 1.62 POINT (435232.8 5341914)</span></span></code></pre>
<p>The sample distribution again mimics the population distribution quite well! Now lets try using a cost variable to constrain the sub-sample.</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- create distance from roads metric ---#</span></span>
<span><span class="va">dist</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_distance.html">calculate_distance</a></span><span class="op">(</span>raster <span class="op">=</span> <span class="va">mraster</span>, access <span class="op">=</span> <span class="va">access</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- sub sample using ---#</span></span>
<span><span class="fu"><a href="../reference/sample_existing.html">sample_existing</a></span><span class="op">(</span>existing <span class="op">=</span> <span class="va">existing</span>, <span class="co"># our existing sample</span></span>
<span>                nSamp <span class="op">=</span> <span class="fl">300</span>, <span class="co"># the number of samples we want</span></span>
<span>                raster <span class="op">=</span> <span class="va">dist</span>, <span class="co"># include mraster metrics to guide sampling of existing</span></span>
<span>                cost <span class="op">=</span> <span class="fl">4</span>, <span class="co"># either provide the index (band number) or the name of the cost layer</span></span>
<span>                plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># plot</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-35-1.png" width="700"><img src="sampling_files/figure-html/unnamed-chunk-35-2.png" width="700"></p>
<pre><code><span><span class="co">#&gt; Simple feature collection with 300 features and 4 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431138.9 ymin: 5337719 xmax: 438547.6 ymax: 5343238</span></span>
<span><span class="co">#&gt; CRS:           +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;         zq90 pzabove2  zsd dist2access                 geometry</span></span>
<span><span class="co">#&gt; 34514   5.44     19.4 1.26   164.09970 POINT (433515.5 5341339)</span></span>
<span><span class="co">#&gt; 21248   8.12     24.8 2.24   330.99032 POINT (433196.8 5339648)</span></span>
<span><span class="co">#&gt; 669    17.90     63.5 5.47    92.36116 POINT (436365.8 5340896)</span></span>
<span><span class="co">#&gt; 4109   18.50     91.2 4.57   286.59300 POINT (434298.9 5340600)</span></span>
<span><span class="co">#&gt; 51354  10.70     69.1 2.78   116.15620 POINT (434436.2 5342207)</span></span>
<span><span class="co">#&gt; 83413  10.60     64.1 2.75    52.68131 POINT (438043.2 5340131)</span></span>
<span><span class="co">#&gt; 37512   9.37     47.4 2.48   130.14300 POINT (433612.9 5341605)</span></span>
<span><span class="co">#&gt; 89264  20.10     74.3 5.99   260.02616 POINT (438348.6 5341374)</span></span>
<span><span class="co">#&gt; 281    15.40     75.4 3.72    60.28383 POINT (432732.2 5342078)</span></span>
<span><span class="co">#&gt; 340100 16.90     83.4 4.50    13.80531 POINT (433095.1 5342246)</span></span></code></pre>
<p>Finally, should the user wish to further constrain the sample based on <code>access</code> like other sampling approaches in <code>sgsR</code> that is also possible.</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- ensure access and existing are in the same CRS ---#</span></span>
<span></span>
<span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html" class="external-link">st_crs</a></span><span class="op">(</span><span class="va">existing</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html" class="external-link">st_crs</a></span><span class="op">(</span><span class="va">access</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#--- sub sample using ---#</span></span>
<span><span class="fu"><a href="../reference/sample_existing.html">sample_existing</a></span><span class="op">(</span>existing <span class="op">=</span> <span class="va">existing</span>, <span class="co"># our existing sample</span></span>
<span>                nSamp <span class="op">=</span> <span class="fl">300</span>, <span class="co"># the number of samples we want</span></span>
<span>                raster <span class="op">=</span> <span class="va">dist</span>, <span class="co"># include mraster metrics to guide sampling of existing</span></span>
<span>                cost <span class="op">=</span> <span class="fl">4</span>, <span class="co"># either provide the index (band number) or the name of the cost layer</span></span>
<span>                access <span class="op">=</span> <span class="va">access</span>, <span class="co"># roads layer</span></span>
<span>                buff_inner <span class="op">=</span> <span class="fl">50</span>, <span class="co"># inner buffer - no samples within this distance from road</span></span>
<span>                buff_outer <span class="op">=</span> <span class="fl">300</span>, <span class="co"># outer buffer - no samples further than this distance from road</span></span>
<span>                plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># plot</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-36-1.png" width="700"><img src="sampling_files/figure-html/unnamed-chunk-36-2.png" width="700"></p>
<pre><code><span><span class="co">#&gt; Simple feature collection with 300 features and 4 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431138.9 ymin: 5337710 xmax: 438547.6 ymax: 5343229</span></span>
<span><span class="co">#&gt; Projected CRS: UTM_Zone_17_Northern_Hemisphere</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;         zq90 pzabove2       zsd dist2access                 geometry</span></span>
<span><span class="co">#&gt; 16019   2.70      8.6 0.4500000    78.03361 POINT (433683.7 5340976)</span></span>
<span><span class="co">#&gt; 165100  4.36      2.8 0.9899999   107.65456 POINT (434440.4 5339343)</span></span>
<span><span class="co">#&gt; 210100 21.60     87.4 5.7799997   192.70029 POINT (435560.1 5337878)</span></span>
<span><span class="co">#&gt; 3261    3.80     32.0 0.8000000   179.49975 POINT (435343.5 5342627)</span></span>
<span><span class="co">#&gt; 40846  19.00     90.6 4.9200001   117.66977 POINT (436516.4 5342950)</span></span>
<span><span class="co">#&gt; 14512  12.70     87.8 2.8199999   101.75737 POINT (433754.5 5340348)</span></span>
<span><span class="co">#&gt; 741    19.90     91.6 4.6100001   163.15552   POINT (432068 5337803)</span></span>
<span><span class="co">#&gt; 355100 19.00     84.7 4.1900001   144.72213 POINT (436463.2 5341162)</span></span>
<span><span class="co">#&gt; 1041   12.60     62.1 3.5200000   148.88256 POINT (432718.9 5341631)</span></span>
<span><span class="co">#&gt; 267     6.42     77.1 1.2500000   130.18504 POINT (434197.3 5343198)</span></span></code></pre>
<p>The greater constraints we add to the samples, the less likely we will have strong correlations between the population and sample, so its always important to understand these limitations and plan accordingly.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://scholar.google.ca/citations?user=C_qdYDsAAAAJ&amp;hl=en" class="external-link">Tristan RH Goodbody</a>, <a href="https://forestry.ubc.ca/faculty-profile/nicholas-coops/" class="external-link">Nicholas C Coops</a>, <a href="https://www.researchgate.net/profile/Martin-Queinnec" class="external-link">Martin Queinnec</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
