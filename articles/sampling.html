<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Learn how to use sample_* functions.
">
<title>sampling • sgsR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="sampling">
<meta property="og:description" content="Learn how to use sample_* functions.
">
<meta property="og:image" content="/reference/figures/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-115082821-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-115082821-1');
</script><script defer data-domain="pkgdown.r-lib.org,all.tidyverse.org" src="https://plausible.io/js/plausible.js"></script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">sgsR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.3.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/sgsR.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/calculating.html">calculating</a>
    <a class="dropdown-item" href="../articles/sampling.html">sampling</a>
    <a class="dropdown-item" href="../articles/stratification.html">stratification</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/tgoodbody/sgsR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>sampling</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/tgoodbody/sgsR/blob/HEAD/vignettes/sampling.Rmd" class="external-link"><code>vignettes/sampling.Rmd</code></a></small>
      <div class="d-none name"><code>sampling.Rmd</code></div>
    </div>

    
    
<p>Currently, there are 8 functions associated with the
<code>sample</code> verb in the <code>sgsR</code> package:</p>
<ul>
<li><p><code><a href="../reference/sample_srs.html">sample_srs()</a></code> - simple random sampling</p></li>
<li><p><code><a href="../reference/sample_systematic.html">sample_systematic()</a></code>- systematic sampling in a grid
or hexagon tessellation</p></li>
<li><p><code><a href="../reference/sample_strat.html">sample_strat()</a></code> - stratified sampling within a
<code>sraster</code></p></li>
<li><p><code><a href="../reference/sample_nc.html">sample_nc()</a></code> - Nearest centroid sampling. See <a href="https://doi.org/10.1080/00049158.2016.1218265" class="external-link">Melville &amp;
Stone (2016)</a></p></li>
<li><p><code><a href="../reference/sample_clhs.html">sample_clhs()</a></code> - Latin hypercube sampling</p></li>
<li><p><code><a href="../reference/sample_balanced.html">sample_balanced()</a></code> - see <a href="http://www.antongrafstrom.se/balancedsampling/" class="external-link">BalancedSampling</a></p></li>
<li><p><code><a href="../reference/sample_ahels.html">sample_ahels()</a></code> - adapted hypercube evaluation of a
legacy sample (ahels)</p></li>
<li><p><code><a href="../reference/sample_existing.html">sample_existing()</a></code> - Sub-sample within an existing
sample using <a href="https://CRAN.R-project.org/package=clhs" class="external-link">clhs</a></p></li>
</ul>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="access">Access<a class="anchor" aria-label="anchor" href="#access"></a>
</h2>
<p>One key feature of using some <code>sample_*</code> functions is its
ability to define <code>access</code> corridors. Users can supply a road
<code>access</code> network (must be <code>sf</code> line objects) and
define buffers around <code>access</code> where samples should be
excluded and included.</p>
<p>Relevant and applicable parameters when <code>access</code> is
defined are:</p>
<ul>
<li><p><code>buff_inner</code> - Can be left as <code>NULL</code>
(default). Inner buffer parameter that defines the distance from
<code>access</code> where samples cannot be taken (i.e. if you don’t
want samples within 50 m of your <code>access</code> layer set
<code>buff_inner = 50</code>).</p></li>
<li><p><code>buff_outer</code> - Outer buffer parameter that defines the
maximum distance that the samples can be located from
<code>access</code> (i.e. if you don’t want samples more than 200 meters
from your <code>access</code> layer set
<code>buff_inner = 200</code>).</p></li>
</ul>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="srs">
<code>sample_srs</code><a class="anchor" aria-label="anchor" href="#srs"></a>
</h2>
<p>We have demonstrated a simple example of using the
<code><a href="../reference/sample_srs.html">sample_srs()</a></code> function in <code><a href="../articles/sgsR.html">vignette("sgsR")</a></code>. We
will demonstrate additional examples below.</p>
<p>The input required for <code><a href="../reference/sample_srs.html">sample_srs()</a></code> is a
<code>raster</code>. This means that <code>sraster</code> and
<code>mraster</code> are supported for this function.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- perform simple random sampling ---#</span></span>
<span><span class="fu"><a href="../reference/sample_srs.html">sample_srs</a></span><span class="op">(</span>raster <span class="op">=</span> <span class="va">sraster</span>, <span class="co"># input sraster</span></span>
<span>           nSamp <span class="op">=</span> <span class="fl">200</span>, <span class="co"># number of desired samples</span></span>
<span>           plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># plot</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; Simple feature collection with 200 features and 0 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431210 ymin: 5337730 xmax: 438510 ymax: 5343170</span></span>
<span><span class="co">#&gt; CRS:           +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;                  geometry</span></span>
<span><span class="co">#&gt; 1  POINT (432010 5342470)</span></span>
<span><span class="co">#&gt; 2  POINT (432010 5342470)</span></span>
<span><span class="co">#&gt; 3  POINT (433930 5342230)</span></span>
<span><span class="co">#&gt; 4  POINT (436010 5340310)</span></span>
<span><span class="co">#&gt; 5  POINT (431830 5341210)</span></span>
<span><span class="co">#&gt; 6  POINT (432950 5341110)</span></span>
<span><span class="co">#&gt; 7  POINT (433030 5339830)</span></span>
<span><span class="co">#&gt; 8  POINT (438050 5341150)</span></span>
<span><span class="co">#&gt; 9  POINT (431310 5340670)</span></span>
<span><span class="co">#&gt; 10 POINT (434910 5339130)</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sample_srs.html">sample_srs</a></span><span class="op">(</span>raster <span class="op">=</span> <span class="va">mraster</span>, <span class="co"># input mraster</span></span>
<span>           nSamp <span class="op">=</span> <span class="fl">200</span>, <span class="co"># number of desired samples</span></span>
<span>           access <span class="op">=</span> <span class="va">access</span>, <span class="co"># define access road network</span></span>
<span>           mindist <span class="op">=</span> <span class="fl">200</span>, <span class="co"># minimum distance samples must be apart from one another</span></span>
<span>           buff_inner <span class="op">=</span> <span class="fl">50</span>, <span class="co"># inner buffer - no samples within this distance from road</span></span>
<span>           buff_outer <span class="op">=</span> <span class="fl">200</span>, <span class="co"># outer buffer - no samples further than this distance from road</span></span>
<span>           plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># plot</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; Simple feature collection with 200 features and 0 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431130 ymin: 5337750 xmax: 438550 ymax: 5343230</span></span>
<span><span class="co">#&gt; CRS:           +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;                  geometry</span></span>
<span><span class="co">#&gt; 1  POINT (434490 5338810)</span></span>
<span><span class="co">#&gt; 2  POINT (432510 5343070)</span></span>
<span><span class="co">#&gt; 3  POINT (431310 5340550)</span></span>
<span><span class="co">#&gt; 4  POINT (438410 5338470)</span></span>
<span><span class="co">#&gt; 5  POINT (432850 5342270)</span></span>
<span><span class="co">#&gt; 6  POINT (436250 5342150)</span></span>
<span><span class="co">#&gt; 7  POINT (434730 5342330)</span></span>
<span><span class="co">#&gt; 8  POINT (435850 5339010)</span></span>
<span><span class="co">#&gt; 9  POINT (434530 5338110)</span></span>
<span><span class="co">#&gt; 10 POINT (436490 5339850)</span></span></code></pre>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="systematic">
<code>sample_systematic</code><a class="anchor" aria-label="anchor" href="#systematic"></a>
</h2>
<p>The <code><a href="../reference/sample_systematic.html">sample_systematic()</a></code> function applies systematic
sampling across an area with the <code>cellsize</code> parameter
defining the resolution of the tessellation. The tessellation shape can
be modified using the <code>square</code> parameter. Assigning
<code>TRUE</code> (default) to the <code>square</code> parameter results
in a regular grid and assigning <code>FALSE</code> results in a
hexagonal grid. The location of samples can also be adjusted using the
<code>locations</code> parameter, where <code>centers</code> takes the
center, <code>corners</code> takes all corners, and <code>random</code>
takes a random location within each tessellation.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- perform grid sampling ---#</span></span>
<span><span class="fu"><a href="../reference/sample_systematic.html">sample_systematic</a></span><span class="op">(</span>raster <span class="op">=</span> <span class="va">sraster</span>, <span class="co"># input sraster</span></span>
<span>                  cellsize <span class="op">=</span> <span class="fl">1000</span>, <span class="co"># grid distance</span></span>
<span>                  plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># plot</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; Simple feature collection with 39 features and 0 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431245.3 ymin: 5337760 xmax: 438470 ymax: 5343163</span></span>
<span><span class="co">#&gt; CRS:           +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;                    geometry</span></span>
<span><span class="co">#&gt; 1  POINT (431708.2 5342792)</span></span>
<span><span class="co">#&gt; 2  POINT (431553.9 5341804)</span></span>
<span><span class="co">#&gt; 3  POINT (431399.6 5340816)</span></span>
<span><span class="co">#&gt; 4  POINT (431245.3 5339828)</span></span>
<span><span class="co">#&gt; 5  POINT (432696.2 5342638)</span></span>
<span><span class="co">#&gt; 6  POINT (432541.9 5341650)</span></span>
<span><span class="co">#&gt; 7  POINT (432387.6 5340662)</span></span>
<span><span class="co">#&gt; 8  POINT (432233.3 5339674)</span></span>
<span><span class="co">#&gt; 9    POINT (432079 5338686)</span></span>
<span><span class="co">#&gt; 10 POINT (433684.3 5342483)</span></span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- perform grid sampling ---#</span></span>
<span><span class="fu"><a href="../reference/sample_systematic.html">sample_systematic</a></span><span class="op">(</span>raster <span class="op">=</span> <span class="va">sraster</span>, <span class="co"># input sraster</span></span>
<span>                  cellsize <span class="op">=</span> <span class="fl">500</span>, <span class="co"># grid distance</span></span>
<span>                  square <span class="op">=</span> <span class="cn">FALSE</span>, <span class="co"># hexagonal tessellation</span></span>
<span>                  location <span class="op">=</span> <span class="st">"random"</span>, <span class="co"># random sample within tessellation</span></span>
<span>                  plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># plot</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; Simple feature collection with 169 features and 0 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431114.5 ymin: 5337744 xmax: 438511.7 ymax: 5343238</span></span>
<span><span class="co">#&gt; CRS:           +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;                    geometry</span></span>
<span><span class="co">#&gt; 1    POINT (438152 5343059)</span></span>
<span><span class="co">#&gt; 2    POINT (438443 5342729)</span></span>
<span><span class="co">#&gt; 3  POINT (437093.4 5342801)</span></span>
<span><span class="co">#&gt; 4    POINT (438130 5342784)</span></span>
<span><span class="co">#&gt; 5  POINT (436060.7 5343180)</span></span>
<span><span class="co">#&gt; 6  POINT (436728.1 5342832)</span></span>
<span><span class="co">#&gt; 7  POINT (437372.2 5342781)</span></span>
<span><span class="co">#&gt; 8  POINT (438065.6 5342278)</span></span>
<span><span class="co">#&gt; 9    POINT (437020 5342736)</span></span>
<span><span class="co">#&gt; 10 POINT (437718.6 5342350)</span></span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sample_systematic.html">sample_systematic</a></span><span class="op">(</span>raster <span class="op">=</span> <span class="va">sraster</span>, <span class="co"># input sraster</span></span>
<span>            cellsize <span class="op">=</span> <span class="fl">500</span>, <span class="co"># grid distance</span></span>
<span>            access <span class="op">=</span> <span class="va">access</span>, <span class="co"># define access road network</span></span>
<span>            buff_outer <span class="op">=</span> <span class="fl">200</span>, <span class="co"># outer buffer - no samples further than this distance from road</span></span>
<span>            square <span class="op">=</span> <span class="cn">FALSE</span>, <span class="co"># hexagonal tessellation</span></span>
<span>            location <span class="op">=</span> <span class="st">"corners"</span>, <span class="co"># take corners instead of centers</span></span>
<span>            plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; Simple feature collection with 595 features and 0 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431204.5 ymin: 5337729 xmax: 438417.7 ymax: 5343231</span></span>
<span><span class="co">#&gt; CRS:           +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;                    geometry</span></span>
<span><span class="co">#&gt; 1  POINT (438417.7 5338018)</span></span>
<span><span class="co">#&gt; 2  POINT (437563.8 5337874)</span></span>
<span><span class="co">#&gt; 3  POINT (437848.4 5337922)</span></span>
<span><span class="co">#&gt; 4  POINT (436709.9 5337729)</span></span>
<span><span class="co">#&gt; 5  POINT (436994.5 5337777)</span></span>
<span><span class="co">#&gt; 6  POINT (438417.7 5338018)</span></span>
<span><span class="co">#&gt; 7  POINT (437848.4 5337922)</span></span>
<span><span class="co">#&gt; 8  POINT (437949.1 5338192)</span></span>
<span><span class="co">#&gt; 9  POINT (438233.7 5338240)</span></span>
<span><span class="co">#&gt; 10 POINT (438417.7 5338018)</span></span></code></pre>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="sstrat">
<code>sample_strat</code><a class="anchor" aria-label="anchor" href="#sstrat"></a>
</h2>
<p>The <code><a href="../reference/sample_strat.html">sample_strat()</a></code> contains two <code>method</code>s to
perform sampling:</p>
<ul>
<li><p><code>"Queinnec"</code> - Hierarchical sampling using a focal
window to isolate contiguous groups of stratum pixels, which was
originally developed by Martin Queinnec.</p></li>
<li><p><code>"random"</code> - Traditional stratified random sampling.
This <code>method</code> ignores much of the functionality of the
algorithm to allow users the capability to use standard stratified
random sampling approaches without the use of a focal window to locate
contiguous stratum cells.</p></li>
</ul>
<div class="section level3 unnumbered">
<h3 class="unnumbered" id="queinnec">
<code>method = "Queinnec"</code><a class="anchor" aria-label="anchor" href="#queinnec"></a>
</h3>
<p><em>Queinnec, M., White, J. C., &amp; Coops, N. C. (2021). Comparing
airborne and spaceborne photon-counting LiDAR canopy structural
estimates across different boreal forest types. Remote Sensing of
Environment, 262(August 2020), 112510.</em></p>
<p>This algorithm uses moving window (<code>wrow</code> and
<code>wcol</code> parameters) to filter the input <code>sraster</code>
to prioritize sample locations where stratum pixels are spatially
grouped, rather than dispersed individuals across the landscape.</p>
<p>Sampling is performed using 2 rules:</p>
<ul>
<li><p><strong>Rule 1</strong> - Sample within spatially grouped stratum
pixels. Moving window defined by <code>wrow</code> and
<code>wcol</code>.</p></li>
<li><p><strong>Rule 2</strong> - If no more samples exist to satisfy
desired sampling count, individual stratum pixels are sampled.</p></li>
</ul>
<p>The rule applied to a select a particular sample is defined in the
<code>rule</code> attribute of output samples. We give a few examples
below:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- perform stratified sampling random sampling ---#</span></span>
<span><span class="fu"><a href="../reference/sample_strat.html">sample_strat</a></span><span class="op">(</span>sraster <span class="op">=</span> <span class="va">sraster</span>, <span class="co"># input sraster</span></span>
<span>             nSamp <span class="op">=</span> <span class="fl">200</span>, <span class="co"># desired sample number</span></span>
<span>             plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># plot</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; Simple feature collection with 200 features and 3 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431170 ymin: 5337710 xmax: 438550 ymax: 5343230</span></span>
<span><span class="co">#&gt; CRS:           NA</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;    strata type  rule               geometry</span></span>
<span><span class="co">#&gt; x       1  new rule1 POINT (434410 5341590)</span></span>
<span><span class="co">#&gt; x1      1  new rule2 POINT (437210 5337930)</span></span>
<span><span class="co">#&gt; x2      1  new rule2 POINT (433950 5341310)</span></span>
<span><span class="co">#&gt; x3      1  new rule2 POINT (434810 5341930)</span></span>
<span><span class="co">#&gt; x4      1  new rule2 POINT (434210 5340870)</span></span>
<span><span class="co">#&gt; x5      1  new rule2 POINT (437950 5339010)</span></span>
<span><span class="co">#&gt; x6      1  new rule2 POINT (436710 5339810)</span></span>
<span><span class="co">#&gt; x7      1  new rule2 POINT (438250 5341410)</span></span>
<span><span class="co">#&gt; x8      1  new rule2 POINT (437210 5337990)</span></span>
<span><span class="co">#&gt; x9      1  new rule2 POINT (436290 5338250)</span></span></code></pre>
<p>In some cases, users might want to include <code>existing</code>
samples within the algorithm. In order to adjust the total number of
samples needed per stratum to reflect those already present in
<code>existing</code>, we can use the intermediate function
<code><a href="../reference/extract_strata.html">extract_strata()</a></code>.</p>
<p>This function uses the <code>sraster</code> and <code>existing</code>
samples and extracts the stratum for each. These samples can be included
within <code><a href="../reference/sample_strat.html">sample_strat()</a></code>, which adjusts total samples required
per class based on representation in <code>existing</code>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- extract strata values to existing samples ---#              </span></span>
<span><span class="va">e.sr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_strata.html">extract_strata</a></span><span class="op">(</span>sraster <span class="op">=</span> <span class="va">sraster</span>, <span class="co"># input sraster</span></span>
<span>                       existing <span class="op">=</span> <span class="va">existing</span><span class="op">)</span> <span class="co"># existing samples to add strata value to</span></span></code></pre></div>
<p>Notice that <code>e.sr</code> now has an attribute named strata. If
that parameter is not there, <code><a href="../reference/sample_strat.html">sample_strat()</a></code> will give an
error.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sample_strat.html">sample_strat</a></span><span class="op">(</span>sraster <span class="op">=</span> <span class="va">sraster</span>, <span class="co"># input sraster</span></span>
<span>             nSamp <span class="op">=</span> <span class="fl">200</span>, <span class="co"># desired sample number</span></span>
<span>             access <span class="op">=</span> <span class="va">access</span>, <span class="co"># define access road network</span></span>
<span>             existing <span class="op">=</span> <span class="va">e.sr</span>, <span class="co"># existing samples with strata values</span></span>
<span>             mindist <span class="op">=</span> <span class="fl">200</span>, <span class="co"># minimum distance samples must be apart from one another</span></span>
<span>             buff_inner <span class="op">=</span> <span class="fl">50</span>, <span class="co"># inner buffer - no samples within this distance from road</span></span>
<span>             buff_outer <span class="op">=</span> <span class="fl">200</span>, <span class="co"># outer buffer - no samples further than this distance from road</span></span>
<span>             plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># plot</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; Simple feature collection with 400 features and 3 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431130 ymin: 5337750 xmax: 438550 ymax: 5343230</span></span>
<span><span class="co">#&gt; CRS:           NA</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;    strata     type     rule               geometry</span></span>
<span><span class="co">#&gt; 1       1 existing existing POINT (434670 5341150)</span></span>
<span><span class="co">#&gt; 2       1 existing existing POINT (435150 5342710)</span></span>
<span><span class="co">#&gt; 3       1 existing existing POINT (435750 5338230)</span></span>
<span><span class="co">#&gt; 4       1 existing existing POINT (433270 5341030)</span></span>
<span><span class="co">#&gt; 5       1 existing existing POINT (435070 5338910)</span></span>
<span><span class="co">#&gt; 6       1 existing existing POINT (432830 5342930)</span></span>
<span><span class="co">#&gt; 7       1 existing existing POINT (433790 5340450)</span></span>
<span><span class="co">#&gt; 8       1 existing existing POINT (438070 5339690)</span></span>
<span><span class="co">#&gt; 9       1 existing existing POINT (436070 5338170)</span></span>
<span><span class="co">#&gt; 10      1 existing existing POINT (436550 5338010)</span></span></code></pre>
<p>As seen on the code in the example above, the defined
<code>mindist</code> parameter specifies the minimum euclidean distance
that samples must be apart from one another.</p>
<p>Notice that the sample outputs have <code>type</code> and
<code>rule</code> attributes which outline whether the samples are
<code>existing</code> or <code>new</code> and whether <code>rule1</code>
or <code>rule2</code> were used to select the individual samples. If
<code>type</code> is <em>existing</em> (a user provided
<code>existing</code> sample), <code>rule</code> will be
<em>existing</em> as well as seen above.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sample_strat.html">sample_strat</a></span><span class="op">(</span>sraster <span class="op">=</span> <span class="va">sraster</span>, <span class="co"># input</span></span>
<span>             nSamp <span class="op">=</span> <span class="fl">200</span>, <span class="co"># desired sample number</span></span>
<span>             access <span class="op">=</span> <span class="va">access</span>, <span class="co"># define access road network</span></span>
<span>             existing <span class="op">=</span> <span class="va">e.sr</span>, <span class="co"># existing samples with strata values</span></span>
<span>             include <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># include existing plots in nSamp total</span></span>
<span>             buff_outer <span class="op">=</span> <span class="fl">200</span>, <span class="co"># outer buffer - no samples further than this distance from road</span></span>
<span>             plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># plot</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; Simple feature collection with 200 features and 3 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431130 ymin: 5337850 xmax: 438550 ymax: 5343230</span></span>
<span><span class="co">#&gt; CRS:           NA</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;    strata     type     rule               geometry</span></span>
<span><span class="co">#&gt; 1       1 existing existing POINT (434670 5341150)</span></span>
<span><span class="co">#&gt; 2       1 existing existing POINT (435150 5342710)</span></span>
<span><span class="co">#&gt; 3       1 existing existing POINT (435750 5338230)</span></span>
<span><span class="co">#&gt; 4       1 existing existing POINT (433270 5341030)</span></span>
<span><span class="co">#&gt; 5       1 existing existing POINT (435070 5338910)</span></span>
<span><span class="co">#&gt; 6       1 existing existing POINT (432830 5342930)</span></span>
<span><span class="co">#&gt; 7       1 existing existing POINT (433790 5340450)</span></span>
<span><span class="co">#&gt; 8       1 existing existing POINT (438070 5339690)</span></span>
<span><span class="co">#&gt; 9       1 existing existing POINT (436070 5338170)</span></span>
<span><span class="co">#&gt; 10      1 existing existing POINT (436550 5338010)</span></span></code></pre>
<p>The <code>include</code> parameter determines whether
<code>existing</code> samples should be included in the total count of
samples defined by <code>nSamp</code>. By default, the
<code>include</code> parameter is set as <code>FALSE</code>.</p>
</div>
<div class="section level3 unnumbered">
<h3 class="unnumbered" id="stratrandom">
<code>method = "random</code><a class="anchor" aria-label="anchor" href="#stratrandom"></a>
</h3>
<p>Stratified random sampling with equal probability for all cells
(using default algorithm values for <code>mindist</code> and no use of
<code>access</code> functionality). In essence this method perform the
<code>sample_srs</code> algorithm for each stratum separately to meet
the specified sample allocation.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- perform stratified sampling random sampling ---#</span></span>
<span><span class="fu"><a href="../reference/sample_strat.html">sample_strat</a></span><span class="op">(</span>sraster <span class="op">=</span> <span class="va">sraster</span>, <span class="co"># input sraster</span></span>
<span>             method <span class="op">=</span> <span class="st">"random"</span>, <span class="co">#stratified random sampling</span></span>
<span>             nSamp <span class="op">=</span> <span class="fl">200</span>, <span class="co"># desired sample number</span></span>
<span>             plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># plot</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; Simple feature collection with 200 features and 1 field</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431190 ymin: 5337710 xmax: 438370 ymax: 5343190</span></span>
<span><span class="co">#&gt; Projected CRS: UTM Zone 17, Northern Hemisphere</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;    strata               geometry</span></span>
<span><span class="co">#&gt; 1       1 POINT (434410 5342150)</span></span>
<span><span class="co">#&gt; 2       1 POINT (434410 5342150)</span></span>
<span><span class="co">#&gt; 3       1 POINT (436210 5337790)</span></span>
<span><span class="co">#&gt; 4       1 POINT (432850 5341650)</span></span>
<span><span class="co">#&gt; 5       1 POINT (438130 5339410)</span></span>
<span><span class="co">#&gt; 6       1 POINT (433710 5341130)</span></span>
<span><span class="co">#&gt; 7       1 POINT (433670 5340550)</span></span>
<span><span class="co">#&gt; 8       1 POINT (437950 5338450)</span></span>
<span><span class="co">#&gt; 9       1 POINT (434410 5341530)</span></span>
<span><span class="co">#&gt; 10      1 POINT (435850 5342630)</span></span></code></pre>
</div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="nc">
<code>sample_nc</code><a class="anchor" aria-label="anchor" href="#nc"></a>
</h2>
<p><code><a href="../reference/sample_nc.html">sample_nc()</a></code> function implements the Nearest Centroid
sampling algorithm described in <a href="https://doi.org/10.1080/00049158.2016.1218265" class="external-link">Melville &amp;
Stone (2016)</a>. The algorithm uses kmeans clustering where the number
of clusters (centroids) is equal to the desired number of samples
(<code>nSamp</code>). Cluster centers are located, which then prompts
the nearest neighbour <code>mraster</code> pixel for each cluster to be
located (assuming default <code>k</code> parameter). These nearest
neighbours are the output samples. Basic usage is as follows:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- perform simple random sampling ---#</span></span>
<span><span class="fu"><a href="../reference/sample_nc.html">sample_nc</a></span><span class="op">(</span>mraster <span class="op">=</span> <span class="va">mraster</span>, <span class="co"># input</span></span>
<span>          nSamp <span class="op">=</span> <span class="fl">25</span>, <span class="co"># desired sample number</span></span>
<span>          plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; K-means being performed on 3 layers with 25 centers.</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; Simple feature collection with 25 features and 4 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431210 ymin: 5337710 xmax: 438510 ymax: 5343190</span></span>
<span><span class="co">#&gt; CRS:           +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;        zq90 pzabove2  zsd kcenter               geometry</span></span>
<span><span class="co">#&gt; 59102 21.90     92.3 5.25       1 POINT (434450 5340070)</span></span>
<span><span class="co">#&gt; 19838 17.70     93.3 3.43       2 POINT (432470 5342170)</span></span>
<span><span class="co">#&gt; 57393 26.50     85.7 8.38       3 POINT (437570 5340170)</span></span>
<span><span class="co">#&gt; 23567 18.50     64.2 5.51       4 POINT (432450 5341970)</span></span>
<span><span class="co">#&gt; 45930 11.50     51.2 3.09       5 POINT (432110 5340770)</span></span>
<span><span class="co">#&gt; 67385  8.54     40.4 2.25       6 POINT (435990 5339630)</span></span>
<span><span class="co">#&gt; 47146  3.07      6.7 0.60       7 POINT (434050 5340710)</span></span>
<span><span class="co">#&gt; 95852 12.20     17.6 3.59       8 POINT (438370 5338110)</span></span>
<span><span class="co">#&gt; 34611 16.10     73.6 4.25       9 POINT (436990 5341390)</span></span>
<span><span class="co">#&gt; 50298 15.60     48.9 4.29      10 POINT (437410 5340550)</span></span></code></pre>
<p>Altering the <code>k</code> parameter leads to a multiplicative
increase in output samples where total output samples = <span class="math inline">\(`nSamp` * `k`\)</span>.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- perform simple random sampling ---#</span></span>
<span><span class="va">samples</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sample_nc.html">sample_nc</a></span><span class="op">(</span>mraster <span class="op">=</span> <span class="va">mraster</span>, <span class="co"># input</span></span>
<span>                    k <span class="op">=</span> <span class="fl">2</span>, <span class="co"># number of nearest neighbours to take for each kmeans center</span></span>
<span>                    nSamp <span class="op">=</span> <span class="fl">25</span>, <span class="co"># desired sample number</span></span>
<span>                    plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; K-means being performed on 3 layers with 25 centers.</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">#--- total samples = nSamp * k (25 * 2) = 50 ---#</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">samples</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 50</span></span></code></pre></div>
<p>Visualizing what the kmeans centers and samples nearest neighbours
looks like is possible when using <code>details = TRUE</code>. The
<code>$kplot</code> output provides a quick visualization of where the
centers are based on a scatter plot of the first 2 layers in
<code>mraster</code>. Notice that the centers are well distributed in
covariate space and chosen samples are the closest pixels to each center
(nearest neighbours).</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- perform simple random sampling with details ---#</span></span>
<span><span class="va">details</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sample_nc.html">sample_nc</a></span><span class="op">(</span>mraster <span class="op">=</span> <span class="va">mraster</span>, <span class="co"># input</span></span>
<span>                     nSamp <span class="op">=</span> <span class="fl">25</span>, <span class="co"># desired sample number</span></span>
<span>                     details <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; K-means being performed on 3 layers with 25 centers.</span></span>
<span></span>
<span><span class="co">#--- plot ggplot output ---#</span></span>
<span></span>
<span><span class="va">details</span><span class="op">$</span><span class="va">kplot</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="clhs">
<code>sample_clhs</code><a class="anchor" aria-label="anchor" href="#clhs"></a>
</h2>
<p><code><a href="../reference/sample_clhs.html">sample_clhs()</a></code> function implements conditioned Latin
hypercube (clhs) sampling methodology from the <a href="https://CRAN.R-project.org/package=clhs/" class="external-link"><code>clhs</code></a>
package. A number of other functions in the <code>sgsR</code> package
help to provide guidance on clhs sampling including
<code><a href="../reference/calculate_pop.html">calculate_pop()</a></code> and <code><a href="../reference/calculate_lhsOpt.html">calculate_lhsOpt()</a></code>. Check
out these functions to better understand how sample numbers could be
optimized.</p>
<p>The syntax for this function is similar to others shown above,
although parameters like <code>iter</code>, which define the number of
iterations within the Metropolis-Hastings process are important to
consider. In these examples we use a low <code>iter</code> value because
it takes less time to run. Default values for <code>iter</code> within
the <code>clhs</code> package are 10,000.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sample_clhs.html">sample_clhs</a></span><span class="op">(</span>mraster <span class="op">=</span> <span class="va">mraster</span>, <span class="co"># input</span></span>
<span>            nSamp <span class="op">=</span> <span class="fl">200</span>, <span class="co"># desired sample number</span></span>
<span>            plot <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># plot </span></span>
<span>            iter <span class="op">=</span> <span class="fl">100</span><span class="op">)</span> <span class="co"># number of iterations</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sample_clhs.html">sample_clhs</a></span><span class="op">(</span>mraster <span class="op">=</span> <span class="va">mraster</span>, <span class="co"># input</span></span>
<span>            nSamp <span class="op">=</span> <span class="fl">300</span>, <span class="co"># desired sample number</span></span>
<span>            iter <span class="op">=</span> <span class="fl">100</span>, <span class="co"># number of iterations</span></span>
<span>            existing <span class="op">=</span> <span class="va">existing</span>, <span class="co"># existing samples</span></span>
<span>            access <span class="op">=</span> <span class="va">access</span>, <span class="co"># define access road network</span></span>
<span>            buff_inner <span class="op">=</span> <span class="fl">100</span>, <span class="co"># inner buffer - no samples within this distance from road</span></span>
<span>            buff_outer <span class="op">=</span> <span class="fl">300</span>, <span class="co"># outer buffer - no samples further than this distance from road</span></span>
<span>            plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># plot</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-19-1.png" width="700"></p>
<p>The <code>cost</code> parameter defines the <code>mraster</code>
covariate, which is used to constrain the clhs sampling. This could be
any number of variables. An example could be the distance a pixel is
from road <code>access</code> (e.g. from
<code><a href="../reference/calculate_distance.html">calculate_distance()</a></code> see example below), terrain slope, the
output from <code><a href="../reference/calculate_coobs.html">calculate_coobs()</a></code>, or many others.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- cost constrained examples ---#</span></span>
<span><span class="co">#--- calculate distance to access layer for each pixel in mr ---#</span></span>
<span><span class="va">mr.c</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_distance.html">calculate_distance</a></span><span class="op">(</span>raster <span class="op">=</span> <span class="va">mraster</span>, <span class="co"># input</span></span>
<span>                           access <span class="op">=</span> <span class="va">access</span>,</span>
<span>                           plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># define access road network</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-20-1.png" width="700"></p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sample_clhs.html">sample_clhs</a></span><span class="op">(</span>mraster <span class="op">=</span> <span class="va">mr.c</span>, <span class="co"># input</span></span>
<span>            nSamp <span class="op">=</span> <span class="fl">250</span>, <span class="co"># desired sample number</span></span>
<span>            iter <span class="op">=</span> <span class="fl">100</span>, <span class="co"># number of iterations</span></span>
<span>            cost <span class="op">=</span> <span class="st">"dist2access"</span>, <span class="co"># cost parameter - name defined in calculate_distance()</span></span>
<span>            plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># plot</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-22-1.png" width="700"></p>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="balanced">
<code>sample_balanced</code><a class="anchor" aria-label="anchor" href="#balanced"></a>
</h2>
<p>The <code><a href="../reference/sample_balanced.html">sample_balanced()</a></code> algorithm performs a balanced
sampling methodology from the <a href="http://www.antongrafstrom.se/balancedsampling/" class="external-link"><code>stratifyR / SamplingBigData</code></a>
packages.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sample_balanced.html">sample_balanced</a></span><span class="op">(</span>mraster <span class="op">=</span> <span class="va">mraster</span>, <span class="co"># input</span></span>
<span>                nSamp <span class="op">=</span> <span class="fl">200</span>, <span class="co"># desired sample number</span></span>
<span>                plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># plot</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-23-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; Simple feature collection with 200 features and 0 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431110 ymin: 5337730 xmax: 438510 ymax: 5343210</span></span>
<span><span class="co">#&gt; CRS:           +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;                  geometry</span></span>
<span><span class="co">#&gt; 1  POINT (431730 5343210)</span></span>
<span><span class="co">#&gt; 2  POINT (434030 5343130)</span></span>
<span><span class="co">#&gt; 3  POINT (431310 5343110)</span></span>
<span><span class="co">#&gt; 4  POINT (433270 5343090)</span></span>
<span><span class="co">#&gt; 5  POINT (435310 5343090)</span></span>
<span><span class="co">#&gt; 6  POINT (435890 5343090)</span></span>
<span><span class="co">#&gt; 7  POINT (437050 5343050)</span></span>
<span><span class="co">#&gt; 8  POINT (434890 5343030)</span></span>
<span><span class="co">#&gt; 9  POINT (436870 5343030)</span></span>
<span><span class="co">#&gt; 10 POINT (436190 5343010)</span></span></code></pre>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sample_balanced.html">sample_balanced</a></span><span class="op">(</span>mraster <span class="op">=</span> <span class="va">mraster</span>, <span class="co"># input</span></span>
<span>                nSamp <span class="op">=</span> <span class="fl">100</span>, <span class="co"># desired sample number</span></span>
<span>                algorithm <span class="op">=</span> <span class="st">"lcube"</span>, <span class="co"># algorithm type</span></span>
<span>                access <span class="op">=</span> <span class="va">access</span>, <span class="co"># define access road network</span></span>
<span>                buff_inner <span class="op">=</span> <span class="fl">50</span>, <span class="co"># inner buffer - no samples within this distance from road</span></span>
<span>                buff_outer <span class="op">=</span> <span class="fl">200</span><span class="op">)</span> <span class="co"># outer buffer - no samples further than this distance from road</span></span>
<span><span class="co">#&gt; Simple feature collection with 100 features and 0 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431330 ymin: 5337730 xmax: 438550 ymax: 5343210</span></span>
<span><span class="co">#&gt; CRS:           +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;                  geometry</span></span>
<span><span class="co">#&gt; 1  POINT (438110 5341550)</span></span>
<span><span class="co">#&gt; 2  POINT (434450 5342570)</span></span>
<span><span class="co">#&gt; 3  POINT (435110 5341970)</span></span>
<span><span class="co">#&gt; 4  POINT (433630 5341250)</span></span>
<span><span class="co">#&gt; 5  POINT (432450 5338910)</span></span>
<span><span class="co">#&gt; 6  POINT (436910 5338470)</span></span>
<span><span class="co">#&gt; 7  POINT (433450 5343210)</span></span>
<span><span class="co">#&gt; 8  POINT (435150 5338550)</span></span>
<span><span class="co">#&gt; 9  POINT (438270 5339430)</span></span>
<span><span class="co">#&gt; 10 POINT (434050 5338610)</span></span></code></pre></div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="ahels">
<code>sample_ahels</code><a class="anchor" aria-label="anchor" href="#ahels"></a>
</h2>
<p>The <code><a href="../reference/sample_ahels.html">sample_ahels()</a></code> function performs the adapted
Hypercube Evaluation of a Legacy Sample (ahels) algorithm
using<code>existing</code> sample data and an <code>mraster</code>. New
samples are allocated based on quantile ratios between the
<code>existing</code> sample and <code>mraster</code> covariate
dataset.</p>
<p>This algorithm was adapted from that presented in the paper below,
which we highly recommend.</p>
<p><em>Malone BP, Minansy B, Brungard C. 2019. Some methods to improve
the utility of conditioned Latin hypercube sampling. PeerJ 7:e6451 DOI
10.7717/peerj.6451</em></p>
<p>This algorithm:</p>
<ol style="list-style-type: decimal">
<li><p>Determines the quantile distributions of <code>existing</code>
samples and <code>mraster</code> covariates.</p></li>
<li><p>Determines quantiles where there is a disparity between samples
and covariates.</p></li>
<li><p>Prioritizes sampling within those quantile to improve
representation.</p></li>
</ol>
<p>To use this function, user must first specify the number of quantiles
(<code>nQuant</code>) followed by either the <code>nSamp</code> (total
number of desired samples to be added) or the <code>threshold</code>
(sampling ratio vs. covariate coverage ratio for quantiles - default is
0.9) parameters. We recommended you setting the <code>threshold</code>
values at or below 0.9.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sample_ahels.html">sample_ahels</a></span><span class="op">(</span>mraster <span class="op">=</span> <span class="va">mraster</span>, </span>
<span>             existing <span class="op">=</span> <span class="va">existing</span>, <span class="co"># existing samples</span></span>
<span>             plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># plot</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-26-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; Simple feature collection with 267 features and 7 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431130 ymin: 5337810 xmax: 438550 ymax: 5343230</span></span>
<span><span class="co">#&gt; CRS:           +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;      type.x  zq90 pzabove2  zsd strata type.y  rule</span></span>
<span><span class="co">#&gt; 1  existing  8.14     46.3 2.28      1    new rule1</span></span>
<span><span class="co">#&gt; 2  existing  6.46     43.6 1.68      1    new rule2</span></span>
<span><span class="co">#&gt; 3  existing  8.15     21.7 2.12      1    new rule2</span></span>
<span><span class="co">#&gt; 4  existing 10.40     36.1 2.67      1    new rule2</span></span>
<span><span class="co">#&gt; 5  existing  1.90      0.4 0.28      1    new rule2</span></span>
<span><span class="co">#&gt; 6  existing  9.01     51.5 2.13      1    new rule2</span></span>
<span><span class="co">#&gt; 7  existing  3.98     12.3 0.89      1    new rule2</span></span>
<span><span class="co">#&gt; 8  existing  5.79     47.9 1.24      1    new rule2</span></span>
<span><span class="co">#&gt; 9  existing  8.11     56.3 2.07      1    new rule2</span></span>
<span><span class="co">#&gt; 10 existing  7.15     65.9 1.68      1    new rule2</span></span>
<span><span class="co">#&gt;                  geometry</span></span>
<span><span class="co">#&gt; 1  POINT (434670 5341150)</span></span>
<span><span class="co">#&gt; 2  POINT (435150 5342710)</span></span>
<span><span class="co">#&gt; 3  POINT (435750 5338230)</span></span>
<span><span class="co">#&gt; 4  POINT (433270 5341030)</span></span>
<span><span class="co">#&gt; 5  POINT (435070 5338910)</span></span>
<span><span class="co">#&gt; 6  POINT (432830 5342930)</span></span>
<span><span class="co">#&gt; 7  POINT (433790 5340450)</span></span>
<span><span class="co">#&gt; 8  POINT (438070 5339690)</span></span>
<span><span class="co">#&gt; 9  POINT (436070 5338170)</span></span>
<span><span class="co">#&gt; 10 POINT (436550 5338010)</span></span></code></pre>
<p>Notice that no <code>threshold</code>, <code>nSamp</code>, or
<code>nQuant</code> were defined. That is because the default setting
for <code>threshold = 0.9</code> and <code>nQuant = 10</code>.</p>
<p>The first matrix output shows the quantile ratios between the sample
and the covariates. A value of 1.0 indicates that samples are
represented relative to the quantile coverage. Values &gt; 1.0 indicate
over representation of samples, while &lt; 1.0 indicate under
representation of samples.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sample_ahels.html">sample_ahels</a></span><span class="op">(</span>mraster <span class="op">=</span> <span class="va">mraster</span>, </span>
<span>             existing <span class="op">=</span> <span class="va">existing</span>, <span class="co"># existing samples</span></span>
<span>             nQuant <span class="op">=</span> <span class="fl">20</span>, <span class="co"># define 20 quantiles</span></span>
<span>             nSamp <span class="op">=</span> <span class="fl">300</span><span class="op">)</span> <span class="co"># total samples desired</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-29-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; Simple feature collection with 500 features and 7 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431130 ymin: 5337730 xmax: 438550 ymax: 5343230</span></span>
<span><span class="co">#&gt; CRS:           +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;      type.x  zq90 pzabove2  zsd strata type.y  rule</span></span>
<span><span class="co">#&gt; 1  existing  8.14     46.3 2.28      1    new rule1</span></span>
<span><span class="co">#&gt; 2  existing  6.46     43.6 1.68      1    new rule2</span></span>
<span><span class="co">#&gt; 3  existing  8.15     21.7 2.12      1    new rule2</span></span>
<span><span class="co">#&gt; 4  existing 10.40     36.1 2.67      1    new rule2</span></span>
<span><span class="co">#&gt; 5  existing  1.90      0.4 0.28      1    new rule2</span></span>
<span><span class="co">#&gt; 6  existing  9.01     51.5 2.13      1    new rule2</span></span>
<span><span class="co">#&gt; 7  existing  3.98     12.3 0.89      1    new rule2</span></span>
<span><span class="co">#&gt; 8  existing  5.79     47.9 1.24      1    new rule2</span></span>
<span><span class="co">#&gt; 9  existing  8.11     56.3 2.07      1    new rule2</span></span>
<span><span class="co">#&gt; 10 existing  7.15     65.9 1.68      1    new rule2</span></span>
<span><span class="co">#&gt;                  geometry</span></span>
<span><span class="co">#&gt; 1  POINT (434670 5341150)</span></span>
<span><span class="co">#&gt; 2  POINT (435150 5342710)</span></span>
<span><span class="co">#&gt; 3  POINT (435750 5338230)</span></span>
<span><span class="co">#&gt; 4  POINT (433270 5341030)</span></span>
<span><span class="co">#&gt; 5  POINT (435070 5338910)</span></span>
<span><span class="co">#&gt; 6  POINT (432830 5342930)</span></span>
<span><span class="co">#&gt; 7  POINT (433790 5340450)</span></span>
<span><span class="co">#&gt; 8  POINT (438070 5339690)</span></span>
<span><span class="co">#&gt; 9  POINT (436070 5338170)</span></span>
<span><span class="co">#&gt; 10 POINT (436550 5338010)</span></span></code></pre>
<p>Notice that the total number of samples is 500. This value is the sum
of existing samples (200) and number of samples defined by
<code>nSamp = 300</code>.</p>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="samp-existing">
<code>sample_existing</code><a class="anchor" aria-label="anchor" href="#samp-existing"></a>
</h2>
<p>Acknowledging that <code>existing</code> sample networks exist is
important. There is significant investment into these samples, and in
order to keep inventories up-to-date, we often need to collect new data
at these locations. The <code>sample_existing</code> algorithm provides
a method for sub-sampling an <code>existing</code> sample network should
the financial / logistical resources not be available to collect data at
all sample units. The algorithm leverages latin hypercube sampling using
the <a href="https://CRAN.R-project.org/package=clhs" class="external-link">clhs</a> package
to effectively sample within an <code>existing</code> network.</p>
<p>The algorithm has two fundamental approaches:</p>
<ol style="list-style-type: decimal">
<li><p>Sample exclusively using the sample network and the attributes it
contains</p></li>
<li><p>Should <code>raster</code> information be available and
co-located with the sample, use these data as population values to
improve sub-sampling of <code>existing</code>.</p></li>
</ol>
<p>Much like the <code><a href="../reference/sample_clhs.html">sample_clhs()</a></code> algorithm, users can define
a <code>cost</code> parameter, which will be used to constrain
sub-sampling. A cost parameters is a user defined metric/attribute such
as distance from roads (e.g. <code><a href="../reference/calculate_distance.html">calculate_distance()</a></code>),
elevation, etc.</p>
<p>Here some some basic examples:</p>
<div class="section level3">
<h3 id="basic-sub-sampling-of-existing">Basic sub-sampling of <code>existing</code><a class="anchor" aria-label="anchor" href="#basic-sub-sampling-of-existing"></a>
</h3>
<p>First we can create an existing dataset for our example. Lets imagine
we have a systematically sampled dataset of ~900 samples, and we know we
only have resources to sample 300 of them. We have some ALS data
available (<code>mraster</code>), which we will use as our distributions
to sample within.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- generate existing samples and extract metrics ---#</span></span>
<span><span class="va">existing</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sample_systematic.html">sample_systematic</a></span><span class="op">(</span>raster <span class="op">=</span> <span class="va">mraster</span>, cellsize <span class="op">=</span> <span class="fl">200</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="../reference/extract_metrics.html">extract_metrics</a></span><span class="op">(</span>mraster <span class="op">=</span> <span class="va">mraster</span>, existing <span class="op">=</span> <span class="va">.</span><span class="op">)</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-31-1.png" width="700"></p>
<p>We see our systematic sample. Notice that we used
<code><a href="../reference/extract_metrics.html">extract_metrics()</a></code> after creating it. If the user provides a
<code>raster</code> for the algorithm this isn’t neccesary, it will be
handled internally in the algorithm if no attributes are present, but if
only samples are given, attributes must be provided and <em>sampling
will be conducted on all included attributes</em>. Now lets sub-sample
within it.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- sub sample using ---#</span></span>
<span><span class="fu"><a href="../reference/sample_existing.html">sample_existing</a></span><span class="op">(</span>existing <span class="op">=</span> <span class="va">existing</span>, <span class="co"># our existing sample</span></span>
<span>                nSamp <span class="op">=</span> <span class="fl">300</span>, <span class="co"># the number of samples we want</span></span>
<span>                plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># plot</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-32-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; Simple feature collection with 300 features and 3 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431149.9 ymin: 5337702 xmax: 438532.2 ymax: 5343240</span></span>
<span><span class="co">#&gt; CRS:           +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;      zq90 pzabove2  zsd                 geometry</span></span>
<span><span class="co">#&gt; 200  9.24     12.7 2.51 POINT (434219.5 5342794)</span></span>
<span><span class="co">#&gt; 537 20.30     94.3 3.72 POINT (434099.8 5338054)</span></span>
<span><span class="co">#&gt; 694 13.40     84.0 3.49   POINT (437774 5342190)</span></span>
<span><span class="co">#&gt; 28  12.00     75.1 2.76 POINT (432160.4 5342796)</span></span>
<span><span class="co">#&gt; 362  5.15     24.3 1.22 POINT (434218.1 5340735)</span></span>
<span><span class="co">#&gt; 469 17.30     68.5 4.77   POINT (434820 5340171)</span></span>
<span><span class="co">#&gt; 766  9.29     88.5 2.06 POINT (437909.3 5341199)</span></span>
<span><span class="co">#&gt; 415  3.89     13.8 0.79 POINT (435442.9 5342113)</span></span>
<span><span class="co">#&gt; 643 19.90     84.6 3.22 POINT (436354.8 5340462)</span></span>
<span><span class="co">#&gt; 729  9.94     31.3 2.64 POINT (437073.6 5340519)</span></span></code></pre>
<p>We see from the output that we get 300 samples that are a sub-sample
of the original <code>existing</code> sample. The plotted output shows
sumulative frequency distributions of the population (all
<code>existing</code> samples) and the sub-sample (the 300 samples we
requested). Notice that the distributions match quite well. This is a
simple example, so lets do another with a bit more complexity.</p>
</div>
<div class="section level3">
<h3 id="sub-sampling-using-raster-distributions">Sub-sampling using <code>raster</code> distributions<a class="anchor" aria-label="anchor" href="#sub-sampling-using-raster-distributions"></a>
</h3>
<p>Our systematic sample of ~900 plots is fairly comprehensive, however
we can generate a true population distribution through the inclusion of
the ALS metrics in the sampling process. The metrics will be included in
internal latin hypercube sampling to help guide sub-sampling of
<code>existing</code>.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- sub sample using ---#</span></span>
<span><span class="fu"><a href="../reference/sample_existing.html">sample_existing</a></span><span class="op">(</span>existing <span class="op">=</span> <span class="va">existing</span>, <span class="co"># our existing sample</span></span>
<span>                nSamp <span class="op">=</span> <span class="fl">300</span>, <span class="co"># the number of samples we want</span></span>
<span>                raster <span class="op">=</span> <span class="va">mraster</span>, <span class="co"># include mraster metrics to guide sampling of existing</span></span>
<span>                plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># plot</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-33-1.png" width="700"><img src="sampling_files/figure-html/unnamed-chunk-33-2.png" width="700"></p>
<pre><code><span><span class="co">#&gt; Simple feature collection with 300 features and 3 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431187.9 ymin: 5337723 xmax: 438549.3 ymax: 5343238</span></span>
<span><span class="co">#&gt; CRS:           +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;        zq90 pzabove2  zsd                 geometry</span></span>
<span><span class="co">#&gt; 25615 17.80     95.9 3.66   POINT (431866 5338153)</span></span>
<span><span class="co">#&gt; 39     5.81     87.9 1.05 POINT (432626.9 5343223)</span></span>
<span><span class="co">#&gt; 664   16.20     86.6 4.51 POINT (437307.5 5341763)</span></span>
<span><span class="co">#&gt; 652   13.70     12.4 4.20 POINT (435285.1 5338539)</span></span>
<span><span class="co">#&gt; 2427  13.30     90.8 2.59 POINT (433324.6 5340774)</span></span>
<span><span class="co">#&gt; 53129 10.40     56.2 2.79 POINT (434683.3 5339103)</span></span>
<span><span class="co">#&gt; 370   20.70     92.9 4.80   POINT (433343 5339162)</span></span>
<span><span class="co">#&gt; 7393  18.40     88.3 3.64 POINT (438512.5 5342694)</span></span>
<span><span class="co">#&gt; 24622 17.10     96.9 2.36 POINT (432935.6 5340075)</span></span>
<span><span class="co">#&gt; 58993  1.39      0.0 0.00 POINT (435130.1 5339083)</span></span></code></pre>
<p>The sample distribution again mimics the population distribution
quite well! Now lets try using a cost variable to constrain the
sub-sample.</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- create distance from roads metric ---#</span></span>
<span><span class="va">dist</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_distance.html">calculate_distance</a></span><span class="op">(</span>raster <span class="op">=</span> <span class="va">mraster</span>, access <span class="op">=</span> <span class="va">access</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- sub sample using ---#</span></span>
<span><span class="fu"><a href="../reference/sample_existing.html">sample_existing</a></span><span class="op">(</span>existing <span class="op">=</span> <span class="va">existing</span>, <span class="co"># our existing sample</span></span>
<span>                nSamp <span class="op">=</span> <span class="fl">300</span>, <span class="co"># the number of samples we want</span></span>
<span>                raster <span class="op">=</span> <span class="va">dist</span>, <span class="co"># include mraster metrics to guide sampling of existing</span></span>
<span>                cost <span class="op">=</span> <span class="fl">4</span>, <span class="co"># either provide the index (band number) or the name of the cost layer</span></span>
<span>                plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># plot</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-35-1.png" width="700"><img src="sampling_files/figure-html/unnamed-chunk-35-2.png" width="700"></p>
<pre><code><span><span class="co">#&gt; Simple feature collection with 300 features and 4 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431148.5 ymin: 5337702 xmax: 438530.9 ymax: 5343240</span></span>
<span><span class="co">#&gt; CRS:           +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;         zq90 pzabove2  zsd dist2access                 geometry</span></span>
<span><span class="co">#&gt; 755100 14.80     89.3 3.56   576.28664 POINT (436859.4 5339723)</span></span>
<span><span class="co">#&gt; 81328  19.20     76.8 5.14   397.70747 POINT (437675.4 5339956)</span></span>
<span><span class="co">#&gt; 188100 19.50     92.1 3.98    35.21122 POINT (432780.6 5340619)</span></span>
<span><span class="co">#&gt; 565100 17.00     88.4 4.84   238.66747 POINT (434566.3 5338481)</span></span>
<span><span class="co">#&gt; 17140  13.40     67.1 4.06   411.22290 POINT (432119.6 5339843)</span></span>
<span><span class="co">#&gt; 55261  21.90     90.9 4.78   465.21211 POINT (435830.5 5340753)</span></span>
<span><span class="co">#&gt; 611100 14.50     71.6 3.61    24.94095 POINT (436277.3 5340734)</span></span>
<span><span class="co">#&gt; 638    27.00     96.7 8.40   217.86800   POINT (436841 5341336)</span></span>
<span><span class="co">#&gt; 1021   17.40     93.9 4.47   396.04954 POINT (431595.3 5340135)</span></span>
<span><span class="co">#&gt; 89369   4.45     60.2 0.98    60.40039 POINT (438335.1 5338673)</span></span></code></pre>
<p>Finally, should the user wish to further constrain the sample based
on <code>access</code> like other sampling approaches in
<code>sgsR</code> that is also possible.</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- ensure access and existing are in the same CRS ---#</span></span>
<span></span>
<span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html" class="external-link">st_crs</a></span><span class="op">(</span><span class="va">existing</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html" class="external-link">st_crs</a></span><span class="op">(</span><span class="va">access</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#--- sub sample using ---#</span></span>
<span><span class="fu"><a href="../reference/sample_existing.html">sample_existing</a></span><span class="op">(</span>existing <span class="op">=</span> <span class="va">existing</span>, <span class="co"># our existing sample</span></span>
<span>                nSamp <span class="op">=</span> <span class="fl">300</span>, <span class="co"># the number of samples we want</span></span>
<span>                raster <span class="op">=</span> <span class="va">dist</span>, <span class="co"># include mraster metrics to guide sampling of existing</span></span>
<span>                cost <span class="op">=</span> <span class="fl">4</span>, <span class="co"># either provide the index (band number) or the name of the cost layer</span></span>
<span>                access <span class="op">=</span> <span class="va">access</span>, <span class="co"># roads layer</span></span>
<span>                buff_inner <span class="op">=</span> <span class="fl">50</span>, <span class="co"># inner buffer - no samples within this distance from road</span></span>
<span>                buff_outer <span class="op">=</span> <span class="fl">300</span>, <span class="co"># outer buffer - no samples further than this distance from road</span></span>
<span>                plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># plot</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-36-1.png" width="700"><img src="sampling_files/figure-html/unnamed-chunk-36-2.png" width="700"></p>
<pre><code><span><span class="co">#&gt; Simple feature collection with 300 features and 4 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431169.6 ymin: 5337705 xmax: 438549.3 ymax: 5343240</span></span>
<span><span class="co">#&gt; Projected CRS: UTM_Zone_17_Northern_Hemisphere</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;        zq90 pzabove2  zsd dist2access                 geometry</span></span>
<span><span class="co">#&gt; 18618  5.62     31.1 1.33   153.82178 POINT (435093.3 5342308)</span></span>
<span><span class="co">#&gt; 639    6.22     27.4 1.65    71.46796 POINT (432917.2 5341688)</span></span>
<span><span class="co">#&gt; 9772  22.00     82.6 4.88    79.02299 POINT (434316.7 5342969)</span></span>
<span><span class="co">#&gt; 44436  1.93      0.2 0.19    98.72877 POINT (438315.3 5338226)</span></span>
<span><span class="co">#&gt; 661   18.90     95.6 3.43    67.95394 POINT (432528.3 5340989)</span></span>
<span><span class="co">#&gt; 283   17.80     81.5 4.15   174.36689 POINT (436102.5 5340831)</span></span>
<span><span class="co">#&gt; 2503   9.12     67.8 2.25   268.05976 POINT (436336.4 5342074)</span></span>
<span><span class="co">#&gt; 286   19.20     83.3 5.36   124.30869 POINT (435713.5 5340132)</span></span>
<span><span class="co">#&gt; 24480 19.60     96.3 4.35   122.31472 POINT (434800.3 5339725)</span></span>
<span><span class="co">#&gt; 1681   7.41     28.2 1.95   121.14378 POINT (435113.1 5342755)</span></span></code></pre>
<p>The greater constraints we add to the samples, the less likely we
will have strong correlations between the population and sample, so its
always important to understand these limitations and plan
accordingly.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://scholar.google.ca/citations?user=C_qdYDsAAAAJ&amp;hl=en" class="external-link">Tristan RH Goodbody</a>, <a href="https://forestry.ubc.ca/faculty-profile/nicholas-coops/" class="external-link">Nicholas C Coops</a>, <a href="https://www.researchgate.net/profile/Martin-Queinnec" class="external-link">Martin Queinnec</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
