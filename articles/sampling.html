<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Learn how to use sample_* functions.
">
<title>Sampling • sgsR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Sampling">
<meta property="og:description" content="Learn how to use sample_* functions.
">
<meta property="og:image" content="/reference/figures/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-115082821-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-115082821-1');
</script><script defer data-domain="pkgdown.r-lib.org,all.tidyverse.org" src="https://plausible.io/js/plausible.js"></script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">sgsR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.4.4</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/sgsR.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/calculating.html">Calculating</a>
    <a class="dropdown-item" href="../articles/sampling.html">Sampling</a>
    <a class="dropdown-item" href="../articles/stratification.html">Stratification</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/tgoodbody/sgsR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Sampling</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/tgoodbody/sgsR/blob/HEAD/vignettes/sampling.Rmd" class="external-link"><code>vignettes/sampling.Rmd</code></a></small>
      <div class="d-none name"><code>sampling.Rmd</code></div>
    </div>

    
    
<style type="text/css">
.infobox {
  padding: 1em 1em 1em 4em;
  margin-bottom: 10px;
  border: 2px solid #43602d;
  border-radius: 10px;
  background: #738e41 5px center/3em no-repeat;
}

.caution {
  background-image: url("https://tgoodbody.github.io/sgsR/logo.png");
}

</style>
<p>Currently, there are 9 functions associated with the
<code>sample</code> verb in the <code>sgsR</code> package:</p>
<table class="table">
<colgroup>
<col width="21%">
<col width="45%">
<col width="33%">
</colgroup>
<thead><tr class="header">
<th align="center">Algorithm</th>
<th align="center">Description</th>
<th align="center">Reference</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center"><a href="#srs"><code>sample_srs()</code></a></td>
<td align="center">Simple random</td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center"><a href="#systematic"><code>sample_systematic()</code></a></td>
<td align="center">Systematic</td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center"><a href="#sstrat"><code>sample_strat()</code></a></td>
<td align="center">Stratified</td>
<td align="center"><a href="https://www.sciencedirect.com/science/article/pii/S0034425721002303" class="external-link">Queinnec,
White, &amp; Coops (2021)</a></td>
</tr>
<tr class="even">
<td align="center"><a href="#sysstrat"><code>sample_sys_strat()</code></a></td>
<td align="center">Systematic Stratified</td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center"><a href="#nc"><code>sample_nc()</code></a></td>
<td align="center">Nearest centroid</td>
<td align="center"><a href="https://doi.org/10.1080/00049158.2016.1218265" class="external-link">Melville &amp;
Stone (2016)</a></td>
</tr>
<tr class="even">
<td align="center"><a href="#clhs"><code>sample_clhs()</code></a></td>
<td align="center">Conditioned Latin hypercube</td>
<td align="center"><a href="https://www.sciencedirect.com/science/article/pii/S009830040500292X?via%3Dihub" class="external-link">Minasny
&amp; McBratney (2006)</a></td>
</tr>
<tr class="odd">
<td align="center"><a href="#balanced"><code>sample_balanced()</code></a></td>
<td align="center">Balanced sampling</td>
<td align="center"><a href="http://www.antongrafstrom.se/balancedsampling/" class="external-link">Grafström, A.
Lisic, J (2018)</a></td>
</tr>
<tr class="even">
<td align="center"><a href="#ahels"><code>sample_ahels()</code></a></td>
<td align="center">Adapted hypercube evaluation of a legacy sample</td>
<td align="center"><a href="https://peerj.com/articles/6451/" class="external-link">Malone,
Minasny, &amp; Brungard (2019)</a></td>
</tr>
<tr class="odd">
<td align="center"><a href="#samp-existing"><code>sample_existing()</code></a></td>
<td align="center">Sub-sampling an <code>existing</code> sample</td>
<td align="center"></td>
</tr>
</tbody>
</table>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="srs">
<code>sample_srs</code><a class="anchor" aria-label="anchor" href="#srs"></a>
</h2>
<p>We have demonstrated a simple example of using the
<code><a href="../reference/sample_srs.html">sample_srs()</a></code> function in <code><a href="../articles/sgsR.html">vignette("sgsR")</a></code>. We
will demonstrate additional examples below.</p>
<div class="infobox caution">
<p><strong><code>raster</code></strong></p>
<p>The input required for <code><a href="../reference/sample_srs.html">sample_srs()</a></code> is a
<code>raster</code>. This means that <code>sraster</code> and
<code>mraster</code> are supported for this function.</p>
</div>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- perform simple random sampling ---#</span></span>
<span><span class="fu"><a href="../reference/sample_srs.html">sample_srs</a></span><span class="op">(</span></span>
<span>  raster <span class="op">=</span> <span class="va">sraster</span>, <span class="co"># input sraster</span></span>
<span>  nSamp <span class="op">=</span> <span class="fl">200</span>, <span class="co"># number of desired sample units</span></span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span> <span class="co"># plot</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; Simple feature collection with 200 features and 0 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431210 ymin: 5337710 xmax: 438530 ymax: 5343230</span></span>
<span><span class="co">#&gt; Projected CRS: UTM Zone 17, Northern Hemisphere</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;                  geometry</span></span>
<span><span class="co">#&gt; 1  POINT (433610 5339530)</span></span>
<span><span class="co">#&gt; 2  POINT (437970 5338470)</span></span>
<span><span class="co">#&gt; 3  POINT (434390 5338450)</span></span>
<span><span class="co">#&gt; 4  POINT (433950 5341430)</span></span>
<span><span class="co">#&gt; 5  POINT (433050 5340270)</span></span>
<span><span class="co">#&gt; 6  POINT (433310 5340870)</span></span>
<span><span class="co">#&gt; 7  POINT (432450 5340310)</span></span>
<span><span class="co">#&gt; 8  POINT (433790 5342210)</span></span>
<span><span class="co">#&gt; 9  POINT (437870 5341610)</span></span>
<span><span class="co">#&gt; 10 POINT (434890 5342550)</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sample_srs.html">sample_srs</a></span><span class="op">(</span></span>
<span>  raster <span class="op">=</span> <span class="va">mraster</span>, <span class="co"># input mraster</span></span>
<span>  nSamp <span class="op">=</span> <span class="fl">200</span>, <span class="co"># number of desired sample units</span></span>
<span>  access <span class="op">=</span> <span class="va">access</span>, <span class="co"># define access road network</span></span>
<span>  mindist <span class="op">=</span> <span class="fl">200</span>, <span class="co"># minimum distance sample units must be apart from one another</span></span>
<span>  buff_inner <span class="op">=</span> <span class="fl">50</span>, <span class="co"># inner buffer - no sample units within this distance from road</span></span>
<span>  buff_outer <span class="op">=</span> <span class="fl">200</span>, <span class="co"># outer buffer - no sample units further than this distance from road</span></span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span> <span class="co"># plot</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; Simple feature collection with 200 features and 0 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431150 ymin: 5337710 xmax: 438550 ymax: 5343230</span></span>
<span><span class="co">#&gt; Projected CRS: UTM Zone 17, Northern Hemisphere</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;                  geometry</span></span>
<span><span class="co">#&gt; 1  POINT (436170 5340390)</span></span>
<span><span class="co">#&gt; 2  POINT (435830 5342430)</span></span>
<span><span class="co">#&gt; 3  POINT (434850 5341150)</span></span>
<span><span class="co">#&gt; 4  POINT (434090 5340830)</span></span>
<span><span class="co">#&gt; 5  POINT (438210 5339150)</span></span>
<span><span class="co">#&gt; 6  POINT (433690 5342550)</span></span>
<span><span class="co">#&gt; 7  POINT (434630 5340850)</span></span>
<span><span class="co">#&gt; 8  POINT (438350 5340970)</span></span>
<span><span class="co">#&gt; 9  POINT (435150 5341970)</span></span>
<span><span class="co">#&gt; 10 POINT (433390 5342030)</span></span></code></pre>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="systematic">
<code>sample_systematic</code><a class="anchor" aria-label="anchor" href="#systematic"></a>
</h2>
<p>The <code><a href="../reference/sample_systematic.html">sample_systematic()</a></code> function applies systematic
sampling across an area with the <code>cellsize</code> parameter
defining the resolution of the tessellation. The tessellation shape can
be modified using the <code>square</code> parameter. Assigning
<code>TRUE</code> (default) to the <code>square</code> parameter results
in a regular grid and assigning <code>FALSE</code> results in a
hexagonal grid.</p>
<p>The location of sample units can also be adjusted using the
<code>locations</code> parameter, where <code>centers</code> takes the
center, <code>corners</code> takes all corners, and <code>random</code>
takes a random location within each tessellation. Random start points
and translations are applied when the function is called.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- perform grid sampling ---#</span></span>
<span><span class="fu"><a href="../reference/sample_systematic.html">sample_systematic</a></span><span class="op">(</span></span>
<span>  raster <span class="op">=</span> <span class="va">sraster</span>, <span class="co"># input sraster</span></span>
<span>  cellsize <span class="op">=</span> <span class="fl">1000</span>, <span class="co"># grid distance</span></span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span> <span class="co"># plot</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; Simple feature collection with 38 features and 0 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431170.2 ymin: 5337717 xmax: 438443.5 ymax: 5343087</span></span>
<span><span class="co">#&gt; Projected CRS: UTM Zone 17, Northern Hemisphere</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;                    geometry</span></span>
<span><span class="co">#&gt; 1  POINT (438402.7 5342155)</span></span>
<span><span class="co">#&gt; 2  POINT (437430.2 5342388)</span></span>
<span><span class="co">#&gt; 3  POINT (436457.7 5342621)</span></span>
<span><span class="co">#&gt; 4  POINT (435485.2 5342854)</span></span>
<span><span class="co">#&gt; 5  POINT (434512.7 5343087)</span></span>
<span><span class="co">#&gt; 6  POINT (438169.7 5341182)</span></span>
<span><span class="co">#&gt; 7  POINT (437197.2 5341415)</span></span>
<span><span class="co">#&gt; 8  POINT (436224.8 5341648)</span></span>
<span><span class="co">#&gt; 9  POINT (435252.3 5341881)</span></span>
<span><span class="co">#&gt; 10 POINT (434279.8 5342114)</span></span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- perform grid sampling ---#</span></span>
<span><span class="fu"><a href="../reference/sample_systematic.html">sample_systematic</a></span><span class="op">(</span></span>
<span>  raster <span class="op">=</span> <span class="va">sraster</span>, <span class="co"># input sraster</span></span>
<span>  cellsize <span class="op">=</span> <span class="fl">500</span>, <span class="co"># grid distance</span></span>
<span>  square <span class="op">=</span> <span class="cn">FALSE</span>, <span class="co"># hexagonal tessellation</span></span>
<span>  location <span class="op">=</span> <span class="st">"random"</span>, <span class="co"># randomly sample within tessellation</span></span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span> <span class="co"># plot</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; Simple feature collection with 171 features and 0 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431134.2 ymin: 5337702 xmax: 438506.7 ymax: 5343201</span></span>
<span><span class="co">#&gt; Projected CRS: UTM Zone 17, Northern Hemisphere</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;                    geometry</span></span>
<span><span class="co">#&gt; 1    POINT (431206 5343189)</span></span>
<span><span class="co">#&gt; 2  POINT (431838.6 5342975)</span></span>
<span><span class="co">#&gt; 3  POINT (431641.3 5342419)</span></span>
<span><span class="co">#&gt; 4  POINT (432243.7 5343163)</span></span>
<span><span class="co">#&gt; 5  POINT (431520.8 5342051)</span></span>
<span><span class="co">#&gt; 6  POINT (431977.5 5342453)</span></span>
<span><span class="co">#&gt; 7  POINT (431748.5 5341389)</span></span>
<span><span class="co">#&gt; 8  POINT (431913.5 5342054)</span></span>
<span><span class="co">#&gt; 9  POINT (432680.6 5342928)</span></span>
<span><span class="co">#&gt; 10 POINT (431570.1 5341018)</span></span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sample_systematic.html">sample_systematic</a></span><span class="op">(</span></span>
<span>  raster <span class="op">=</span> <span class="va">sraster</span>, <span class="co"># input sraster</span></span>
<span>  cellsize <span class="op">=</span> <span class="fl">500</span>, <span class="co"># grid distance</span></span>
<span>  access <span class="op">=</span> <span class="va">access</span>, <span class="co"># define access road network</span></span>
<span>  buff_outer <span class="op">=</span> <span class="fl">200</span>, <span class="co"># outer buffer - no sample units further than this distance from road</span></span>
<span>  square <span class="op">=</span> <span class="cn">FALSE</span>, <span class="co"># hexagonal tessellation</span></span>
<span>  location <span class="op">=</span> <span class="st">"corners"</span>, <span class="co"># take corners instead of centers</span></span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; Simple feature collection with 633 features and 0 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431156.6 ymin: 5337786 xmax: 438518.2 ymax: 5343176</span></span>
<span><span class="co">#&gt; Projected CRS: UTM Zone 17, Northern Hemisphere</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;                    geometry</span></span>
<span><span class="co">#&gt; 1    POINT (438081 5337786)</span></span>
<span><span class="co">#&gt; 2  POINT (438353.9 5337880)</span></span>
<span><span class="co">#&gt; 3  POINT (438353.9 5337880)</span></span>
<span><span class="co">#&gt; 4  POINT (438408.6 5338164)</span></span>
<span><span class="co">#&gt; 5    POINT (438081 5337786)</span></span>
<span><span class="co">#&gt; 6  POINT (437590.1 5337881)</span></span>
<span><span class="co">#&gt; 7  POINT (437862.9 5337975)</span></span>
<span><span class="co">#&gt; 8    POINT (438081 5337786)</span></span>
<span><span class="co">#&gt; 9  POINT (438408.6 5338164)</span></span>
<span><span class="co">#&gt; 10 POINT (438353.9 5337880)</span></span></code></pre>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="sstrat">
<code>sample_strat</code><a class="anchor" aria-label="anchor" href="#sstrat"></a>
</h2>
<p>The <code><a href="../reference/sample_strat.html">sample_strat()</a></code> contains two <code>method</code>s to
perform sampling:</p>
<ul>
<li><p><code>"Queinnec"</code> - Hierarchical sampling using a focal
window to isolate contiguous groups of stratum pixels, which was
originally developed by Martin Queinnec.</p></li>
<li><p><code>"random"</code> - Traditional stratified random sampling.
This <code>method</code> ignores much of the functionality of the
algorithm to allow users the capability to use standard stratified
random sampling approaches without the use of a focal window to locate
contiguous stratum cells.</p></li>
</ul>
<div class="section level3 unnumbered">
<h3 class="unnumbered" id="queinnec">
<code>method = "Queinnec"</code><a class="anchor" aria-label="anchor" href="#queinnec"></a>
</h3>
<p><em>Queinnec, M., White, J. C., &amp; Coops, N. C. (2021). Comparing
airborne and spaceborne photon-counting LiDAR canopy structural
estimates across different boreal forest types. Remote Sensing of
Environment, 262(August 2020), 112510.</em></p>
<p>This algorithm uses moving window (<code>wrow</code> and
<code>wcol</code> parameters) to filter the input <code>sraster</code>
to prioritize sample unit allocation to where stratum pixels are
spatially grouped, rather than dispersed individuals across the
landscape.</p>
<p>Sampling is performed using 2 rules:</p>
<ul>
<li><p><strong>Rule 1</strong> - Sample within spatially grouped stratum
pixels. Moving window defined by <code>wrow</code> and
<code>wcol</code>.</p></li>
<li><p><strong>Rule 2</strong> - If no additional sample units exist to
satisfy desired sample size(<code>nSamp</code>), individual stratum
pixels are sampled.</p></li>
</ul>
<p>The rule applied to a select each sample unit is defined in the
<code>rule</code> attribute of output samples. We give a few examples
below:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- perform stratified sampling random sampling ---#</span></span>
<span><span class="fu"><a href="../reference/sample_strat.html">sample_strat</a></span><span class="op">(</span></span>
<span>  sraster <span class="op">=</span> <span class="va">sraster</span>, <span class="co"># input sraster</span></span>
<span>  nSamp <span class="op">=</span> <span class="fl">200</span></span>
<span><span class="op">)</span> <span class="co"># desired sample size # plot</span></span>
<span><span class="co">#&gt; Simple feature collection with 200 features and 3 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431190 ymin: 5337770 xmax: 438490 ymax: 5343090</span></span>
<span><span class="co">#&gt; Projected CRS: UTM Zone 17, Northern Hemisphere</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;    strata type  rule               geometry</span></span>
<span><span class="co">#&gt; x       1  new rule1 POINT (437870 5342410)</span></span>
<span><span class="co">#&gt; x1      1  new rule1 POINT (433350 5341130)</span></span>
<span><span class="co">#&gt; x2      1  new rule1 POINT (434730 5341530)</span></span>
<span><span class="co">#&gt; x3      1  new rule1 POINT (435410 5342110)</span></span>
<span><span class="co">#&gt; x4      1  new rule1 POINT (438090 5339450)</span></span>
<span><span class="co">#&gt; x5      1  new rule1 POINT (437210 5338130)</span></span>
<span><span class="co">#&gt; x6      1  new rule1 POINT (434290 5340710)</span></span>
<span><span class="co">#&gt; x7      1  new rule1 POINT (434370 5341990)</span></span>
<span><span class="co">#&gt; x8      1  new rule1 POINT (437710 5338090)</span></span>
<span><span class="co">#&gt; x9      1  new rule1 POINT (438150 5340950)</span></span></code></pre></div>
<p>In some cases, users might want to include an <code>existing</code>
sample within the algorithm. In order to adjust the total number of
sample units needed per stratum to reflect those already present in
<code>existing</code>, we can use the intermediate function
<code><a href="../reference/extract_strata.html">extract_strata()</a></code>.</p>
<p>This function uses the <code>sraster</code> and <code>existing</code>
sample units and extracts the stratum for each. These sample units can
be included within <code><a href="../reference/sample_strat.html">sample_strat()</a></code>, which adjusts total
sample units required per class based on representation in
<code>existing</code>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- extract strata values to existing samples ---#</span></span>
<span><span class="va">e.sr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_strata.html">extract_strata</a></span><span class="op">(</span></span>
<span>  sraster <span class="op">=</span> <span class="va">sraster</span>, <span class="co"># input sraster</span></span>
<span>  existing <span class="op">=</span> <span class="va">existing</span></span>
<span><span class="op">)</span> <span class="co"># existing samples to add strata value to</span></span></code></pre></div>
<div class="infobox caution">
<p><strong>TIP!</strong></p>
<p><code><a href="../reference/sample_strat.html">sample_strat()</a></code> requires the <code>sraster</code> input
to have an attribute named <code>strata</code> and will give an error if
it doesn’t.</p>
</div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sample_strat.html">sample_strat</a></span><span class="op">(</span></span>
<span>  sraster <span class="op">=</span> <span class="va">sraster</span>, <span class="co"># input sraster</span></span>
<span>  nSamp <span class="op">=</span> <span class="fl">200</span>, <span class="co"># desired sample size</span></span>
<span>  access <span class="op">=</span> <span class="va">access</span>, <span class="co"># define access road network</span></span>
<span>  existing <span class="op">=</span> <span class="va">e.sr</span>, <span class="co"># existing sample with strata values</span></span>
<span>  mindist <span class="op">=</span> <span class="fl">200</span>, <span class="co"># minimum distance sample units must be apart from one another</span></span>
<span>  buff_inner <span class="op">=</span> <span class="fl">50</span>, <span class="co"># inner buffer - no sample units within this distance from road</span></span>
<span>  buff_outer <span class="op">=</span> <span class="fl">200</span>, <span class="co"># outer buffer - no sample units further than this distance from road</span></span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span> <span class="co"># plot</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; Simple feature collection with 400 features and 3 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431130 ymin: 5337730 xmax: 438510 ymax: 5343230</span></span>
<span><span class="co">#&gt; Projected CRS: UTM Zone 17, Northern Hemisphere</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;    strata     type     rule               geometry</span></span>
<span><span class="co">#&gt; 1       1 existing existing POINT (436770 5337830)</span></span>
<span><span class="co">#&gt; 2       1 existing existing POINT (435130 5342530)</span></span>
<span><span class="co">#&gt; 3       1 existing existing POINT (438510 5339310)</span></span>
<span><span class="co">#&gt; 4       1 existing existing POINT (434250 5341650)</span></span>
<span><span class="co">#&gt; 5       1 existing existing POINT (437650 5339230)</span></span>
<span><span class="co">#&gt; 6       1 existing existing POINT (438090 5338350)</span></span>
<span><span class="co">#&gt; 7       1 existing existing POINT (437890 5341190)</span></span>
<span><span class="co">#&gt; 8       1 existing existing POINT (433690 5341450)</span></span>
<span><span class="co">#&gt; 9       1 existing existing POINT (435790 5342370)</span></span>
<span><span class="co">#&gt; 10      1 existing existing POINT (437730 5339130)</span></span></code></pre>
<p>The code in the example above defined the <code>mindist</code>
parameter, which specifies the minimum euclidean distance that new
sample units must be apart from one another.</p>
<p>Notice that the sample units have <code>type</code> and
<code>rule</code> attributes which outline whether they are
<code>existing</code> or <code>new</code>, and whether
<code>rule1</code> or <code>rule2</code> were used to select them. If
<code>type</code> is <em>existing</em> (a user provided
<code>existing</code> sample), <code>rule</code> will be
<em>existing</em> as well as seen above.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sample_strat.html">sample_strat</a></span><span class="op">(</span></span>
<span>  sraster <span class="op">=</span> <span class="va">sraster</span>, <span class="co"># input</span></span>
<span>  nSamp <span class="op">=</span> <span class="fl">200</span>, <span class="co"># desired sample size</span></span>
<span>  access <span class="op">=</span> <span class="va">access</span>, <span class="co"># define access road network</span></span>
<span>  existing <span class="op">=</span> <span class="va">e.sr</span>, <span class="co"># existing samples with strata values</span></span>
<span>  include <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># include existing sample in nSamp total</span></span>
<span>  buff_outer <span class="op">=</span> <span class="fl">200</span>, <span class="co"># outer buffer - no samples further than this distance from road</span></span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span> <span class="co"># plot</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; Simple feature collection with 200 features and 3 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431130 ymin: 5337730 xmax: 438510 ymax: 5343210</span></span>
<span><span class="co">#&gt; Projected CRS: UTM Zone 17, Northern Hemisphere</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;    strata     type     rule               geometry</span></span>
<span><span class="co">#&gt; 1       1 existing existing POINT (436770 5337830)</span></span>
<span><span class="co">#&gt; 2       1 existing existing POINT (435130 5342530)</span></span>
<span><span class="co">#&gt; 3       1 existing existing POINT (438510 5339310)</span></span>
<span><span class="co">#&gt; 4       1 existing existing POINT (434250 5341650)</span></span>
<span><span class="co">#&gt; 5       1 existing existing POINT (437650 5339230)</span></span>
<span><span class="co">#&gt; 6       1 existing existing POINT (438090 5338350)</span></span>
<span><span class="co">#&gt; 7       1 existing existing POINT (437890 5341190)</span></span>
<span><span class="co">#&gt; 8       1 existing existing POINT (433690 5341450)</span></span>
<span><span class="co">#&gt; 9       1 existing existing POINT (435790 5342370)</span></span>
<span><span class="co">#&gt; 10      1 existing existing POINT (437730 5339130)</span></span></code></pre>
<p>The <code>include</code> parameter determines whether
<code>existing</code> sample units should be included in the total
sample size defined by <code>nSamp</code>. By default, the
<code>include</code> parameter is set as <code>FALSE</code>.</p>
</div>
<div class="section level3 unnumbered">
<h3 class="unnumbered" id="stratrandom">
<code>method = "random</code><a class="anchor" aria-label="anchor" href="#stratrandom"></a>
</h3>
<p>Stratified random sampling with equal probability for all cells
(using default algorithm values for <code>mindist</code> and no use of
<code>access</code> functionality). In essence this method perform the
<code>sample_srs</code> algorithm for each stratum separately to meet
the specified sample size.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- perform stratified sampling random sampling ---#</span></span>
<span><span class="fu"><a href="../reference/sample_strat.html">sample_strat</a></span><span class="op">(</span></span>
<span>  sraster <span class="op">=</span> <span class="va">sraster</span>, <span class="co"># input sraster</span></span>
<span>  method <span class="op">=</span> <span class="st">"random"</span>, <span class="co"># stratified random sampling</span></span>
<span>  nSamp <span class="op">=</span> <span class="fl">200</span>, <span class="co"># desired sample size</span></span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span> <span class="co"># plot</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; Simple feature collection with 200 features and 2 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431110 ymin: 5337710 xmax: 438490 ymax: 5343190</span></span>
<span><span class="co">#&gt; Projected CRS: UTM Zone 17, Northern Hemisphere</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;    strata type               geometry</span></span>
<span><span class="co">#&gt; x       1  new POINT (438470 5338150)</span></span>
<span><span class="co">#&gt; x1      1  new POINT (436590 5338270)</span></span>
<span><span class="co">#&gt; x2      1  new POINT (437710 5338430)</span></span>
<span><span class="co">#&gt; x3      1  new POINT (434970 5342130)</span></span>
<span><span class="co">#&gt; x4      1  new POINT (436410 5339770)</span></span>
<span><span class="co">#&gt; x5      1  new POINT (435330 5341970)</span></span>
<span><span class="co">#&gt; x6      1  new POINT (435030 5341790)</span></span>
<span><span class="co">#&gt; x7      1  new POINT (438250 5339430)</span></span>
<span><span class="co">#&gt; x8      1  new POINT (435370 5342270)</span></span>
<span><span class="co">#&gt; x9      1  new POINT (435790 5339270)</span></span></code></pre>
</div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="sysstrat">
<code>sample_sys_strat</code><a class="anchor" aria-label="anchor" href="#sysstrat"></a>
</h2>
<p><code><a href="../reference/sample_sys_strat.html">sample_sys_strat()</a></code> function implements systematic
stratified sampling on an <code>sraster</code>. This function uses the
same functionality as <code><a href="../reference/sample_systematic.html">sample_systematic()</a></code> but takes an
<code>sraster</code> as input and performs sampling on each stratum
iteratively.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- perform grid sampling on each stratum separately ---#</span></span>
<span><span class="fu"><a href="../reference/sample_sys_strat.html">sample_sys_strat</a></span><span class="op">(</span></span>
<span>  sraster <span class="op">=</span> <span class="va">sraster</span>, <span class="co"># input sraster with 4 strata</span></span>
<span>  cellsize <span class="op">=</span> <span class="fl">1000</span>, <span class="co"># grid size</span></span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span> <span class="co"># plot output</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: [readStart] source already open for reading</span></span>
<span><span class="co">#&gt; Processing strata : 1</span></span>
<span><span class="co">#&gt; Warning: [extract] source already open for reading</span></span>
<span><span class="co">#&gt; Processing strata : 2</span></span>
<span><span class="co">#&gt; Warning: [extract] source already open for reading</span></span>
<span><span class="co">#&gt; Processing strata : 3</span></span>
<span><span class="co">#&gt; Warning: [extract] source already open for reading</span></span>
<span><span class="co">#&gt; Processing strata : 4</span></span>
<span><span class="co">#&gt; Warning: [extract] source already open for reading</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; Simple feature collection with 37 features and 1 field</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431254.5 ymin: 5337880 xmax: 438411 ymax: 5342976</span></span>
<span><span class="co">#&gt; Projected CRS: UTM Zone 17, Northern Hemisphere</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;    strata                 geometry</span></span>
<span><span class="co">#&gt; 1       1 POINT (431254.5 5340691)</span></span>
<span><span class="co">#&gt; 2       1 POINT (433488.9 5342929)</span></span>
<span><span class="co">#&gt; 3       1 POINT (432149.3 5340244)</span></span>
<span><span class="co">#&gt; 4       1 POINT (434383.7 5342482)</span></span>
<span><span class="co">#&gt; 5       1 POINT (433490.6 5340693)</span></span>
<span><span class="co">#&gt; 6       1 POINT (435278.4 5342036)</span></span>
<span><span class="co">#&gt; 7       1   POINT (437961 5342932)</span></span>
<span><span class="co">#&gt; 8       1 POINT (436623.2 5338012)</span></span>
<span><span class="co">#&gt; 9       1   POINT (438411 5339355)</span></span>
<span><span class="co">#&gt; 10      1 POINT (437964.5 5338460)</span></span></code></pre>
<p>Just like with <code><a href="../reference/sample_systematic.html">sample_systematic()</a></code> we can specify where
we want our samples to fall within our tessellations. We specify
<code>location = "corners"</code> below. Note that the tesselations are
all saved to a list file when <code>details = TRUE</code> should the
user want to save them.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sample_sys_strat.html">sample_sys_strat</a></span><span class="op">(</span></span>
<span>  sraster <span class="op">=</span> <span class="va">sraster</span>, <span class="co"># input sraster with 4 strata</span></span>
<span>  cellsize <span class="op">=</span> <span class="fl">500</span>, <span class="co"># grid size</span></span>
<span>  square <span class="op">=</span> <span class="cn">FALSE</span>, <span class="co"># hexagon tessellation</span></span>
<span>  location <span class="op">=</span> <span class="st">"corners"</span>, <span class="co"># samples on tessellation corners</span></span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span> <span class="co"># plot output</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Processing strata : 1</span></span>
<span><span class="co">#&gt; Warning: [extract] source already open for reading</span></span>
<span><span class="co">#&gt; Processing strata : 2</span></span>
<span><span class="co">#&gt; Warning: [extract] source already open for reading</span></span>
<span><span class="co">#&gt; Processing strata : 3</span></span>
<span><span class="co">#&gt; Warning: [extract] source already open for reading</span></span>
<span><span class="co">#&gt; Processing strata : 4</span></span>
<span><span class="co">#&gt; Warning: [extract] source already open for reading</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; Simple feature collection with 1212 features and 1 field</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431111.9 ymin: 5337720 xmax: 438559.1 ymax: 5343217</span></span>
<span><span class="co">#&gt; Projected CRS: UTM Zone 17, Northern Hemisphere</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;    strata                 geometry</span></span>
<span><span class="co">#&gt; 1       1 POINT (431441.6 5340809)</span></span>
<span><span class="co">#&gt; 2       1   POINT (431244 5342530)</span></span>
<span><span class="co">#&gt; 3       1 POINT (431441.6 5340809)</span></span>
<span><span class="co">#&gt; 4       1   POINT (431244 5342530)</span></span>
<span><span class="co">#&gt; 5       1 POINT (431441.6 5340809)</span></span>
<span><span class="co">#&gt; 6       1   POINT (431244 5342530)</span></span>
<span><span class="co">#&gt; 7       1 POINT (432334.9 5339604)</span></span>
<span><span class="co">#&gt; 8       1 POINT (432334.9 5339604)</span></span>
<span><span class="co">#&gt; 9       1 POINT (432334.9 5339604)</span></span>
<span><span class="co">#&gt; 10      1   POINT (432833 5341841)</span></span></code></pre>
<p>This sampling approach could be especially useful incombination with
<code><a href="../reference/strat_poly.html">strat_poly()</a></code> to ensure consistency of sampling accross
specific management units.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- read polygon coverage ---#</span></span>
<span><span class="va">poly</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"inventory_polygons.shp"</span>, package <span class="op">=</span> <span class="st">"sgsR"</span><span class="op">)</span></span>
<span><span class="va">fri</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">st_read</a></span><span class="op">(</span><span class="va">poly</span><span class="op">)</span></span>
<span><span class="co">#&gt; Reading layer `inventory_polygons' from data source </span></span>
<span><span class="co">#&gt;   `/home/runner/work/_temp/Library/sgsR/extdata/inventory_polygons.shp' </span></span>
<span><span class="co">#&gt;   using driver `ESRI Shapefile'</span></span>
<span><span class="co">#&gt; Simple feature collection with 632 features and 3 fields</span></span>
<span><span class="co">#&gt; Geometry type: MULTIPOLYGON</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431100 ymin: 5337700 xmax: 438560 ymax: 5343240</span></span>
<span><span class="co">#&gt; Projected CRS: UTM_Zone_17_Northern_Hemisphere</span></span>
<span></span>
<span><span class="co">#--- stratify polygon coverage ---#</span></span>
<span><span class="co">#--- specify polygon attribute to stratify ---#</span></span>
<span><span class="va">attribute</span> <span class="op">&lt;-</span> <span class="st">"NUTRIENTS"</span></span>
<span></span>
<span><span class="co">#--- specify features within attribute &amp; how they should be grouped ---#</span></span>
<span><span class="co">#--- as a single vector ---#</span></span>
<span><span class="va">features</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"poor"</span>, <span class="st">"rich"</span>, <span class="st">"medium"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#--- get polygon stratification ---#</span></span>
<span><span class="va">srasterpoly</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/strat_poly.html">strat_poly</a></span><span class="op">(</span></span>
<span>  poly <span class="op">=</span> <span class="va">fri</span>,</span>
<span>  attribute <span class="op">=</span> <span class="va">attribute</span>,</span>
<span>  features <span class="op">=</span> <span class="va">features</span>,</span>
<span>  raster <span class="op">=</span> <span class="va">sraster</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">#--- systematatic stratified sampling for each stratum ---#</span></span>
<span><span class="fu"><a href="../reference/sample_sys_strat.html">sample_sys_strat</a></span><span class="op">(</span></span>
<span>  sraster <span class="op">=</span> <span class="va">srasterpoly</span>, <span class="co"># input sraster from strat_poly() with 3 strata</span></span>
<span>  cellsize <span class="op">=</span> <span class="fl">500</span>, <span class="co"># grid size</span></span>
<span>  square <span class="op">=</span> <span class="cn">FALSE</span>, <span class="co"># hexagon tessellation</span></span>
<span>  location <span class="op">=</span> <span class="st">"random"</span>, <span class="co"># randomize plot location</span></span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span> <span class="co"># plot output</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Processing strata : 1</span></span>
<span><span class="co">#&gt; Warning: [extract] source already open for reading</span></span>
<span><span class="co">#&gt; Processing strata : 2</span></span>
<span><span class="co">#&gt; Warning: [extract] source already open for reading</span></span>
<span><span class="co">#&gt; Processing strata : 3</span></span>
<span><span class="co">#&gt; Warning: [extract] source already open for reading</span></span>
<span><span class="co">#&gt; Simple feature collection with 183 features and 1 field</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431132.2 ymin: 5337734 xmax: 438473.2 ymax: 5343234</span></span>
<span><span class="co">#&gt; Projected CRS: UTM Zone 17, Northern Hemisphere</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;    strata                 geometry</span></span>
<span><span class="co">#&gt; 1       1 POINT (438367.9 5338118)</span></span>
<span><span class="co">#&gt; 2       1 POINT (438103.3 5338334)</span></span>
<span><span class="co">#&gt; 3       1 POINT (437910.1 5338846)</span></span>
<span><span class="co">#&gt; 4       1 POINT (437708.7 5338204)</span></span>
<span><span class="co">#&gt; 5       1 POINT (437789.5 5338773)</span></span>
<span><span class="co">#&gt; 6       1 POINT (437985.3 5339189)</span></span>
<span><span class="co">#&gt; 7       1 POINT (437778.9 5339517)</span></span>
<span><span class="co">#&gt; 8       1   POINT (436621 5338386)</span></span>
<span><span class="co">#&gt; 9       1 POINT (438473.2 5340775)</span></span>
<span><span class="co">#&gt; 10      1 POINT (438248.6 5340676)</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="nc">
<code>sample_nc</code><a class="anchor" aria-label="anchor" href="#nc"></a>
</h2>
<p><code><a href="../reference/sample_nc.html">sample_nc()</a></code> function implements the Nearest Centroid
sampling algorithm described in <a href="https://doi.org/10.1080/00049158.2016.1218265" class="external-link">Melville &amp;
Stone (2016)</a>. The algorithm uses kmeans clustering where the number
of clusters (centroids) is equal to the desired sample size
(<code>nSamp</code>).</p>
<p>Cluster centers are located, which then prompts the nearest neighbour
<code>mraster</code> pixel for each cluster to be selected (assuming
default <code>k</code> parameter). These nearest neighbours are the
output sample units.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- perform simple random sampling ---#</span></span>
<span><span class="fu"><a href="../reference/sample_nc.html">sample_nc</a></span><span class="op">(</span></span>
<span>  mraster <span class="op">=</span> <span class="va">mraster</span>, <span class="co"># input</span></span>
<span>  nSamp <span class="op">=</span> <span class="fl">25</span>, <span class="co"># desired sample size</span></span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; K-means being performed on 3 layers with 25 centers.</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; Simple feature collection with 25 features and 4 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431190 ymin: 5337910 xmax: 438530 ymax: 5343170</span></span>
<span><span class="co">#&gt; Projected CRS: UTM Zone 17, Northern Hemisphere</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;        zq90 pzabove2  zsd kcenter               geometry</span></span>
<span><span class="co">#&gt; 39139  8.10     85.4 1.80       1 POINT (438030 5341150)</span></span>
<span><span class="co">#&gt; 4907  12.10     51.2 3.34       2 POINT (432250 5342970)</span></span>
<span><span class="co">#&gt; 32617  4.58     29.5 1.06       3 POINT (434410 5341490)</span></span>
<span><span class="co">#&gt; 99324 23.50     89.9 6.85       4 POINT (433210 5337910)</span></span>
<span><span class="co">#&gt; 21644 18.70     87.7 5.09       5 POINT (431290 5342070)</span></span>
<span><span class="co">#&gt; 16935 15.50     94.8 2.71       6 POINT (434090 5342330)</span></span>
<span><span class="co">#&gt; 44332 12.40     75.2 3.16       7 POINT (437450 5340870)</span></span>
<span><span class="co">#&gt; 22393 20.10     92.2 4.32       8 POINT (431350 5342030)</span></span>
<span><span class="co">#&gt; 73113 17.80     93.0 3.49       9 POINT (431190 5339310)</span></span>
<span><span class="co">#&gt; 41508 19.80     74.0 6.00      10 POINT (433190 5341010)</span></span></code></pre>
<p>Altering the <code>k</code> parameter leads to a multiplicative
increase in output sample units where total output samples = <span class="math inline">\(nSamp * k\)</span>.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- perform simple random sampling ---#</span></span>
<span><span class="va">samples</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sample_nc.html">sample_nc</a></span><span class="op">(</span></span>
<span>  mraster <span class="op">=</span> <span class="va">mraster</span>, <span class="co"># input</span></span>
<span>  k <span class="op">=</span> <span class="fl">2</span>, <span class="co"># number of nearest neighbours to take for each kmeans center</span></span>
<span>  nSamp <span class="op">=</span> <span class="fl">25</span>, <span class="co"># desired sample size</span></span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; K-means being performed on 3 layers with 25 centers.</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-19-1.png" width="700"></p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">#--- total samples = nSamp * k (25 * 2) = 50 ---#</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">samples</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 50</span></span></code></pre></div>
<p>Visualizing what the kmeans centers and sample units looks like is
possible when using <code>details = TRUE</code>. The <code>$kplot</code>
output provides a quick visualization of where the centers are based on
a scatter plot of the first 2 layers in <code>mraster</code>. Notice
that the centers are well distributed in covariate space and chosen
sample units are the closest pixels to each center (nearest
neighbours).</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- perform simple random sampling with details ---#</span></span>
<span><span class="va">details</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sample_nc.html">sample_nc</a></span><span class="op">(</span></span>
<span>  mraster <span class="op">=</span> <span class="va">mraster</span>, <span class="co"># input</span></span>
<span>  nSamp <span class="op">=</span> <span class="fl">25</span>, <span class="co"># desired sample number</span></span>
<span>  details <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; K-means being performed on 3 layers with 25 centers.</span></span>
<span></span>
<span><span class="co">#--- plot ggplot output ---#</span></span>
<span></span>
<span><span class="va">details</span><span class="op">$</span><span class="va">kplot</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-20-1.png" width="700"></p>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="clhs">
<code>sample_clhs</code><a class="anchor" aria-label="anchor" href="#clhs"></a>
</h2>
<p><code><a href="../reference/sample_clhs.html">sample_clhs()</a></code> function implements conditioned Latin
hypercube (clhs) sampling methodology from the <a href="https://CRAN.R-project.org/package=clhs/" class="external-link"><code>clhs</code></a>
package.</p>
<div class="infobox caution">
<p><strong>TIP!</strong></p>
<p>A number of other functions in the <code>sgsR</code> package help to
provide guidance on clhs sampling including <code><a href="../reference/calculate_pop.html">calculate_pop()</a></code>
and <code><a href="../reference/calculate_lhsOpt.html">calculate_lhsOpt()</a></code>. Check out these functions to better
understand how sample numbers could be optimized.</p>
</div>
<p>The syntax for this function is similar to others shown above,
although parameters like <code>iter</code>, which define the number of
iterations within the Metropolis-Hastings process are important to
consider. In these examples we use a low <code>iter</code> value for
efficiency. Default values for <code>iter</code> within the
<code>clhs</code> package are 10,000.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sample_clhs.html">sample_clhs</a></span><span class="op">(</span></span>
<span>  mraster <span class="op">=</span> <span class="va">mraster</span>, <span class="co"># input</span></span>
<span>  nSamp <span class="op">=</span> <span class="fl">200</span>, <span class="co"># desired sample size</span></span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># plot</span></span>
<span>  iter <span class="op">=</span> <span class="fl">100</span></span>
<span><span class="op">)</span> <span class="co"># number of iterations</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-22-1.png" width="700"></p>
<p>The <code>cost</code> parameter defines the <code>mraster</code>
covariate, which is used to constrain the clhs sampling. An example
could be the distance a pixel is from road <code>access</code>
(e.g. from <code><a href="../reference/calculate_distance.html">calculate_distance()</a></code> see example below), terrain
slope, the output from <code><a href="../reference/calculate_coobs.html">calculate_coobs()</a></code>, or many
others.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co">#--- cost constrained examples ---#</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="co">#--- calculate distance to access layer for each pixel in mr ---#</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>mr.c <span class="ot">&lt;-</span> <span class="fu">calculate_distance</span>(</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">raster =</span> mraster, <span class="co"># input</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">access =</span> access, <span class="co"># define access road network</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot =</span> <span class="cn">TRUE</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>) <span class="co"># plot</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a><span class="sc">|---------</span><span class="er">|</span><span class="sc">---------</span><span class="er">|</span><span class="sc">---------</span><span class="er">|</span><span class="sc">---------</span><span class="er">|</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="er">=========================================</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>                                          </span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-23-1.png" width="700"></p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sample_clhs.html">sample_clhs</a></span><span class="op">(</span></span>
<span>  mraster <span class="op">=</span> <span class="va">mr.c</span>, <span class="co"># input</span></span>
<span>  nSamp <span class="op">=</span> <span class="fl">250</span>, <span class="co"># desired sample size</span></span>
<span>  iter <span class="op">=</span> <span class="fl">100</span>, <span class="co"># number of iterations</span></span>
<span>  cost <span class="op">=</span> <span class="st">"dist2access"</span>, <span class="co"># cost parameter - name defined in calculate_distance()</span></span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span> <span class="co"># plot</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-25-1.png" width="700"></p>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="balanced">
<code>sample_balanced</code><a class="anchor" aria-label="anchor" href="#balanced"></a>
</h2>
<p>The <code><a href="../reference/sample_balanced.html">sample_balanced()</a></code> algorithm performs a balanced
sampling methodology from the <a href="http://www.antongrafstrom.se/balancedsampling/" class="external-link"><code>stratifyR / SamplingBigData</code></a>
packages.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sample_balanced.html">sample_balanced</a></span><span class="op">(</span></span>
<span>  mraster <span class="op">=</span> <span class="va">mraster</span>, <span class="co"># input</span></span>
<span>  nSamp <span class="op">=</span> <span class="fl">200</span>, <span class="co"># desired sample size</span></span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span> <span class="co"># plot</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-26-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; Simple feature collection with 200 features and 0 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431150 ymin: 5337750 xmax: 438450 ymax: 5343170</span></span>
<span><span class="co">#&gt; Projected CRS: +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;                  geometry</span></span>
<span><span class="co">#&gt; 1  POINT (434770 5343170)</span></span>
<span><span class="co">#&gt; 2  POINT (435510 5343170)</span></span>
<span><span class="co">#&gt; 3  POINT (433570 5343130)</span></span>
<span><span class="co">#&gt; 4  POINT (435310 5343130)</span></span>
<span><span class="co">#&gt; 5  POINT (436150 5343070)</span></span>
<span><span class="co">#&gt; 6  POINT (431450 5343050)</span></span>
<span><span class="co">#&gt; 7  POINT (431710 5343030)</span></span>
<span><span class="co">#&gt; 8  POINT (432630 5343030)</span></span>
<span><span class="co">#&gt; 9  POINT (433830 5343030)</span></span>
<span><span class="co">#&gt; 10 POINT (437150 5343030)</span></span></code></pre>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sample_balanced.html">sample_balanced</a></span><span class="op">(</span></span>
<span>  mraster <span class="op">=</span> <span class="va">mraster</span>, <span class="co"># input</span></span>
<span>  nSamp <span class="op">=</span> <span class="fl">100</span>, <span class="co"># desired sample size</span></span>
<span>  algorithm <span class="op">=</span> <span class="st">"lcube"</span>, <span class="co"># algorithm type</span></span>
<span>  access <span class="op">=</span> <span class="va">access</span>, <span class="co"># define access road network</span></span>
<span>  buff_inner <span class="op">=</span> <span class="fl">50</span>, <span class="co"># inner buffer - no sample units within this distance from road</span></span>
<span>  buff_outer <span class="op">=</span> <span class="fl">200</span></span>
<span><span class="op">)</span> <span class="co"># outer buffer - no sample units further than this distance from road</span></span>
<span><span class="co">#&gt; Simple feature collection with 100 features and 0 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431150 ymin: 5337730 xmax: 438430 ymax: 5343230</span></span>
<span><span class="co">#&gt; Projected CRS: +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;                  geometry</span></span>
<span><span class="co">#&gt; 1  POINT (432930 5340390)</span></span>
<span><span class="co">#&gt; 2  POINT (433890 5341030)</span></span>
<span><span class="co">#&gt; 3  POINT (438050 5342150)</span></span>
<span><span class="co">#&gt; 4  POINT (437730 5339050)</span></span>
<span><span class="co">#&gt; 5  POINT (432770 5341090)</span></span>
<span><span class="co">#&gt; 6  POINT (436730 5338490)</span></span>
<span><span class="co">#&gt; 7  POINT (434750 5342890)</span></span>
<span><span class="co">#&gt; 8  POINT (437630 5342170)</span></span>
<span><span class="co">#&gt; 9  POINT (435790 5343130)</span></span>
<span><span class="co">#&gt; 10 POINT (437390 5342130)</span></span></code></pre></div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="ahels">
<code>sample_ahels</code><a class="anchor" aria-label="anchor" href="#ahels"></a>
</h2>
<p>The <code><a href="../reference/sample_ahels.html">sample_ahels()</a></code> function performs the adapted
Hypercube Evaluation of a Legacy Sample (ahels) algorithm
using<code>existing</code> sample data and an <code>mraster</code>. New
sample units are allocated based on quantile ratios between the
<code>existing</code> sample and <code>mraster</code> covariate
dataset.</p>
<p>This algorithm was adapted from that presented in the paper below,
which we highly recommend.</p>
<p><em><em>Malone BP, Minansy B, Brungard C. 2019. Some methods to
improve the utility of conditioned Latin hypercube sampling. PeerJ
7:e6451 DOI 10.7717/peerj.6451</em></em></p>
<p>This algorithm:</p>
<ol style="list-style-type: decimal">
<li><p>Determines the quantile distributions of <code>existing</code>
sample units and <code>mraster</code> covariates.</p></li>
<li><p>Determines quantiles where there is a disparity between sample
units and covariates.</p></li>
<li><p>Prioritizes sampling within those quantile to improve
representation.</p></li>
</ol>
<p>To use this function, user must first specify the number of quantiles
(<code>nQuant</code>) followed by either the <code>nSamp</code> (total
number of desired sample units to be added) or the
<code>threshold</code> (sampling ratio vs. covariate coverage ratio for
quantiles - default is 0.9) parameters.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- remove `type` variable from existing  - causes plotting issues ---#</span></span>
<span></span>
<span><span class="va">existing</span> <span class="op">&lt;-</span> <span class="va">existing</span> <span class="op">%&gt;%</span> <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">type</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/sample_ahels.html">sample_ahels</a></span><span class="op">(</span></span>
<span>  mraster <span class="op">=</span> <span class="va">mraster</span>,</span>
<span>  existing <span class="op">=</span> <span class="va">existing</span>, <span class="co"># existing sample</span></span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span> <span class="co"># plot</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Simple feature collection with 328 features and 7 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431130 ymin: 5337710 xmax: 438510 ymax: 5343210</span></span>
<span><span class="co">#&gt; Projected CRS: UTM Zone 17, Northern Hemisphere</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;      type.x  zq90 pzabove2  zsd strata type.y  rule</span></span>
<span><span class="co">#&gt; 1  existing  6.52     76.8 1.34      1    new rule1</span></span>
<span><span class="co">#&gt; 2  existing  7.03     40.3 1.93      1    new rule1</span></span>
<span><span class="co">#&gt; 3  existing  2.59      0.4 0.39      1    new rule1</span></span>
<span><span class="co">#&gt; 4  existing  3.99     27.5 0.89      1    new rule1</span></span>
<span><span class="co">#&gt; 5  existing  2.36      1.2 0.35      1    new rule1</span></span>
<span><span class="co">#&gt; 6  existing 10.80     58.4 2.87      1    new rule1</span></span>
<span><span class="co">#&gt; 7  existing  8.45     75.8 1.98      1    new rule1</span></span>
<span><span class="co">#&gt; 8  existing  4.59     65.3 0.88      1    new rule1</span></span>
<span><span class="co">#&gt; 9  existing  6.88     64.9 1.64      1    new rule1</span></span>
<span><span class="co">#&gt; 10 existing  1.98      0.0 0.21      1    new rule1</span></span>
<span><span class="co">#&gt;                  geometry</span></span>
<span><span class="co">#&gt; 1  POINT (436770 5337830)</span></span>
<span><span class="co">#&gt; 2  POINT (435130 5342530)</span></span>
<span><span class="co">#&gt; 3  POINT (438510 5339310)</span></span>
<span><span class="co">#&gt; 4  POINT (434250 5341650)</span></span>
<span><span class="co">#&gt; 5  POINT (437650 5339230)</span></span>
<span><span class="co">#&gt; 6  POINT (438090 5338350)</span></span>
<span><span class="co">#&gt; 7  POINT (437890 5341190)</span></span>
<span><span class="co">#&gt; 8  POINT (433690 5341450)</span></span>
<span><span class="co">#&gt; 9  POINT (435790 5342370)</span></span>
<span><span class="co">#&gt; 10 POINT (437730 5339130)</span></span></code></pre>
<div class="infobox caution">
<p><strong>TIP!</strong></p>
<p>Notice that no <code>threshold</code>, <code>nSamp</code>, or
<code>nQuant</code> were defined. That is because the default setting
for <code>threshold = 0.9</code> and <code>nQuant = 10</code>.</p>
</div>
<p>The first matrix output shows the quantile ratios between the sample
and the covariates. A value of 1.0 indicates that the sample is
representative of quantile coverage. Values &gt; 1.0 indicate over
representation of sample units, while &lt; 1.0 indicate under
representation.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sample_ahels.html">sample_ahels</a></span><span class="op">(</span></span>
<span>  mraster <span class="op">=</span> <span class="va">mraster</span>,</span>
<span>  existing <span class="op">=</span> <span class="va">existing</span>, <span class="co"># existing sample</span></span>
<span>  nQuant <span class="op">=</span> <span class="fl">20</span>, <span class="co"># define 20 quantiles</span></span>
<span>  nSamp <span class="op">=</span> <span class="fl">300</span></span>
<span><span class="op">)</span> <span class="co"># desired sample size</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Simple feature collection with 500 features and 7 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431110 ymin: 5337710 xmax: 438550 ymax: 5343230</span></span>
<span><span class="co">#&gt; Projected CRS: UTM Zone 17, Northern Hemisphere</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;      type.x  zq90 pzabove2  zsd strata type.y  rule</span></span>
<span><span class="co">#&gt; 1  existing  6.52     76.8 1.34      1    new rule1</span></span>
<span><span class="co">#&gt; 2  existing  7.03     40.3 1.93      1    new rule1</span></span>
<span><span class="co">#&gt; 3  existing  2.59      0.4 0.39      1    new rule1</span></span>
<span><span class="co">#&gt; 4  existing  3.99     27.5 0.89      1    new rule1</span></span>
<span><span class="co">#&gt; 5  existing  2.36      1.2 0.35      1    new rule1</span></span>
<span><span class="co">#&gt; 6  existing 10.80     58.4 2.87      1    new rule1</span></span>
<span><span class="co">#&gt; 7  existing  8.45     75.8 1.98      1    new rule1</span></span>
<span><span class="co">#&gt; 8  existing  4.59     65.3 0.88      1    new rule1</span></span>
<span><span class="co">#&gt; 9  existing  6.88     64.9 1.64      1    new rule1</span></span>
<span><span class="co">#&gt; 10 existing  1.98      0.0 0.21      1    new rule1</span></span>
<span><span class="co">#&gt;                  geometry</span></span>
<span><span class="co">#&gt; 1  POINT (436770 5337830)</span></span>
<span><span class="co">#&gt; 2  POINT (435130 5342530)</span></span>
<span><span class="co">#&gt; 3  POINT (438510 5339310)</span></span>
<span><span class="co">#&gt; 4  POINT (434250 5341650)</span></span>
<span><span class="co">#&gt; 5  POINT (437650 5339230)</span></span>
<span><span class="co">#&gt; 6  POINT (438090 5338350)</span></span>
<span><span class="co">#&gt; 7  POINT (437890 5341190)</span></span>
<span><span class="co">#&gt; 8  POINT (433690 5341450)</span></span>
<span><span class="co">#&gt; 9  POINT (435790 5342370)</span></span>
<span><span class="co">#&gt; 10 POINT (437730 5339130)</span></span></code></pre>
<p>Notice that the total number of samples is 500. This value is the sum
of existing units (200) and number of sample units defined by
<code>nSamp = 300</code>.</p>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="samp-existing">
<code>sample_existing</code><a class="anchor" aria-label="anchor" href="#samp-existing"></a>
</h2>
<p>Acknowledging that <code>existing</code> sample networks are common
is important. There is significant investment into these samples, and in
order to keep inventories up-to-date, we often need to collect new data
for sample units. The <code>sample_existing</code> algorithm provides
the user with methods for sub-sampling an <code>existing</code> sample
network should the financial / logistical resources not be available to
collect data at all sample units. The functions allows users to choose
between algorithm types using (<code>type = "clhs"</code> - default,
<code>type = "balanced"</code>, <code>type = "srs"</code>,
<code>type = "strat"</code>). Differences in type result in calling
internal <code>sample_existing_*()</code> functions
(<code><a href="../reference/sample_existing_clhs.html">sample_existing_clhs()</a></code> (default),
<code><a href="../reference/sample_existing_balanced.html">sample_existing_balanced()</a></code>,
<code><a href="../reference/sample_existing_srs.html">sample_existing_srs()</a></code>,
<code><a href="../reference/sample_existing_strat.html">sample_existing_strat()</a></code>). These functions are not exported
to be used stand-alone, however they employ the same functionality as
their <code><a href="../reference/sample_clhs.html">sample_clhs()</a></code> etc counterparts.</p>
<p>While using <code><a href="../reference/sample_existing.html">sample_existing()</a></code>, should the user wish to
specify algorithm specific parameters
(e.g. <code>algorithm = "lcube"</code> in <code><a href="../reference/sample_balanced.html">sample_balanced()</a></code>
or <code>allocation = "equal"</code> in <code><a href="../reference/sample_strat.html">sample_strat()</a></code>),
they can specify within <code><a href="../reference/sample_existing.html">sample_existing()</a></code> as if calling the
function directly.</p>
<p>I give applied examples for all methods below that are based on the
following scenario:</p>
<ul>
<li><p>We have a systematic sample where sample units are 200m
apart.</p></li>
<li><p>We know we only have resources to sample 300 of them.</p></li>
<li><p>We have some ALS data available (<code>mraster</code>), which we
can use to improve knowledge of the metric populations.</p></li>
</ul>
<p>See our <code>existing</code> sample for the scenario below.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- generate existing samples and extract metrics ---#</span></span>
<span><span class="va">existing</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sample_systematic.html">sample_systematic</a></span><span class="op">(</span>raster <span class="op">=</span> <span class="va">mraster</span>, cellsize <span class="op">=</span> <span class="fl">200</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-34-1.png" width="700"></p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">#--- sub sample using ---#</span></span>
<span><span class="va">e</span> <span class="op">&lt;-</span> <span class="va">existing</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="../reference/extract_metrics.html">extract_metrics</a></span><span class="op">(</span>mraster <span class="op">=</span> <span class="va">mraster</span>, existing <span class="op">=</span> <span class="va">.</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="sample_existingtype-clhs">
<code>sample_existing(type = "clhs")</code><a class="anchor" aria-label="anchor" href="#sample_existingtype-clhs"></a>
</h3>
<p>The algorithm is unique in that it has two fundamental
approaches:</p>
<ol style="list-style-type: decimal">
<li>Sample exclusively using <code>existing</code> and the attributes it
contains.</li>
</ol>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- sub sample using ---#</span></span>
<span><span class="fu"><a href="../reference/sample_existing.html">sample_existing</a></span><span class="op">(</span>existing <span class="op">=</span> <span class="va">e</span>, nSamp <span class="op">=</span> <span class="fl">300</span>, type <span class="op">=</span> <span class="st">"clhs"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Simple feature collection with 300 features and 3 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431105.7 ymin: 5337737 xmax: 438521 ymax: 5343233</span></span>
<span><span class="co">#&gt; Projected CRS: UTM Zone 17, Northern Hemisphere</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;      zq90 pzabove2  zsd                 geometry</span></span>
<span><span class="co">#&gt; 36  11.20     96.2 2.63 POINT (438271.9 5340727)</span></span>
<span><span class="co">#&gt; 644  9.36     62.0 2.30 POINT (433214.4 5340875)</span></span>
<span><span class="co">#&gt; 874 17.90     95.1 4.26 POINT (431991.3 5338000)</span></span>
<span><span class="co">#&gt; 496 13.90     60.8 3.95 POINT (434863.9 5338865)</span></span>
<span><span class="co">#&gt; 214 19.20     85.4 4.70 POINT (436585.3 5341472)</span></span>
<span><span class="co">#&gt; 488  4.88     34.1 1.05 POINT (433844.4 5342944)</span></span>
<span><span class="co">#&gt; 470 10.70     17.2 3.07 POINT (434997.7 5339114)</span></span>
<span><span class="co">#&gt; 320  8.51     93.1 1.67 POINT (436550.4 5338120)</span></span>
<span><span class="co">#&gt; 469  3.38      1.4 0.67 POINT (435055.4 5338923)</span></span>
<span><span class="co">#&gt; 747 14.70     81.3 3.71 POINT (432448.4 5340644)</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Sub-sampling using <code>raster</code> distributions</li>
</ol>
<p>Our systematic sample of ~900 plots is fairly comprehensive, however
we can generate a true population distribution through the inclusion of
the ALS metrics in the sampling process. The metrics will be included in
internal latin hypercube sampling to help guide sub-sampling of
<code>existing</code>.</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- sub sample using ---#</span></span>
<span><span class="fu"><a href="../reference/sample_existing.html">sample_existing</a></span><span class="op">(</span></span>
<span>  existing <span class="op">=</span> <span class="va">existing</span>, <span class="co"># our existing sample</span></span>
<span>  nSamp <span class="op">=</span> <span class="fl">300</span>, <span class="co"># desired sample size</span></span>
<span>  raster <span class="op">=</span> <span class="va">mraster</span>, <span class="co"># include mraster metrics to guide sampling of existing</span></span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span> <span class="co"># plot</span></span>
<span><span class="co">#&gt; Simple feature collection with 300 features and 3 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431105.7 ymin: 5337714 xmax: 438558.1 ymax: 5343214</span></span>
<span><span class="co">#&gt; Projected CRS: +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;        zq90 pzabove2  zsd                 geometry</span></span>
<span><span class="co">#&gt; 91340 21.40     83.4 5.68 POINT (437102.2 5341837)</span></span>
<span><span class="co">#&gt; 91321  8.36     12.9 2.16 POINT (438197.8 5338198)</span></span>
<span><span class="co">#&gt; 91345  2.09      0.1 0.24 POINT (438121.6 5337757)</span></span>
<span><span class="co">#&gt; 91688 20.10     93.7 5.11 POINT (435036.9 5338291)</span></span>
<span><span class="co">#&gt; 91208 11.30     89.8 2.63 POINT (438366.6 5341800)</span></span>
<span><span class="co">#&gt; 91743 15.60     91.0 3.23 POINT (434653.9 5338175)</span></span>
<span><span class="co">#&gt; 91889 16.00     93.8 3.87 POINT (432600.7 5341526)</span></span>
<span><span class="co">#&gt; 91802 15.30     96.2 3.40 POINT (434097.9 5338634)</span></span>
<span><span class="co">#&gt; 91946 14.50     76.2 3.38 POINT (432217.7 5341410)</span></span>
<span><span class="co">#&gt; 92074 14.70     94.8 3.21 POINT (431472.3 5339724)</span></span></code></pre></div>
<p>The sample distribution again mimics the population distribution
quite well! Now lets try using a cost variable to constrain the
sub-sample.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co">#--- create distance from roads metric ---#</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>dist <span class="ot">&lt;-</span> <span class="fu">calculate_distance</span>(<span class="at">raster =</span> mraster, <span class="at">access =</span> access)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="sc">|---------</span><span class="er">|</span><span class="sc">---------</span><span class="er">|</span><span class="sc">---------</span><span class="er">|</span><span class="sc">---------</span><span class="er">|</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="er">=========================================</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>                                          </span></code></pre></div>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- sub sample using ---#</span></span>
<span><span class="fu"><a href="../reference/sample_existing.html">sample_existing</a></span><span class="op">(</span></span>
<span>  existing <span class="op">=</span> <span class="va">existing</span>, <span class="co"># our existing sample</span></span>
<span>  nSamp <span class="op">=</span> <span class="fl">300</span>, <span class="co"># desired sample size</span></span>
<span>  raster <span class="op">=</span> <span class="va">dist</span>, <span class="co"># include mraster metrics to guide sampling of existing</span></span>
<span>  cost <span class="op">=</span> <span class="fl">4</span>, <span class="co"># either provide the index (band number) or the name of the cost layer</span></span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span> <span class="co"># plot</span></span>
<span><span class="co">#&gt; Simple feature collection with 300 features and 4 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431105.7 ymin: 5337716 xmax: 438481.9 ymax: 5343233</span></span>
<span><span class="co">#&gt; Projected CRS: +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;        zq90 pzabove2  zsd dist2access                 geometry</span></span>
<span><span class="co">#&gt; 91762 19.50     75.1 3.94  315.419023 POINT (433558.3 5341814)</span></span>
<span><span class="co">#&gt; 92016 18.10     91.3 3.54  220.404396 POINT (432392.8 5338748)</span></span>
<span><span class="co">#&gt; 92020 13.80     77.1 4.09  209.785350 POINT (431989.2 5340088)</span></span>
<span><span class="co">#&gt; 91938 18.80     93.7 3.43   40.170790   POINT (432679 5339878)</span></span>
<span><span class="co">#&gt; 92052 10.10     39.1 2.90  254.888360 POINT (431105.7 5342329)</span></span>
<span><span class="co">#&gt; 91691 13.90     60.8 3.95  211.233865 POINT (434863.9 5338865)</span></span>
<span><span class="co">#&gt; 91749  3.07      2.7 0.56    5.990259 POINT (434307.9 5339324)</span></span>
<span><span class="co">#&gt; 91943 13.20     89.9 3.41  266.076117 POINT (432390.7 5340836)</span></span>
<span><span class="co">#&gt; 92039 14.00     80.3 3.20  387.100116 POINT (432201.3 5338690)</span></span>
<span><span class="co">#&gt; 91322 10.90     38.9 2.97  126.601799 POINT (438140.2 5338390)</span></span></code></pre></div>
<p>Finally, should the user wish to further constrain the sample based
on <code>access</code> like other sampling approaches in
<code>sgsR</code> that is also possible.</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- ensure access and existing are in the same CRS ---#</span></span>
<span></span>
<span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html" class="external-link">st_crs</a></span><span class="op">(</span><span class="va">existing</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html" class="external-link">st_crs</a></span><span class="op">(</span><span class="va">access</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#--- sub sample using ---#</span></span>
<span><span class="fu"><a href="../reference/sample_existing.html">sample_existing</a></span><span class="op">(</span></span>
<span>  existing <span class="op">=</span> <span class="va">existing</span>, <span class="co"># our existing sample</span></span>
<span>  nSamp <span class="op">=</span> <span class="fl">300</span>, <span class="co"># desired sample size</span></span>
<span>  raster <span class="op">=</span> <span class="va">dist</span>, <span class="co"># include mraster metrics to guide sampling of existing</span></span>
<span>  cost <span class="op">=</span> <span class="fl">4</span>, <span class="co"># either provide the index (band number) or the name of the cost layer</span></span>
<span>  access <span class="op">=</span> <span class="va">access</span>, <span class="co"># roads layer</span></span>
<span>  buff_inner <span class="op">=</span> <span class="fl">50</span>, <span class="co"># inner buffer - no sample units within this distance from road</span></span>
<span>  buff_outer <span class="op">=</span> <span class="fl">300</span>, <span class="co"># outer buffer - no sample units further than this distance from road</span></span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span> <span class="co"># plot</span></span>
<span><span class="co">#&gt; Simple feature collection with 300 features and 4 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431126.3 ymin: 5337718 xmax: 438523.2 ymax: 5343233</span></span>
<span><span class="co">#&gt; Projected CRS: +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;        zq90 pzabove2  zsd dist2access                 geometry</span></span>
<span><span class="co">#&gt; 91420 20.70     56.7 6.19    68.73238   POINT (434419 5343117)</span></span>
<span><span class="co">#&gt; 91387 21.30     90.5 5.90   162.55635 POINT (435724.6 5340169)</span></span>
<span><span class="co">#&gt; 91428 22.70     87.5 6.93   101.06193 POINT (434804.1 5341145)</span></span>
<span><span class="co">#&gt; 91576 13.80     85.9 3.20   292.33725   POINT (433235 5339419)</span></span>
<span><span class="co">#&gt; 91618 19.20     81.6 4.29    66.31569 POINT (431814.1 5342751)</span></span>
<span><span class="co">#&gt; 91379  7.84     31.4 1.92   143.46549 POINT (435166.5 5342716)</span></span>
<span><span class="co">#&gt; 91317 18.20     78.3 3.84   125.56235 POINT (436451.5 5341223)</span></span>
<span><span class="co">#&gt; 91200 15.20     93.3 3.73   127.78511 POINT (438463.4 5340784)</span></span>
<span><span class="co">#&gt; 91436 17.80     73.3 5.48    62.26129 POINT (435419.9 5338406)</span></span>
<span><span class="co">#&gt; 91515 13.50     94.0 3.05    61.55844 POINT (433904.2 5340665)</span></span></code></pre></div>
<div class="infobox caution">
<p><strong>TIP!</strong></p>
<p>The greater constraints we add to sampling, the less likely we will
have strong correlations between the population and sample, so its
always important to understand these limitations and plan
accordingly.</p>
</div>
</div>
<div class="section level3">
<h3 id="sample_existingtype-balanced">
<code>sample_existing(type = "balanced")</code><a class="anchor" aria-label="anchor" href="#sample_existingtype-balanced"></a>
</h3>
<p>When <code>type = "balanced"</code> users can define all parameters
that are found within <code><a href="../reference/sample_balanced.html">sample_balanced()</a></code>. This means that
one can change the <code>algorithm</code>, <code>p</code> etc.</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sample_existing.html">sample_existing</a></span><span class="op">(</span>existing <span class="op">=</span> <span class="va">e</span>, nSamp <span class="op">=</span> <span class="fl">300</span>, type <span class="op">=</span> <span class="st">"balanced"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Simple feature collection with 300 features and 3 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431147 ymin: 5337732 xmax: 438558.1 ymax: 5343196</span></span>
<span><span class="co">#&gt; Projected CRS: UTM Zone 17, Northern Hemisphere</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;     zq90 pzabove2  zsd                 geometry</span></span>
<span><span class="co">#&gt; 2  19.20     86.7 4.74 POINT (438461.2 5342873)</span></span>
<span><span class="co">#&gt; 3  24.40     85.5 5.72 POINT (438558.1 5341857)</span></span>
<span><span class="co">#&gt; 5  19.20     96.8 3.27 POINT (438442.7 5342240)</span></span>
<span><span class="co">#&gt; 8  10.80     66.6 2.65 POINT (438212.1 5343006)</span></span>
<span><span class="co">#&gt; 10 13.00     88.8 2.89 POINT (438539.6 5341225)</span></span>
<span><span class="co">#&gt; 11 20.00     88.3 5.29 POINT (438481.9 5341417)</span></span>
<span><span class="co">#&gt; 16 15.30     86.3 3.16 POINT (438135.9 5342566)</span></span>
<span><span class="co">#&gt; 19  2.68      4.8 0.42 POINT (437962.9 5343140)</span></span>
<span><span class="co">#&gt; 23 16.50     91.8 3.49   POINT (438348 5341167)</span></span>
<span><span class="co">#&gt; 26 20.40     74.9 6.91 POINT (438059.7 5342125)</span></span></code></pre></div>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sample_existing.html">sample_existing</a></span><span class="op">(</span>existing <span class="op">=</span> <span class="va">e</span>, nSamp <span class="op">=</span> <span class="fl">300</span>, type <span class="op">=</span> <span class="st">"balanced"</span>, algorithm <span class="op">=</span> <span class="st">"lcube"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Simple feature collection with 300 features and 3 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431105.7 ymin: 5337714 xmax: 438521 ymax: 5343198</span></span>
<span><span class="co">#&gt; Projected CRS: UTM Zone 17, Northern Hemisphere</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;      zq90 pzabove2  zsd                 geometry</span></span>
<span><span class="co">#&gt; 250 10.20     94.0 2.37 POINT (437067.3 5338484)</span></span>
<span><span class="co">#&gt; 493 20.10     93.7 5.11 POINT (435036.9 5338291)</span></span>
<span><span class="co">#&gt; 520 17.40     91.6 4.40 POINT (434845.4 5338233)</span></span>
<span><span class="co">#&gt; 394 13.50     91.6 3.27 POINT (435687.6 5338904)</span></span>
<span><span class="co">#&gt; 654 10.70     59.8 2.57 POINT (432637.7 5342790)</span></span>
<span><span class="co">#&gt; 578 12.00     88.0 3.11 POINT (434404.7 5338309)</span></span>
<span><span class="co">#&gt; 178  9.88     14.7 2.71 POINT (437814.8 5338083)</span></span>
<span><span class="co">#&gt; 909 15.80     90.7 3.74 POINT (431128.5 5338785)</span></span>
<span><span class="co">#&gt; 429  8.82     70.6 2.24 POINT (434573.4 5341911)</span></span>
<span><span class="co">#&gt; 221 10.30     49.3 2.54   POINT (436124 5343004)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="sample_existingtype-srs">
<code>sample_existing(type = "srs")</code><a class="anchor" aria-label="anchor" href="#sample_existingtype-srs"></a>
</h3>
<p>The simplest, <code>type = srs</code>, randomly selects sample
units.</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sample_existing.html">sample_existing</a></span><span class="op">(</span>existing <span class="op">=</span> <span class="va">e</span>, nSamp <span class="op">=</span> <span class="fl">300</span>, type <span class="op">=</span> <span class="st">"srs"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Simple feature collection with 300 features and 3 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431107.8 ymin: 5337718 xmax: 438541.7 ymax: 5343233</span></span>
<span><span class="co">#&gt; Projected CRS: UTM Zone 17, Northern Hemisphere</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;    zq90 pzabove2  zsd                 geometry</span></span>
<span><span class="co">#&gt; 1  15.2     76.7 3.66 POINT (431661.7 5341869)</span></span>
<span><span class="co">#&gt; 2  18.9     86.8 4.67 POINT (436356.8 5340150)</span></span>
<span><span class="co">#&gt; 3  17.5     94.6 2.73 POINT (438502.5 5339961)</span></span>
<span><span class="co">#&gt; 4  17.1     67.4 5.25 POINT (436700.7 5341089)</span></span>
<span><span class="co">#&gt; 5  17.4     91.6 4.40 POINT (434845.4 5338233)</span></span>
<span><span class="co">#&gt; 6  17.4     75.0 4.60   POINT (435840 5339786)</span></span>
<span><span class="co">#&gt; 7  12.3     73.6 3.43 POINT (434806.2 5339057)</span></span>
<span><span class="co">#&gt; 8  24.5     90.5 7.28 POINT (436488.5 5342487)</span></span>
<span><span class="co">#&gt; 9  10.2     80.0 2.52 POINT (436492.8 5338311)</span></span>
<span><span class="co">#&gt; 10 13.0     80.5 2.78 POINT (433331.9 5338404)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="sample_existingtype-strat">
<code>sample_existing(type = "strat")</code><a class="anchor" aria-label="anchor" href="#sample_existingtype-strat"></a>
</h3>
<p>When <code>type = "strat"</code>, <code>existing</code> must have an
attribute named <code>strata</code> (just like how
<code><a href="../reference/sample_strat.html">sample_strat()</a></code> requires a <code>strata</code> layer). If it
doesnt exist you will get an error. Lets define an <code>sraster</code>
so that we are compliant.</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sraster</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/strat_kmeans.html">strat_kmeans</a></span><span class="op">(</span>mraster <span class="op">=</span> <span class="va">mraster</span>, nStrata <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="va">e_strata</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_strata.html">extract_strata</a></span><span class="op">(</span>sraster <span class="op">=</span> <span class="va">sraster</span>, existing <span class="op">=</span> <span class="va">e</span><span class="op">)</span></span></code></pre></div>
<p>When we do have a strata attribute, the function works very much the
same as <code><a href="../reference/sample_strat.html">sample_strat()</a></code> in that is allows the user to define
the <code>allocation</code> method (<code>"prop"</code> - defaults,
<code>"optim"</code>, <code>"manual"</code>, <code>"equal"</code>).</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- proportional stratified sampling of existing ---#</span></span>
<span><span class="fu"><a href="../reference/sample_existing.html">sample_existing</a></span><span class="op">(</span>existing <span class="op">=</span> <span class="va">e_strata</span>, nSamp <span class="op">=</span> <span class="fl">300</span>, type <span class="op">=</span> <span class="st">"strat"</span>, allocation <span class="op">=</span> <span class="st">"prop"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Simple feature collection with 300 features and 4 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431110 ymin: 5337732 xmax: 438523.2 ymax: 5343214</span></span>
<span><span class="co">#&gt; Projected CRS: UTM Zone 17, Northern Hemisphere</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;    strata zq90 pzabove2  zsd                 geometry</span></span>
<span><span class="co">#&gt; 1       1 13.0     92.9 2.69 POINT (431470.2 5341812)</span></span>
<span><span class="co">#&gt; 2       1 18.9     89.6 4.20 POINT (437888.9 5340611)</span></span>
<span><span class="co">#&gt; 3       1 17.4     91.6 4.40 POINT (434845.4 5338233)</span></span>
<span><span class="co">#&gt; 4       1 15.7     86.4 4.14 POINT (435014.1 5341835)</span></span>
<span><span class="co">#&gt; 5       1 15.5     87.1 3.78 POINT (437561.4 5342393)</span></span>
<span><span class="co">#&gt; 6       1 19.2     87.4 4.28 POINT (433576.8 5342446)</span></span>
<span><span class="co">#&gt; 7       1 13.5     88.1 3.19 POINT (437946.5 5340420)</span></span>
<span><span class="co">#&gt; 8       1 14.0     91.6 4.00 POINT (432182.8 5338058)</span></span>
<span><span class="co">#&gt; 9       1 17.4     90.8 3.51 POINT (438253.4 5340095)</span></span>
<span><span class="co">#&gt; 10      1 17.4     80.6 3.74 POINT (432044.7 5341985)</span></span></code></pre></div>
<div class="infobox caution">
<p><strong>TIP!</strong></p>
<p>Remember that when <code>allocation = "equal"</code>, the
<code>nSamp</code> value will be allocated for each strata.</p>
</div>
<p>We get 400 sample units in our output below because we have 4 strata
and <code>nSamp = 100</code>.</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- equal stratified sampling of existing ---#</span></span>
<span><span class="fu"><a href="../reference/sample_existing.html">sample_existing</a></span><span class="op">(</span>existing <span class="op">=</span> <span class="va">e_strata</span>, nSamp <span class="op">=</span> <span class="fl">100</span>, type <span class="op">=</span> <span class="st">"strat"</span>, allocation <span class="op">=</span> <span class="st">"equal"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Simple feature collection with 400 features and 4 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431128.5 ymin: 5337714 xmax: 438541.7 ymax: 5343231</span></span>
<span><span class="co">#&gt; Projected CRS: UTM Zone 17, Northern Hemisphere</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;    strata zq90 pzabove2  zsd                 geometry</span></span>
<span><span class="co">#&gt; 1       1 14.4     90.5 2.98 POINT (437849.7 5341435)</span></span>
<span><span class="co">#&gt; 2       1 14.1     99.1 1.97 POINT (437388.4 5342967)</span></span>
<span><span class="co">#&gt; 3       1 17.1     93.6 3.87 POINT (435535.2 5338023)</span></span>
<span><span class="co">#&gt; 4       1 15.3     96.2 3.40 POINT (434097.9 5338634)</span></span>
<span><span class="co">#&gt; 5       1 16.3     73.5 4.76 POINT (434822.6 5341777)</span></span>
<span><span class="co">#&gt; 6       1 14.8     74.0 3.75   POINT (438138 5340478)</span></span>
<span><span class="co">#&gt; 7       1 19.2     87.4 4.28 POINT (433576.8 5342446)</span></span>
<span><span class="co">#&gt; 8       1 13.2     89.9 3.41 POINT (432390.7 5340836)</span></span>
<span><span class="co">#&gt; 9       1 13.4     92.9 3.09 POINT (436280.6 5339709)</span></span>
<span><span class="co">#&gt; 10      1 18.2     78.3 3.84 POINT (436451.5 5341223)</span></span></code></pre></div>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- manual stratified sampling of existing with user defined weights ---#</span></span>
<span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sample_existing.html">sample_existing</a></span><span class="op">(</span>existing <span class="op">=</span> <span class="va">e_strata</span>, nSamp <span class="op">=</span> <span class="fl">100</span>, type <span class="op">=</span> <span class="st">"strat"</span>, allocation <span class="op">=</span> <span class="st">"manual"</span>, weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.6</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>We can check the proportion of samples from each strata with:</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- check proportions match weights ---#</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">s</span><span class="op">$</span><span class="va">strata</span><span class="op">)</span> <span class="op">/</span> <span class="fl">100</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   1   2   3   4 </span></span>
<span><span class="co">#&gt; 0.2 0.6 0.1 0.1</span></span></code></pre></div>
<p>Finally, <code>type = "optim</code> allows for the user to define a
<code>raster</code> metric to be used to optimize within strata
variances.</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- manual stratified sampling of existing with user defined weights ---#</span></span>
<span><span class="fu"><a href="../reference/sample_existing.html">sample_existing</a></span><span class="op">(</span>existing <span class="op">=</span> <span class="va">e_strata</span>, nSamp <span class="op">=</span> <span class="fl">100</span>, type <span class="op">=</span> <span class="st">"strat"</span>, allocation <span class="op">=</span> <span class="st">"optim"</span>, raster <span class="op">=</span> <span class="va">mraster</span>, metric <span class="op">=</span> <span class="st">"zq90"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Simple feature collection with 100 features and 4 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431110 ymin: 5337776 xmax: 438539.6 ymax: 5343214</span></span>
<span><span class="co">#&gt; Projected CRS: UTM Zone 17, Northern Hemisphere</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;    strata zq90 pzabove2  zsd                 geometry</span></span>
<span><span class="co">#&gt; 1       1 13.0     88.8 2.89 POINT (438539.6 5341225)</span></span>
<span><span class="co">#&gt; 2       1 18.6     95.5 3.44 POINT (432429.9 5340012)</span></span>
<span><span class="co">#&gt; 3       1 12.6     82.4 3.44 POINT (432561.6 5342349)</span></span>
<span><span class="co">#&gt; 4       1 15.3     81.1 4.20 POINT (438405.7 5340976)</span></span>
<span><span class="co">#&gt; 5       1 16.9     96.3 3.47 POINT (431719.4 5341678)</span></span>
<span><span class="co">#&gt; 6       1 17.4     91.1 4.72 POINT (431799.8 5337942)</span></span>
<span><span class="co">#&gt; 7       1 16.2     93.2 3.14 POINT (437332.8 5341071)</span></span>
<span><span class="co">#&gt; 8       1 14.2     98.1 3.23 POINT (437489.5 5337776)</span></span>
<span><span class="co">#&gt; 9       1 15.3     97.8 3.51 POINT (436875.8 5338427)</span></span>
<span><span class="co">#&gt; 10      1 19.0     93.2 4.40 POINT (431509.3 5340988)</span></span></code></pre></div>
<p>We see from the output that we get 300 sample units that are a
sub-sample of <code>existing</code>. The plotted output shows cumulative
frequency distributions of the population (all <code>existing</code>
samples) and the sub-sample (the 300 samples we requested).</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://scholar.google.ca/citations?user=C_qdYDsAAAAJ&amp;hl=en" class="external-link">Tristan RH Goodbody</a>, <a href="https://forestry.ubc.ca/faculty-profile/nicholas-coops/" class="external-link">Nicholas C Coops</a>, <a href="https://www.researchgate.net/profile/Martin-Queinnec" class="external-link">Martin Queinnec</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
