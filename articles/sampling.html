<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Learn how to use sample_* functions.
">
<title>Sampling • sgsR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Sampling">
<meta property="og:description" content="Learn how to use sample_* functions.
">
<meta property="og:image" content="/reference/figures/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-115082821-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-115082821-1');
</script><script defer data-domain="pkgdown.r-lib.org,all.tidyverse.org" src="https://plausible.io/js/plausible.js"></script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">sgsR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.3.32</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/sgsR.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/calculating.html">Calculating</a>
    <a class="dropdown-item" href="../articles/sampling.html">Sampling</a>
    <a class="dropdown-item" href="../articles/stratification.html">Stratification</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/tgoodbody/sgsR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Sampling</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/tgoodbody/sgsR/blob/HEAD/vignettes/sampling.Rmd" class="external-link"><code>vignettes/sampling.Rmd</code></a></small>
      <div class="d-none name"><code>sampling.Rmd</code></div>
    </div>

    
    
<style type="text/css">
.infobox {
  padding: 1em 1em 1em 4em;
  margin-bottom: 10px;
  border: 2px solid #43602d;
  border-radius: 10px;
  background: #738e41 5px center/3em no-repeat;
}

.caution {
  background-image: url("https://tgoodbody.github.io/sgsR/logo.png");
}

</style>
<p>Currently, there are 8 functions associated with the
<code>sample</code> verb in the <code>sgsR</code> package:</p>
<table class="table">
<colgroup>
<col width="21%">
<col width="45%">
<col width="33%">
</colgroup>
<thead><tr class="header">
<th align="center">Algorithm</th>
<th align="center">Description</th>
<th align="center">Reference</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center"><a href="#srs"><code>sample_srs()</code></a></td>
<td align="center">Simple random</td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center"><a href="#systematic"><code>sample_systematic()</code></a></td>
<td align="center">Systematic</td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center"><a href="#sstrat"><code>sample_strat()</code></a></td>
<td align="center">Stratified</td>
<td align="center"><a href="https://www.sciencedirect.com/science/article/pii/S0034425721002303" class="external-link">Queinnec,
White, &amp; Coops (2021)</a></td>
</tr>
<tr class="even">
<td align="center"><a href="#nc"><code>sample_nc()</code></a></td>
<td align="center">Nearest centroid</td>
<td align="center"><a href="https://doi.org/10.1080/00049158.2016.1218265" class="external-link">Melville &amp;
Stone (2016)</a></td>
</tr>
<tr class="odd">
<td align="center"><a href="#clhs"><code>sample_clhs()</code></a></td>
<td align="center">Conditioned Latin hypercube</td>
<td align="center"><a href="https://www.sciencedirect.com/science/article/pii/S009830040500292X?via%3Dihub" class="external-link">Minasny
&amp; McBratney (2006)</a></td>
</tr>
<tr class="even">
<td align="center"><a href="#balanced"><code>sample_balanced()</code></a></td>
<td align="center">Balanced sampling</td>
<td align="center"><a href="http://www.antongrafstrom.se/balancedsampling/" class="external-link">Grafström, A.
Lisic, J (2018)</a></td>
</tr>
<tr class="odd">
<td align="center"><a href="#ahels"><code>sample_ahels()</code></a></td>
<td align="center">Adapted hypercube evaluation of a legacy sample</td>
<td align="center"><a href="https://peerj.com/articles/6451/" class="external-link">Malone,
Minasny, &amp; Brungard (2019)</a></td>
</tr>
<tr class="even">
<td align="center"><a href="#samp-existing"><code>sample_existing()</code></a></td>
<td align="center">Sub-sampling an existing sample</td>
<td align="center"></td>
</tr>
</tbody>
</table>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="srs">
<code>sample_srs</code><a class="anchor" aria-label="anchor" href="#srs"></a>
</h2>
<p>We have demonstrated a simple example of using the
<code><a href="../reference/sample_srs.html">sample_srs()</a></code> function in <code><a href="../articles/sgsR.html">vignette("sgsR")</a></code>. We
will demonstrate additional examples below.</p>
<div class="infobox caution">
<p><strong><code>raster</code></strong></p>
<p>The input required for <code><a href="../reference/sample_srs.html">sample_srs()</a></code> is a
<code>raster</code>. This means that <code>sraster</code> and
<code>mraster</code> are supported for this function.</p>
</div>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- perform simple random sampling ---#</span></span>
<span><span class="fu"><a href="../reference/sample_srs.html">sample_srs</a></span><span class="op">(</span>raster <span class="op">=</span> <span class="va">sraster</span>, <span class="co"># input sraster</span></span>
<span>           nSamp <span class="op">=</span> <span class="fl">200</span>, <span class="co"># number of desired sample units</span></span>
<span>           plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># plot</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; Simple feature collection with 200 features and 0 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431130 ymin: 5337710 xmax: 438530 ymax: 5343230</span></span>
<span><span class="co">#&gt; CRS:           +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;                  geometry</span></span>
<span><span class="co">#&gt; 1  POINT (432910 5341830)</span></span>
<span><span class="co">#&gt; 2  POINT (432910 5341830)</span></span>
<span><span class="co">#&gt; 3  POINT (435030 5337950)</span></span>
<span><span class="co">#&gt; 4  POINT (432130 5337810)</span></span>
<span><span class="co">#&gt; 5  POINT (435490 5342930)</span></span>
<span><span class="co">#&gt; 6  POINT (431570 5337750)</span></span>
<span><span class="co">#&gt; 7  POINT (432730 5341870)</span></span>
<span><span class="co">#&gt; 8  POINT (432810 5341910)</span></span>
<span><span class="co">#&gt; 9  POINT (432050 5342810)</span></span>
<span><span class="co">#&gt; 10 POINT (436910 5338530)</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sample_srs.html">sample_srs</a></span><span class="op">(</span>raster <span class="op">=</span> <span class="va">mraster</span>, <span class="co"># input mraster</span></span>
<span>           nSamp <span class="op">=</span> <span class="fl">200</span>, <span class="co"># number of desired sample units</span></span>
<span>           access <span class="op">=</span> <span class="va">access</span>, <span class="co"># define access road network</span></span>
<span>           mindist <span class="op">=</span> <span class="fl">200</span>, <span class="co"># minimum distance sample units must be apart from one another</span></span>
<span>           buff_inner <span class="op">=</span> <span class="fl">50</span>, <span class="co"># inner buffer - no sample units within this distance from road</span></span>
<span>           buff_outer <span class="op">=</span> <span class="fl">200</span>, <span class="co"># outer buffer - no sample units further than this distance from road</span></span>
<span>           plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># plot</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; Simple feature collection with 200 features and 0 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431130 ymin: 5337710 xmax: 438430 ymax: 5343230</span></span>
<span><span class="co">#&gt; CRS:           +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;                  geometry</span></span>
<span><span class="co">#&gt; 1  POINT (436210 5339690)</span></span>
<span><span class="co">#&gt; 2  POINT (436530 5338170)</span></span>
<span><span class="co">#&gt; 3  POINT (437230 5343030)</span></span>
<span><span class="co">#&gt; 4  POINT (433010 5342970)</span></span>
<span><span class="co">#&gt; 5  POINT (435170 5339330)</span></span>
<span><span class="co">#&gt; 6  POINT (436810 5338470)</span></span>
<span><span class="co">#&gt; 7  POINT (434070 5343010)</span></span>
<span><span class="co">#&gt; 8  POINT (434570 5340910)</span></span>
<span><span class="co">#&gt; 9  POINT (438410 5338110)</span></span>
<span><span class="co">#&gt; 10 POINT (437010 5337890)</span></span></code></pre>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="systematic">
<code>sample_systematic</code><a class="anchor" aria-label="anchor" href="#systematic"></a>
</h2>
<p>The <code><a href="../reference/sample_systematic.html">sample_systematic()</a></code> function applies systematic
sampling across an area with the <code>cellsize</code> parameter
defining the resolution of the tessellation. The tessellation shape can
be modified using the <code>square</code> parameter. Assigning
<code>TRUE</code> (default) to the <code>square</code> parameter results
in a regular grid and assigning <code>FALSE</code> results in a
hexagonal grid.</p>
<p>The location of sample units can also be adjusted using the
<code>locations</code> parameter, where <code>centers</code> takes the
center, <code>corners</code> takes all corners, and <code>random</code>
takes a random location within each tessellation. Random start points
and translations are applied when the function is called.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- perform grid sampling ---#</span></span>
<span><span class="fu"><a href="../reference/sample_systematic.html">sample_systematic</a></span><span class="op">(</span>raster <span class="op">=</span> <span class="va">sraster</span>, <span class="co"># input sraster</span></span>
<span>                  cellsize <span class="op">=</span> <span class="fl">1000</span>, <span class="co"># grid distance</span></span>
<span>                  plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># plot</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; Simple feature collection with 40 features and 0 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431153.9 ymin: 5337827 xmax: 438380.9 ymax: 5343234</span></span>
<span><span class="co">#&gt; CRS:           +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;                    geometry</span></span>
<span><span class="co">#&gt; 1  POINT (437497.2 5337932)</span></span>
<span><span class="co">#&gt; 2  POINT (438380.9 5338400)</span></span>
<span><span class="co">#&gt; 3  POINT (435261.8 5337879)</span></span>
<span><span class="co">#&gt; 4  POINT (437912.8 5339284)</span></span>
<span><span class="co">#&gt; 5  POINT (433026.3 5337827)</span></span>
<span><span class="co">#&gt; 6    POINT (433910 5338295)</span></span>
<span><span class="co">#&gt; 7  POINT (434793.7 5338763)</span></span>
<span><span class="co">#&gt; 8  POINT (435677.4 5339231)</span></span>
<span><span class="co">#&gt; 9    POINT (436561 5339699)</span></span>
<span><span class="co">#&gt; 10 POINT (437444.7 5340167)</span></span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- perform grid sampling ---#</span></span>
<span><span class="fu"><a href="../reference/sample_systematic.html">sample_systematic</a></span><span class="op">(</span>raster <span class="op">=</span> <span class="va">sraster</span>, <span class="co"># input sraster</span></span>
<span>                  cellsize <span class="op">=</span> <span class="fl">500</span>, <span class="co"># grid distance</span></span>
<span>                  square <span class="op">=</span> <span class="cn">FALSE</span>, <span class="co"># hexagonal tessellation</span></span>
<span>                  location <span class="op">=</span> <span class="st">"random"</span>, <span class="co"># randomly sample within tessellation</span></span>
<span>                  plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># plot</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; Simple feature collection with 161 features and 0 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431266.3 ymin: 5337753 xmax: 438506.5 ymax: 5343211</span></span>
<span><span class="co">#&gt; CRS:           +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;                    geometry</span></span>
<span><span class="co">#&gt; 1  POINT (438326.6 5341543)</span></span>
<span><span class="co">#&gt; 2  POINT (438506.5 5340779)</span></span>
<span><span class="co">#&gt; 3  POINT (438176.5 5339844)</span></span>
<span><span class="co">#&gt; 4    POINT (438392 5338773)</span></span>
<span><span class="co">#&gt; 5  POINT (438165.8 5338025)</span></span>
<span><span class="co">#&gt; 6  POINT (438151.4 5342165)</span></span>
<span><span class="co">#&gt; 7  POINT (438109.9 5341019)</span></span>
<span><span class="co">#&gt; 8  POINT (438059.7 5340135)</span></span>
<span><span class="co">#&gt; 9  POINT (438202.9 5339473)</span></span>
<span><span class="co">#&gt; 10   POINT (438096 5338719)</span></span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sample_systematic.html">sample_systematic</a></span><span class="op">(</span>raster <span class="op">=</span> <span class="va">sraster</span>, <span class="co"># input sraster</span></span>
<span>            cellsize <span class="op">=</span> <span class="fl">500</span>, <span class="co"># grid distance</span></span>
<span>            access <span class="op">=</span> <span class="va">access</span>, <span class="co"># define access road network</span></span>
<span>            buff_outer <span class="op">=</span> <span class="fl">200</span>, <span class="co"># outer buffer - no sample units further than this distance from road</span></span>
<span>            square <span class="op">=</span> <span class="cn">FALSE</span>, <span class="co"># hexagonal tessellation</span></span>
<span>            location <span class="op">=</span> <span class="st">"corners"</span>, <span class="co"># take corners instead of centers</span></span>
<span>            plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; Simple feature collection with 621 features and 0 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431118.9 ymin: 5337710 xmax: 438489.9 ymax: 5343236</span></span>
<span><span class="co">#&gt; CRS:           +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;                    geometry</span></span>
<span><span class="co">#&gt; 1  POINT (438429.1 5337812)</span></span>
<span><span class="co">#&gt; 2  POINT (438429.1 5337812)</span></span>
<span><span class="co">#&gt; 3    POINT (438340 5338087)</span></span>
<span><span class="co">#&gt; 4  POINT (438444.3 5338576)</span></span>
<span><span class="co">#&gt; 5    POINT (438340 5338087)</span></span>
<span><span class="co">#&gt; 6  POINT (438429.1 5337812)</span></span>
<span><span class="co">#&gt; 7  POINT (437864.4 5337932)</span></span>
<span><span class="co">#&gt; 8  POINT (438057.7 5338147)</span></span>
<span><span class="co">#&gt; 9    POINT (438340 5338087)</span></span>
<span><span class="co">#&gt; 10 POINT (438444.3 5338576)</span></span></code></pre>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="sstrat">
<code>sample_strat</code><a class="anchor" aria-label="anchor" href="#sstrat"></a>
</h2>
<p>The <code><a href="../reference/sample_strat.html">sample_strat()</a></code> contains two <code>method</code>s to
perform sampling:</p>
<ul>
<li><p><code>"Queinnec"</code> - Hierarchical sampling using a focal
window to isolate contiguous groups of stratum pixels, which was
originally developed by Martin Queinnec.</p></li>
<li><p><code>"random"</code> - Traditional stratified random sampling.
This <code>method</code> ignores much of the functionality of the
algorithm to allow users the capability to use standard stratified
random sampling approaches without the use of a focal window to locate
contiguous stratum cells.</p></li>
</ul>
<div class="section level3 unnumbered">
<h3 class="unnumbered" id="queinnec">
<code>method = "Queinnec"</code><a class="anchor" aria-label="anchor" href="#queinnec"></a>
</h3>
<p><em>Queinnec, M., White, J. C., &amp; Coops, N. C. (2021). Comparing
airborne and spaceborne photon-counting LiDAR canopy structural
estimates across different boreal forest types. Remote Sensing of
Environment, 262(August 2020), 112510.</em></p>
<p>This algorithm uses moving window (<code>wrow</code> and
<code>wcol</code> parameters) to filter the input <code>sraster</code>
to prioritize sample unit allocation to where stratum pixels are
spatially grouped, rather than dispersed individuals across the
landscape.</p>
<p>Sampling is performed using 2 rules:</p>
<ul>
<li><p><strong>Rule 1</strong> - Sample within spatially grouped stratum
pixels. Moving window defined by <code>wrow</code> and
<code>wcol</code>.</p></li>
<li><p><strong>Rule 2</strong> - If no additional sample units exist to
satisfy desired sample size(<code>nSamp</code>), individual stratum
pixels are sampled.</p></li>
</ul>
<p>The rule applied to a select each sample unit is defined in the
<code>rule</code> attribute of output samples. We give a few examples
below:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- perform stratified sampling random sampling ---#</span></span>
<span><span class="fu"><a href="../reference/sample_strat.html">sample_strat</a></span><span class="op">(</span>sraster <span class="op">=</span> <span class="va">sraster</span>, <span class="co"># input sraster</span></span>
<span>             nSamp <span class="op">=</span> <span class="fl">200</span>, <span class="co"># desired sample size</span></span>
<span>             plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># plot</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; Simple feature collection with 200 features and 3 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431110 ymin: 5337750 xmax: 438510 ymax: 5343230</span></span>
<span><span class="co">#&gt; CRS:           NA</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;    strata type  rule               geometry</span></span>
<span><span class="co">#&gt; x       1  new rule1 POINT (434810 5341950)</span></span>
<span><span class="co">#&gt; x1      1  new rule2 POINT (437590 5339310)</span></span>
<span><span class="co">#&gt; x2      1  new rule2 POINT (438490 5340430)</span></span>
<span><span class="co">#&gt; x3      1  new rule2 POINT (434410 5341810)</span></span>
<span><span class="co">#&gt; x4      1  new rule2 POINT (434950 5339470)</span></span>
<span><span class="co">#&gt; x5      1  new rule2 POINT (437810 5341130)</span></span>
<span><span class="co">#&gt; x6      1  new rule2 POINT (434250 5340070)</span></span>
<span><span class="co">#&gt; x7      1  new rule2 POINT (438230 5339370)</span></span>
<span><span class="co">#&gt; x8      1  new rule2 POINT (436330 5338310)</span></span>
<span><span class="co">#&gt; x9      1  new rule2 POINT (434150 5337750)</span></span></code></pre>
<p>In some cases, users might want to include an <code>existing</code>
sample within the algorithm. In order to adjust the total number of
sample units needed per stratum to reflect those already present in
<code>existing</code>, we can use the intermediate function
<code><a href="../reference/extract_strata.html">extract_strata()</a></code>.</p>
<p>This function uses the <code>sraster</code> and <code>existing</code>
sample units and extracts the stratum for each. These sample units can
be included within <code><a href="../reference/sample_strat.html">sample_strat()</a></code>, which adjusts total
sample units required per class based on representation in
<code>existing</code>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- extract strata values to existing samples ---#              </span></span>
<span><span class="va">e.sr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_strata.html">extract_strata</a></span><span class="op">(</span>sraster <span class="op">=</span> <span class="va">sraster</span>, <span class="co"># input sraster</span></span>
<span>                       existing <span class="op">=</span> <span class="va">existing</span><span class="op">)</span> <span class="co"># existing samples to add strata value to</span></span></code></pre></div>
<div class="infobox caution">
<p><strong>TIP!</strong></p>
<p><code><a href="../reference/sample_strat.html">sample_strat()</a></code> requires the <code>sraster</code> input
to have an attribute named <code>strata</code> and will give an error if
it doesn’t.</p>
</div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sample_strat.html">sample_strat</a></span><span class="op">(</span>sraster <span class="op">=</span> <span class="va">sraster</span>, <span class="co"># input sraster</span></span>
<span>             nSamp <span class="op">=</span> <span class="fl">200</span>, <span class="co"># desired sample size</span></span>
<span>             access <span class="op">=</span> <span class="va">access</span>, <span class="co"># define access road network</span></span>
<span>             existing <span class="op">=</span> <span class="va">e.sr</span>, <span class="co"># existing sample with strata values</span></span>
<span>             mindist <span class="op">=</span> <span class="fl">200</span>, <span class="co"># minimum distance sample units must be apart from one another</span></span>
<span>             buff_inner <span class="op">=</span> <span class="fl">50</span>, <span class="co"># inner buffer - no sample units within this distance from road</span></span>
<span>             buff_outer <span class="op">=</span> <span class="fl">200</span>, <span class="co"># outer buffer - no sample units further than this distance from road</span></span>
<span>             plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># plot</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; Simple feature collection with 400 features and 3 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431150 ymin: 5337710 xmax: 438550 ymax: 5343210</span></span>
<span><span class="co">#&gt; CRS:           NA</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;    strata     type     rule               geometry</span></span>
<span><span class="co">#&gt; 1       1 existing existing POINT (437530 5338590)</span></span>
<span><span class="co">#&gt; 2       1 existing existing POINT (436010 5342430)</span></span>
<span><span class="co">#&gt; 3       1 existing existing POINT (437590 5341630)</span></span>
<span><span class="co">#&gt; 4       1 existing existing POINT (435910 5339710)</span></span>
<span><span class="co">#&gt; 5       1 existing existing POINT (436630 5337710)</span></span>
<span><span class="co">#&gt; 6       1 existing existing POINT (436730 5337930)</span></span>
<span><span class="co">#&gt; 7       1 existing existing POINT (436750 5338290)</span></span>
<span><span class="co">#&gt; 8       1 existing existing POINT (435050 5339430)</span></span>
<span><span class="co">#&gt; 9       1 existing existing POINT (436530 5339550)</span></span>
<span><span class="co">#&gt; 10      1 existing existing POINT (432850 5343030)</span></span></code></pre>
<p>The code in the example above defined the <code>mindist</code>
parameter, which specifies the minimum euclidean distance that new
sample units must be apart from one another.</p>
<p>Notice that the sample units have <code>type</code> and
<code>rule</code> attributes which outline whether they are
<code>existing</code> or <code>new</code>, and whether
<code>rule1</code> or <code>rule2</code> were used to select them. If
<code>type</code> is <em>existing</em> (a user provided
<code>existing</code> sample), <code>rule</code> will be
<em>existing</em> as well as seen above.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sample_strat.html">sample_strat</a></span><span class="op">(</span>sraster <span class="op">=</span> <span class="va">sraster</span>, <span class="co"># input</span></span>
<span>             nSamp <span class="op">=</span> <span class="fl">200</span>, <span class="co"># desired sample size</span></span>
<span>             access <span class="op">=</span> <span class="va">access</span>, <span class="co"># define access road network</span></span>
<span>             existing <span class="op">=</span> <span class="va">e.sr</span>, <span class="co"># existing samples with strata values</span></span>
<span>             include <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># include existing sample in nSamp total</span></span>
<span>             buff_outer <span class="op">=</span> <span class="fl">200</span>, <span class="co"># outer buffer - no samples further than this distance from road</span></span>
<span>             plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># plot</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; Simple feature collection with 200 features and 3 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431190 ymin: 5337710 xmax: 438550 ymax: 5343210</span></span>
<span><span class="co">#&gt; CRS:           NA</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;    strata     type     rule               geometry</span></span>
<span><span class="co">#&gt; 1       1 existing existing POINT (437530 5338590)</span></span>
<span><span class="co">#&gt; 2       1 existing existing POINT (436010 5342430)</span></span>
<span><span class="co">#&gt; 3       1 existing existing POINT (437590 5341630)</span></span>
<span><span class="co">#&gt; 4       1 existing existing POINT (435910 5339710)</span></span>
<span><span class="co">#&gt; 5       1 existing existing POINT (436630 5337710)</span></span>
<span><span class="co">#&gt; 6       1 existing existing POINT (436730 5337930)</span></span>
<span><span class="co">#&gt; 7       1 existing existing POINT (436750 5338290)</span></span>
<span><span class="co">#&gt; 8       1 existing existing POINT (435050 5339430)</span></span>
<span><span class="co">#&gt; 9       1 existing existing POINT (436530 5339550)</span></span>
<span><span class="co">#&gt; 10      1 existing existing POINT (432850 5343030)</span></span></code></pre>
<p>The <code>include</code> parameter determines whether
<code>existing</code> sample units should be included in the total
sample size defined by <code>nSamp</code>. By default, the
<code>include</code> parameter is set as <code>FALSE</code>.</p>
</div>
<div class="section level3 unnumbered">
<h3 class="unnumbered" id="stratrandom">
<code>method = "random</code><a class="anchor" aria-label="anchor" href="#stratrandom"></a>
</h3>
<p>Stratified random sampling with equal probability for all cells
(using default algorithm values for <code>mindist</code> and no use of
<code>access</code> functionality). In essence this method perform the
<code>sample_srs</code> algorithm for each stratum separately to meet
the specified sample size.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- perform stratified sampling random sampling ---#</span></span>
<span><span class="fu"><a href="../reference/sample_strat.html">sample_strat</a></span><span class="op">(</span>sraster <span class="op">=</span> <span class="va">sraster</span>, <span class="co"># input sraster</span></span>
<span>             method <span class="op">=</span> <span class="st">"random"</span>, <span class="co">#stratified random sampling</span></span>
<span>             nSamp <span class="op">=</span> <span class="fl">200</span>, <span class="co"># desired sample size</span></span>
<span>             plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># plot</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; Simple feature collection with 200 features and 1 field</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431290 ymin: 5337750 xmax: 438550 ymax: 5343230</span></span>
<span><span class="co">#&gt; Projected CRS: UTM Zone 17, Northern Hemisphere</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;    strata               geometry</span></span>
<span><span class="co">#&gt; 1       1 POINT (433030 5341850)</span></span>
<span><span class="co">#&gt; 2       1 POINT (433030 5341850)</span></span>
<span><span class="co">#&gt; 3       1 POINT (433730 5340870)</span></span>
<span><span class="co">#&gt; 4       1 POINT (435010 5342470)</span></span>
<span><span class="co">#&gt; 5       1 POINT (434470 5341750)</span></span>
<span><span class="co">#&gt; 6       1 POINT (434610 5341250)</span></span>
<span><span class="co">#&gt; 7       1 POINT (433570 5341570)</span></span>
<span><span class="co">#&gt; 8       1 POINT (434650 5342230)</span></span>
<span><span class="co">#&gt; 9       1 POINT (437870 5338110)</span></span>
<span><span class="co">#&gt; 10      1 POINT (437350 5337930)</span></span></code></pre>
</div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="nc">
<code>sample_nc</code><a class="anchor" aria-label="anchor" href="#nc"></a>
</h2>
<p><code><a href="../reference/sample_nc.html">sample_nc()</a></code> function implements the Nearest Centroid
sampling algorithm described in <a href="https://doi.org/10.1080/00049158.2016.1218265" class="external-link">Melville &amp;
Stone (2016)</a>. The algorithm uses kmeans clustering where the number
of clusters (centroids) is equal to the desired sample size
(<code>nSamp</code>).</p>
<p>Cluster centers are located, which then prompts the nearest neighbour
<code>mraster</code> pixel for each cluster to be selected (assuming
default <code>k</code> parameter). These nearest neighbours are the
output sample units.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- perform simple random sampling ---#</span></span>
<span><span class="fu"><a href="../reference/sample_nc.html">sample_nc</a></span><span class="op">(</span>mraster <span class="op">=</span> <span class="va">mraster</span>, <span class="co"># input</span></span>
<span>          nSamp <span class="op">=</span> <span class="fl">25</span>, <span class="co"># desired sample size</span></span>
<span>          plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; K-means being performed on 3 layers with 25 centers.</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; Simple feature collection with 25 features and 4 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431190 ymin: 5337890 xmax: 438530 ymax: 5342530</span></span>
<span><span class="co">#&gt; CRS:           +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;        zq90 pzabove2  zsd kcenter               geometry</span></span>
<span><span class="co">#&gt; 32048 26.50     87.4 8.24       1 POINT (437950 5341530)</span></span>
<span><span class="co">#&gt; 84903 11.40     50.3 3.12       2 POINT (435730 5338690)</span></span>
<span><span class="co">#&gt; 99628 18.30     87.6 4.81       3 POINT (431830 5337890)</span></span>
<span><span class="co">#&gt; 70502 21.60     92.2 5.02       4 POINT (431190 5339450)</span></span>
<span><span class="co">#&gt; 49459 19.10     92.6 3.82       5 POINT (435550 5340590)</span></span>
<span><span class="co">#&gt; 32927  6.83     13.4 1.80       6 POINT (433150 5341470)</span></span>
<span><span class="co">#&gt; 99897  8.11     86.2 1.78       7 POINT (437210 5337890)</span></span>
<span><span class="co">#&gt; 77781 15.60     22.0 4.68       8 POINT (435030 5339070)</span></span>
<span><span class="co">#&gt; 90156  9.95     68.6 2.59       9 POINT (436350 5338410)</span></span>
<span><span class="co">#&gt; 16979  4.55     32.1 1.02      10 POINT (434970 5342330)</span></span></code></pre>
<p>Altering the <code>k</code> parameter leads to a multiplicative
increase in output sample units where total output samples = <span class="math inline">\(nSamp * k\)</span>.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- perform simple random sampling ---#</span></span>
<span><span class="va">samples</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sample_nc.html">sample_nc</a></span><span class="op">(</span>mraster <span class="op">=</span> <span class="va">mraster</span>, <span class="co"># input</span></span>
<span>                    k <span class="op">=</span> <span class="fl">2</span>, <span class="co"># number of nearest neighbours to take for each kmeans center</span></span>
<span>                    nSamp <span class="op">=</span> <span class="fl">25</span>, <span class="co"># desired sample size</span></span>
<span>                    plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; K-means being performed on 3 layers with 25 centers.</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">#--- total samples = nSamp * k (25 * 2) = 50 ---#</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">samples</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 50</span></span></code></pre></div>
<p>Visualizing what the kmeans centers and sample units looks like is
possible when using <code>details = TRUE</code>. The <code>$kplot</code>
output provides a quick visualization of where the centers are based on
a scatter plot of the first 2 layers in <code>mraster</code>. Notice
that the centers are well distributed in covariate space and chosen
sample units are the closest pixels to each center (nearest
neighbours).</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- perform simple random sampling with details ---#</span></span>
<span><span class="va">details</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sample_nc.html">sample_nc</a></span><span class="op">(</span>mraster <span class="op">=</span> <span class="va">mraster</span>, <span class="co"># input</span></span>
<span>                     nSamp <span class="op">=</span> <span class="fl">25</span>, <span class="co"># desired sample number</span></span>
<span>                     details <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; K-means being performed on 3 layers with 25 centers.</span></span>
<span></span>
<span><span class="co">#--- plot ggplot output ---#</span></span>
<span></span>
<span><span class="va">details</span><span class="op">$</span><span class="va">kplot</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="clhs">
<code>sample_clhs</code><a class="anchor" aria-label="anchor" href="#clhs"></a>
</h2>
<p><code><a href="../reference/sample_clhs.html">sample_clhs()</a></code> function implements conditioned Latin
hypercube (clhs) sampling methodology from the <a href="https://CRAN.R-project.org/package=clhs/" class="external-link"><code>clhs</code></a>
package.</p>
<div class="infobox caution">
<p><strong>TIP!</strong></p>
<p>A number of other functions in the <code>sgsR</code> package help to
provide guidance on clhs sampling including <code><a href="../reference/calculate_pop.html">calculate_pop()</a></code>
and <code><a href="../reference/calculate_lhsOpt.html">calculate_lhsOpt()</a></code>. Check out these functions to better
understand how sample numbers could be optimized.</p>
</div>
<p>The syntax for this function is similar to others shown above,
although parameters like <code>iter</code>, which define the number of
iterations within the Metropolis-Hastings process are important to
consider. In these examples we use a low <code>iter</code> value for
efficiency. Default values for <code>iter</code> within the
<code>clhs</code> package are 10,000.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sample_clhs.html">sample_clhs</a></span><span class="op">(</span>mraster <span class="op">=</span> <span class="va">mraster</span>, <span class="co"># input</span></span>
<span>            nSamp <span class="op">=</span> <span class="fl">200</span>, <span class="co"># desired sample size</span></span>
<span>            plot <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># plot </span></span>
<span>            iter <span class="op">=</span> <span class="fl">100</span><span class="op">)</span> <span class="co"># number of iterations</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-19-1.png" width="700"></p>
<p>The <code>cost</code> parameter defines the <code>mraster</code>
covariate, which is used to constrain the clhs sampling. An example
could be the distance a pixel is from road <code>access</code>
(e.g. from <code><a href="../reference/calculate_distance.html">calculate_distance()</a></code> see example below), terrain
slope, the output from <code><a href="../reference/calculate_coobs.html">calculate_coobs()</a></code>, or many
others.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co">#--- cost constrained examples ---#</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="co">#--- calculate distance to access layer for each pixel in mr ---#</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>mr.c <span class="ot">&lt;-</span> <span class="fu">calculate_distance</span>(<span class="at">raster =</span> mraster, <span class="co"># input</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">access =</span> access, <span class="co"># define access road network</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">plot =</span> <span class="cn">TRUE</span>) <span class="co"># plot</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="sc">|---------</span><span class="er">|</span><span class="sc">---------</span><span class="er">|</span><span class="sc">---------</span><span class="er">|</span><span class="sc">---------</span><span class="er">|</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="er">=========================================</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>                                          </span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-20-1.png" width="700"></p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sample_clhs.html">sample_clhs</a></span><span class="op">(</span>mraster <span class="op">=</span> <span class="va">mr.c</span>, <span class="co"># input</span></span>
<span>            nSamp <span class="op">=</span> <span class="fl">250</span>, <span class="co"># desired sample size</span></span>
<span>            iter <span class="op">=</span> <span class="fl">100</span>, <span class="co"># number of iterations</span></span>
<span>            cost <span class="op">=</span> <span class="st">"dist2access"</span>, <span class="co"># cost parameter - name defined in calculate_distance()</span></span>
<span>            plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># plot</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-22-1.png" width="700"></p>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="balanced">
<code>sample_balanced</code><a class="anchor" aria-label="anchor" href="#balanced"></a>
</h2>
<p>The <code><a href="../reference/sample_balanced.html">sample_balanced()</a></code> algorithm performs a balanced
sampling methodology from the <a href="http://www.antongrafstrom.se/balancedsampling/" class="external-link"><code>stratifyR / SamplingBigData</code></a>
packages.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sample_balanced.html">sample_balanced</a></span><span class="op">(</span>mraster <span class="op">=</span> <span class="va">mraster</span>, <span class="co"># input</span></span>
<span>                nSamp <span class="op">=</span> <span class="fl">200</span>, <span class="co"># desired sample size</span></span>
<span>                plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># plot</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-23-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; Simple feature collection with 200 features and 0 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431110 ymin: 5337710 xmax: 438490 ymax: 5343210</span></span>
<span><span class="co">#&gt; CRS:           +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;                  geometry</span></span>
<span><span class="co">#&gt; 1  POINT (432590 5343210)</span></span>
<span><span class="co">#&gt; 2  POINT (435550 5343190)</span></span>
<span><span class="co">#&gt; 3  POINT (437310 5343170)</span></span>
<span><span class="co">#&gt; 4  POINT (437870 5343150)</span></span>
<span><span class="co">#&gt; 5  POINT (435710 5343130)</span></span>
<span><span class="co">#&gt; 6  POINT (432410 5343050)</span></span>
<span><span class="co">#&gt; 7  POINT (433510 5343050)</span></span>
<span><span class="co">#&gt; 8  POINT (438210 5343030)</span></span>
<span><span class="co">#&gt; 9  POINT (434790 5342970)</span></span>
<span><span class="co">#&gt; 10 POINT (435670 5342970)</span></span></code></pre>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sample_balanced.html">sample_balanced</a></span><span class="op">(</span>mraster <span class="op">=</span> <span class="va">mraster</span>, <span class="co"># input</span></span>
<span>                nSamp <span class="op">=</span> <span class="fl">100</span>, <span class="co"># desired sample size</span></span>
<span>                algorithm <span class="op">=</span> <span class="st">"lcube"</span>, <span class="co"># algorithm type</span></span>
<span>                access <span class="op">=</span> <span class="va">access</span>, <span class="co"># define access road network</span></span>
<span>                buff_inner <span class="op">=</span> <span class="fl">50</span>, <span class="co"># inner buffer - no sample units within this distance from road</span></span>
<span>                buff_outer <span class="op">=</span> <span class="fl">200</span><span class="op">)</span> <span class="co"># outer buffer - no sample units further than this distance from road</span></span>
<span><span class="co">#&gt; Simple feature collection with 100 features and 0 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431530 ymin: 5337710 xmax: 438530 ymax: 5343190</span></span>
<span><span class="co">#&gt; CRS:           +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;                  geometry</span></span>
<span><span class="co">#&gt; 1  POINT (434630 5340950)</span></span>
<span><span class="co">#&gt; 2  POINT (436310 5342650)</span></span>
<span><span class="co">#&gt; 3  POINT (438410 5340790)</span></span>
<span><span class="co">#&gt; 4  POINT (438470 5340750)</span></span>
<span><span class="co">#&gt; 5  POINT (435130 5338290)</span></span>
<span><span class="co">#&gt; 6  POINT (434370 5342410)</span></span>
<span><span class="co">#&gt; 7  POINT (438090 5342430)</span></span>
<span><span class="co">#&gt; 8  POINT (437730 5342410)</span></span>
<span><span class="co">#&gt; 9  POINT (436390 5342750)</span></span>
<span><span class="co">#&gt; 10 POINT (435610 5338650)</span></span></code></pre></div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="ahels">
<code>sample_ahels</code><a class="anchor" aria-label="anchor" href="#ahels"></a>
</h2>
<p>The <code><a href="../reference/sample_ahels.html">sample_ahels()</a></code> function performs the adapted
Hypercube Evaluation of a Legacy Sample (ahels) algorithm
using<code>existing</code> sample data and an <code>mraster</code>. New
sample units are allocated based on quantile ratios between the
<code>existing</code> sample and <code>mraster</code> covariate
dataset.</p>
<p>This algorithm was adapted from that presented in the paper below,
which we highly recommend.</p>
<p><em><em>Malone BP, Minansy B, Brungard C. 2019. Some methods to
improve the utility of conditioned Latin hypercube sampling. PeerJ
7:e6451 DOI 10.7717/peerj.6451</em></em></p>
<p>This algorithm:</p>
<ol style="list-style-type: decimal">
<li><p>Determines the quantile distributions of <code>existing</code>
sample units and <code>mraster</code> covariates.</p></li>
<li><p>Determines quantiles where there is a disparity between sample
units and covariates.</p></li>
<li><p>Prioritizes sampling within those quantile to improve
representation.</p></li>
</ol>
<p>To use this function, user must first specify the number of quantiles
(<code>nQuant</code>) followed by either the <code>nSamp</code> (total
number of desired sample units to be added) or the
<code>threshold</code> (sampling ratio vs. covariate coverage ratio for
quantiles - default is 0.9) parameters.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- remove `type` variable from existing  - causes plotting issues ---#</span></span>
<span></span>
<span><span class="va">existing</span> <span class="op">&lt;-</span> <span class="va">existing</span> <span class="op">%&gt;%</span> <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">type</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/sample_ahels.html">sample_ahels</a></span><span class="op">(</span>mraster <span class="op">=</span> <span class="va">mraster</span>, </span>
<span>             existing <span class="op">=</span> <span class="va">existing</span>, <span class="co"># existing sample</span></span>
<span>             plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># plot</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Simple feature collection with 275 features and 7 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431130 ymin: 5337710 xmax: 438550 ymax: 5343210</span></span>
<span><span class="co">#&gt; CRS:           +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;      type.x  zq90 pzabove2  zsd strata type.y  rule</span></span>
<span><span class="co">#&gt; 1  existing  8.21     57.7 2.14      1    new rule1</span></span>
<span><span class="co">#&gt; 2  existing  4.28     52.2 0.89      1    new rule2</span></span>
<span><span class="co">#&gt; 3  existing  7.87     66.8 2.04      1    new rule2</span></span>
<span><span class="co">#&gt; 4  existing  6.67     26.3 1.65      1    new rule2</span></span>
<span><span class="co">#&gt; 5  existing  8.87     62.4 2.38      1    new rule2</span></span>
<span><span class="co">#&gt; 6  existing  5.18     39.2 1.16      1    new rule2</span></span>
<span><span class="co">#&gt; 7  existing  7.75     76.2 1.70      1    new rule2</span></span>
<span><span class="co">#&gt; 8  existing  8.33      7.2 2.20      1    new rule2</span></span>
<span><span class="co">#&gt; 9  existing 10.10     88.2 2.41      1    new rule2</span></span>
<span><span class="co">#&gt; 10 existing  7.99     57.0 2.16      1    new rule2</span></span>
<span><span class="co">#&gt;                  geometry</span></span>
<span><span class="co">#&gt; 1  POINT (437530 5338590)</span></span>
<span><span class="co">#&gt; 2  POINT (436010 5342430)</span></span>
<span><span class="co">#&gt; 3  POINT (437590 5341630)</span></span>
<span><span class="co">#&gt; 4  POINT (435910 5339710)</span></span>
<span><span class="co">#&gt; 5  POINT (436630 5337710)</span></span>
<span><span class="co">#&gt; 6  POINT (436730 5337930)</span></span>
<span><span class="co">#&gt; 7  POINT (436750 5338290)</span></span>
<span><span class="co">#&gt; 8  POINT (435050 5339430)</span></span>
<span><span class="co">#&gt; 9  POINT (436530 5339550)</span></span>
<span><span class="co">#&gt; 10 POINT (432850 5343030)</span></span></code></pre>
<div class="infobox caution">
<p><strong>TIP!</strong></p>
<p>Notice that no <code>threshold</code>, <code>nSamp</code>, or
<code>nQuant</code> were defined. That is because the default setting
for <code>threshold = 0.9</code> and <code>nQuant = 10</code>.</p>
</div>
<p>The first matrix output shows the quantile ratios between the sample
and the covariates. A value of 1.0 indicates that the sample is
representative of quantile coverage. Values &gt; 1.0 indicate over
representation of sample units, while &lt; 1.0 indicate under
representation.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sample_ahels.html">sample_ahels</a></span><span class="op">(</span>mraster <span class="op">=</span> <span class="va">mraster</span>, </span>
<span>             existing <span class="op">=</span> <span class="va">existing</span>, <span class="co"># existing sample</span></span>
<span>             nQuant <span class="op">=</span> <span class="fl">20</span>, <span class="co"># define 20 quantiles</span></span>
<span>             nSamp <span class="op">=</span> <span class="fl">300</span><span class="op">)</span> <span class="co"># desired sample size</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Simple feature collection with 500 features and 7 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431110 ymin: 5337710 xmax: 438550 ymax: 5343230</span></span>
<span><span class="co">#&gt; CRS:           +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;      type.x  zq90 pzabove2  zsd strata type.y  rule</span></span>
<span><span class="co">#&gt; 1  existing  8.21     57.7 2.14      1    new rule1</span></span>
<span><span class="co">#&gt; 2  existing  4.28     52.2 0.89      1    new rule2</span></span>
<span><span class="co">#&gt; 3  existing  7.87     66.8 2.04      1    new rule2</span></span>
<span><span class="co">#&gt; 4  existing  6.67     26.3 1.65      1    new rule2</span></span>
<span><span class="co">#&gt; 5  existing  8.87     62.4 2.38      1    new rule2</span></span>
<span><span class="co">#&gt; 6  existing  5.18     39.2 1.16      1    new rule2</span></span>
<span><span class="co">#&gt; 7  existing  7.75     76.2 1.70      1    new rule2</span></span>
<span><span class="co">#&gt; 8  existing  8.33      7.2 2.20      1    new rule2</span></span>
<span><span class="co">#&gt; 9  existing 10.10     88.2 2.41      1    new rule2</span></span>
<span><span class="co">#&gt; 10 existing  7.99     57.0 2.16      1    new rule2</span></span>
<span><span class="co">#&gt;                  geometry</span></span>
<span><span class="co">#&gt; 1  POINT (437530 5338590)</span></span>
<span><span class="co">#&gt; 2  POINT (436010 5342430)</span></span>
<span><span class="co">#&gt; 3  POINT (437590 5341630)</span></span>
<span><span class="co">#&gt; 4  POINT (435910 5339710)</span></span>
<span><span class="co">#&gt; 5  POINT (436630 5337710)</span></span>
<span><span class="co">#&gt; 6  POINT (436730 5337930)</span></span>
<span><span class="co">#&gt; 7  POINT (436750 5338290)</span></span>
<span><span class="co">#&gt; 8  POINT (435050 5339430)</span></span>
<span><span class="co">#&gt; 9  POINT (436530 5339550)</span></span>
<span><span class="co">#&gt; 10 POINT (432850 5343030)</span></span></code></pre>
<p>Notice that the total number of samples is 500. This value is the sum
of existing units (200) and number of sample units defined by
<code>nSamp = 300</code>.</p>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="samp-existing">
<code>sample_existing</code><a class="anchor" aria-label="anchor" href="#samp-existing"></a>
</h2>
<p>Acknowledging that <code>existing</code> sample networks exist is
important. There is significant investment into these samples, and in
order to keep inventories up-to-date, we often need to collect new data
at these locations. The <code>sample_existing</code> algorithm provides
a method for sub-sampling an <code>existing</code> sample network should
the financial / logistical resources not be available to collect data at
all sample units. The algorithm leverages latin hypercube sampling using
the <a href="https://CRAN.R-project.org/package=clhs" class="external-link">clhs</a> package
to effectively sample within an <code>existing</code> network.</p>
<p>The algorithm has two fundamental approaches:</p>
<ol style="list-style-type: decimal">
<li><p>Sample exclusively using the sample network and the attributes it
contains.</p></li>
<li><p>Should <code>raster</code> information be available and
co-located with the sample, use these data as population values to
improve sub-sampling of <code>existing</code>.</p></li>
</ol>
<p>Much like the <code><a href="../reference/sample_clhs.html">sample_clhs()</a></code> algorithm, users can define
a <code>cost</code> parameter, which will be used to constrain
sub-sampling. A cost parameter is a user defined metric/attribute such
as distance from roads (e.g. <code><a href="../reference/calculate_distance.html">calculate_distance()</a></code>),
elevation, etc.</p>
<div class="section level3">
<h3 id="basic-sub-sampling-of-existing">Basic sub-sampling of <code>existing</code><a class="anchor" aria-label="anchor" href="#basic-sub-sampling-of-existing"></a>
</h3>
<p>First we can create an <code>existing</code> sample for our example.
Lets imagine we have a dataset of ~900 samples, and we know we only have
resources to sample 300 of them. We have some ALS data available
(<code>mraster</code>), which we will use as our distributions to sample
within.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- generate existing samples and extract metrics ---#</span></span>
<span><span class="va">existing</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sample_srs.html">sample_srs</a></span><span class="op">(</span>raster <span class="op">=</span> <span class="va">mraster</span>, nSamp <span class="op">=</span> <span class="fl">900</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-31-1.png" width="700">
Now lets sub-sample.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- sub sample using ---#</span></span>
<span><span class="va">e</span> <span class="op">&lt;-</span> <span class="va">existing</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="../reference/extract_metrics.html">extract_metrics</a></span><span class="op">(</span>mraster <span class="op">=</span> <span class="va">mraster</span>, existing <span class="op">=</span> <span class="va">.</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/sample_existing.html">sample_existing</a></span><span class="op">(</span>existing <span class="op">=</span> <span class="va">e</span>, nSamp <span class="op">=</span> <span class="fl">300</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-32-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; Simple feature collection with 300 features and 3 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431110 ymin: 5337710 xmax: 438530 ymax: 5343230</span></span>
<span><span class="co">#&gt; CRS:           +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;      zq90 pzabove2  zsd               geometry</span></span>
<span><span class="co">#&gt; 88  12.50     91.1 2.12 POINT (432670 5339510)</span></span>
<span><span class="co">#&gt; 103  5.21     56.1 1.17 POINT (433590 5343170)</span></span>
<span><span class="co">#&gt; 383  4.95      7.4 1.32 POINT (435190 5339070)</span></span>
<span><span class="co">#&gt; 58  22.40     76.0 5.65 POINT (435770 5339970)</span></span>
<span><span class="co">#&gt; 124  2.55     11.2 0.40 POINT (438170 5339290)</span></span>
<span><span class="co">#&gt; 263  2.22      0.3 0.29 POINT (434250 5339010)</span></span>
<span><span class="co">#&gt; 640  8.20     45.6 2.09 POINT (436430 5338370)</span></span>
<span><span class="co">#&gt; 50  13.20     95.4 2.42 POINT (432670 5338970)</span></span>
<span><span class="co">#&gt; 770 14.80     99.5 2.76 POINT (436710 5339750)</span></span>
<span><span class="co">#&gt; 398 16.30     89.9 2.63 POINT (437450 5342230)</span></span></code></pre>
<div class="infobox caution">
<p><strong>TIP!</strong></p>
<p>Notice that we used <code><a href="../reference/extract_metrics.html">extract_metrics()</a></code> after creating our
existing. If the user provides a <code>raster</code> for the algorithm
this isn’t neccesary (its done internally). If only sample units are
given, attributes must be provided and <em>sampling will be conducted on
all included attributes</em>.</p>
</div>
<p>We see from the output that we get 300 sample units that are a
sub-sample of <code>existing</code>. The plotted output shows cumulative
frequency distributions of the population (all <code>existing</code>
samples) and the sub-sample (the 300 samples we requested).</p>
</div>
<div class="section level3">
<h3 id="sub-sampling-using-raster-distributions">Sub-sampling using <code>raster</code> distributions<a class="anchor" aria-label="anchor" href="#sub-sampling-using-raster-distributions"></a>
</h3>
<p>Our systematic sample of ~900 plots is fairly comprehensive, however
we can generate a true population distribution through the inclusion of
the ALS metrics in the sampling process. The metrics will be included in
internal latin hypercube sampling to help guide sub-sampling of
<code>existing</code>.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- sub sample using ---#</span></span>
<span><span class="fu"><a href="../reference/sample_existing.html">sample_existing</a></span><span class="op">(</span>existing <span class="op">=</span> <span class="va">existing</span>, <span class="co"># our existing sample</span></span>
<span>                nSamp <span class="op">=</span> <span class="fl">300</span>, <span class="co"># desired sample size</span></span>
<span>                raster <span class="op">=</span> <span class="va">mraster</span>, <span class="co"># include mraster metrics to guide sampling of existing</span></span>
<span>                plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># plot</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-33-1.png" width="700"><img src="sampling_files/figure-html/unnamed-chunk-33-2.png" width="700"></p>
<pre><code><span><span class="co">#&gt; Simple feature collection with 300 features and 3 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431110 ymin: 5337710 xmax: 438510 ymax: 5343230</span></span>
<span><span class="co">#&gt; CRS:           +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;      zq90 pzabove2  zsd               geometry</span></span>
<span><span class="co">#&gt; 714 21.30     78.4 6.03 POINT (431790 5342870)</span></span>
<span><span class="co">#&gt; 775 20.80     95.1 5.07 POINT (436230 5340870)</span></span>
<span><span class="co">#&gt; 612 14.70     83.7 4.12 POINT (431930 5340130)</span></span>
<span><span class="co">#&gt; 565 21.90     16.6 6.85 POINT (435050 5338990)</span></span>
<span><span class="co">#&gt; 732 15.20     88.1 4.40 POINT (435910 5339870)</span></span>
<span><span class="co">#&gt; 93  19.40     95.9 5.39 POINT (438350 5339970)</span></span>
<span><span class="co">#&gt; 349 11.50     71.2 2.65 POINT (432910 5342830)</span></span>
<span><span class="co">#&gt; 564  6.44     79.4 1.30 POINT (432950 5343190)</span></span>
<span><span class="co">#&gt; 158 19.70     87.5 4.64 POINT (435110 5338550)</span></span>
<span><span class="co">#&gt; 527 13.20     93.0 3.07 POINT (437530 5342090)</span></span></code></pre>
<p>The sample distribution again mimics the population distribution
quite well! Now lets try using a cost variable to constrain the
sub-sample.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co">#--- create distance from roads metric ---#</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>dist <span class="ot">&lt;-</span> <span class="fu">calculate_distance</span>(<span class="at">raster =</span> mraster, <span class="at">access =</span> access)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="sc">|---------</span><span class="er">|</span><span class="sc">---------</span><span class="er">|</span><span class="sc">---------</span><span class="er">|</span><span class="sc">---------</span><span class="er">|</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="er">=========================================</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>                                          </span></code></pre></div>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- sub sample using ---#</span></span>
<span><span class="fu"><a href="../reference/sample_existing.html">sample_existing</a></span><span class="op">(</span>existing <span class="op">=</span> <span class="va">existing</span>, <span class="co"># our existing sample</span></span>
<span>                nSamp <span class="op">=</span> <span class="fl">300</span>, <span class="co"># desired sample size</span></span>
<span>                raster <span class="op">=</span> <span class="va">dist</span>, <span class="co"># include mraster metrics to guide sampling of existing</span></span>
<span>                cost <span class="op">=</span> <span class="fl">4</span>, <span class="co"># either provide the index (band number) or the name of the cost layer</span></span>
<span>                plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># plot</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-35-1.png" width="700"><img src="sampling_files/figure-html/unnamed-chunk-35-2.png" width="700"></p>
<pre><code><span><span class="co">#&gt; Simple feature collection with 300 features and 4 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431110 ymin: 5337710 xmax: 438530 ymax: 5343230</span></span>
<span><span class="co">#&gt; CRS:           +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;      zq90 pzabove2  zsd dist2access               geometry</span></span>
<span><span class="co">#&gt; 850  8.01     33.6 1.93    38.18888 POINT (434430 5341290)</span></span>
<span><span class="co">#&gt; 838 20.90     91.5 3.92   186.82412 POINT (432910 5338730)</span></span>
<span><span class="co">#&gt; 333 12.50     95.3 3.22   113.55590 POINT (433810 5342830)</span></span>
<span><span class="co">#&gt; 216 22.80     92.0 5.86   239.38097 POINT (432970 5338770)</span></span>
<span><span class="co">#&gt; 823  6.60     38.4 1.60   174.65181 POINT (437670 5343150)</span></span>
<span><span class="co">#&gt; 459  9.25     59.3 2.37   294.22198 POINT (437630 5338590)</span></span>
<span><span class="co">#&gt; 452 14.40     80.6 3.74   142.78095 POINT (435430 5338230)</span></span>
<span><span class="co">#&gt; 319 19.20     74.5 4.82   224.25636 POINT (435370 5341890)</span></span>
<span><span class="co">#&gt; 35  19.60     87.1 5.46   124.89421 POINT (432330 5341970)</span></span>
<span><span class="co">#&gt; 702 20.30     79.0 6.24   226.18226 POINT (431370 5342870)</span></span></code></pre>
<p>Finally, should the user wish to further constrain the sample based
on <code>access</code> like other sampling approaches in
<code>sgsR</code> that is also possible.</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- ensure access and existing are in the same CRS ---#</span></span>
<span></span>
<span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html" class="external-link">st_crs</a></span><span class="op">(</span><span class="va">existing</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html" class="external-link">st_crs</a></span><span class="op">(</span><span class="va">access</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#--- sub sample using ---#</span></span>
<span><span class="fu"><a href="../reference/sample_existing.html">sample_existing</a></span><span class="op">(</span>existing <span class="op">=</span> <span class="va">existing</span>, <span class="co"># our existing sample</span></span>
<span>                nSamp <span class="op">=</span> <span class="fl">300</span>, <span class="co"># desired sample size</span></span>
<span>                raster <span class="op">=</span> <span class="va">dist</span>, <span class="co"># include mraster metrics to guide sampling of existing</span></span>
<span>                cost <span class="op">=</span> <span class="fl">4</span>, <span class="co"># either provide the index (band number) or the name of the cost layer</span></span>
<span>                access <span class="op">=</span> <span class="va">access</span>, <span class="co"># roads layer</span></span>
<span>                buff_inner <span class="op">=</span> <span class="fl">50</span>, <span class="co"># inner buffer - no sample units within this distance from road</span></span>
<span>                buff_outer <span class="op">=</span> <span class="fl">300</span>, <span class="co"># outer buffer - no sample units further than this distance from road</span></span>
<span>                plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># plot</span></span></code></pre></div>
<p><img src="sampling_files/figure-html/unnamed-chunk-36-1.png" width="700"><img src="sampling_files/figure-html/unnamed-chunk-36-2.png" width="700"></p>
<pre><code><span><span class="co">#&gt; Simple feature collection with 300 features and 4 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431110 ymin: 5337710 xmax: 438530 ymax: 5343230</span></span>
<span><span class="co">#&gt; Projected CRS: UTM_Zone_17_Northern_Hemisphere</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;      zq90 pzabove2  zsd dist2access               geometry</span></span>
<span><span class="co">#&gt; 231  6.94     11.3 1.97   114.74818 POINT (433010 5341690)</span></span>
<span><span class="co">#&gt; 217 19.80     79.9 5.33    62.46923 POINT (433510 5343050)</span></span>
<span><span class="co">#&gt; 227  5.69     51.6 1.34   124.07564 POINT (434870 5341970)</span></span>
<span><span class="co">#&gt; 414 11.10     66.7 3.01    56.89165 POINT (431110 5340550)</span></span>
<span><span class="co">#&gt; 141  6.90     54.4 1.99   129.09362 POINT (432810 5343010)</span></span>
<span><span class="co">#&gt; 370 17.50     94.8 3.65    96.34562 POINT (431790 5337850)</span></span>
<span><span class="co">#&gt; 310 22.10     82.9 6.91   144.16373 POINT (436390 5340210)</span></span>
<span><span class="co">#&gt; 99  13.50     89.5 3.13   112.19848 POINT (432350 5340090)</span></span>
<span><span class="co">#&gt; 45  15.00     96.3 3.01   103.75291 POINT (435290 5337770)</span></span>
<span><span class="co">#&gt; 93  21.00     87.9 6.93    86.26224 POINT (435490 5340210)</span></span></code></pre>
<div class="infobox caution">
<p><strong>TIP!</strong></p>
<p>The greater constraints we add to sampling, the less likely we will
have strong correlations between the population and sample, so its
always important to understand these limitations and plan
accordingly.</p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://scholar.google.ca/citations?user=C_qdYDsAAAAJ&amp;hl=en" class="external-link">Tristan RH Goodbody</a>, <a href="https://forestry.ubc.ca/faculty-profile/nicholas-coops/" class="external-link">Nicholas C Coops</a>, <a href="https://www.researchgate.net/profile/Martin-Queinnec" class="external-link">Martin Queinnec</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
