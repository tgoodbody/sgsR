<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Learn how to use calculate_* functions.
">
<title>calculating • sgsR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="calculating">
<meta property="og:description" content="Learn how to use calculate_* functions.
">
<meta property="og:image" content="/reference/figures/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-115082821-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-115082821-1');
</script><script defer data-domain="pkgdown.r-lib.org,all.tidyverse.org" src="https://plausible.io/js/plausible.js"></script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">sgsR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.2.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/sgsR.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/calculating.html">calculating</a>
    <a class="dropdown-item" href="../articles/sampling.html">sampling</a>
    <a class="dropdown-item" href="../articles/stratification.html">stratification</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/tgoodbody/sgsR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>calculating</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/tgoodbody/sgsR/blob/HEAD/vignettes/calculating.Rmd" class="external-link"><code>vignettes/calculating.Rmd</code></a></small>
      <div class="d-none name"><code>calculating.Rmd</code></div>
    </div>

    
    
<p>Currently, there are 8 functions associated with the <code>calculate</code> verb in the <code>sgsR</code> package:</p>
<ul>
<li><p><code><a href="../reference/calculate_representation.html">calculate_representation()</a></code> - compare the representation of strata in existing samples</p></li>
<li><p><code><a href="../reference/calculate_distance.html">calculate_distance()</a></code> - per pixel distance to the closest <code>access</code> vector</p></li>
<li><p><code><a href="../reference/calculate_pcomp.html">calculate_pcomp()</a></code>- principal components of the input <code>mraster</code></p></li>
<li><p><code><a href="../reference/calculate_sampsize.html">calculate_sampsize()</a></code> - determines appropriate estimated sample sizes based on relative standard error</p></li>
<li><p><code><a href="../reference/calculate_allocation.html">calculate_allocation()</a></code> - sample allocation algorithm - proportional / optimal / equal / manual sampling</p></li>
<li><p><code><a href="../reference/calculate_coobs.html">calculate_coobs()</a></code> - determine how <code>existing</code> samples are distributed among <code>mraster</code> covariates</p></li>
<li><p><code><a href="../reference/calculate_pop.html">calculate_pop()</a></code> - generate population level information (PCA / quantile matrix / covariance matrix) of input <code>mraster</code></p></li>
<li><p><code><a href="../reference/calculate_lhsOpt.html">calculate_lhsOpt()</a></code> - testing to determine optimal Latin hypercube sampling parameters including sample number</p></li>
</ul>
<p><code>calculate_*</code> functions serve as intermediary helper functions. In this section we outline and demonstrate how these functions can be used.</p>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="rep">
<code>calculate_representation()</code><a class="anchor" aria-label="anchor" href="#rep"></a>
</h2>
<p><code><a href="../reference/calculate_representation.html">calculate_representation()</a></code> function allows the users to verify how well the stratification is represented in their <code>existing</code> sample networks. Users input an <code>sraster</code> and their <code>existing</code> samples to the <code><a href="../reference/calculate_representation.html">calculate_representation()</a></code> function, which will result in tabular and graphical (if <code>plot = TRUE</code>) outputs that compare strata coverage frequency and sampling frequency.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- quantile sraster ---#</span></span>
<span><span class="va">quantiles</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/strat_quantiles.html">strat_quantiles</a></span><span class="op">(</span>mraster <span class="op">=</span> <span class="va">mraster</span><span class="op">$</span><span class="va">zq90</span>,</span>
<span>                             nStrata <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#--- random samples ---#</span></span>
<span><span class="va">srs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sample_srs.html">sample_srs</a></span><span class="op">(</span>raster <span class="op">=</span> <span class="va">sraster</span>,</span>
<span>                  nSamp <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#--- calculate representation ---#</span></span>
<span><span class="fu"><a href="../reference/calculate_representation.html">calculate_representation</a></span><span class="op">(</span>sraster <span class="op">=</span> <span class="va">quantiles</span>, </span>
<span>                         existing <span class="op">=</span> <span class="va">srs</span>, </span>
<span>                         plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="calculating_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 8 × 6</span></span></span>
<span><span class="co">#&gt;   strata srasterFreq sampleFreq diffFreq nSamp  need</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>      1        0.13       0.14   0.010<span style="text-decoration: underline;">0</span>     7     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>      2        0.13       0.06  -<span style="color: #BB0000;">0.07</span>       3     4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>      3        0.13       0.18   0.05       9    -<span style="color: #BB0000;">2</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>      4        0.12       0.18   0.06       9    -<span style="color: #BB0000;">3</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>      5        0.12       0.1   -<span style="color: #BB0000;">0.020</span><span style="color: #BB0000; text-decoration: underline;">0</span>     5     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>      6        0.12       0.1   -<span style="color: #BB0000;">0.020</span><span style="color: #BB0000; text-decoration: underline;">0</span>     5     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span>      7        0.12       0.16   0.04       8    -<span style="color: #BB0000;">2</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">8</span>      8        0.12       0.08  -<span style="color: #BB0000;">0.04</span>       4     2</span></span></code></pre>
<p>The tabular output presents the frequency of coverage for each strata (<code>srasterFreq</code>) (what % of the landscape does the strata cover) and the sampling frequency within each strata (<code>sampleFreq</code>) (what % of total <code>existing</code> samples are in the strata). The difference (<code>diffFreq</code>) between coverage frequency and sampling frequency determines whether the values are over-represented (positive numbers) or under-represented (negative numbers). This value translates to a discrete <code>need</code> attribute that defines whether there is a need to add or remove samples to meet the number of samples necessary to be considered representative of the strata inputted in <code>sraster</code>.</p>
<p>Performing the algorithm on a sample set derived using <code><a href="../reference/sample_strat.html">sample_strat()</a></code> exhibits proportional sampling to strata coverage.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/calculate_representation.html">calculate_representation</a></span><span class="op">(</span>sraster <span class="op">=</span> <span class="va">sraster</span>,</span>
<span>                         existing <span class="op">=</span> <span class="va">existing</span>,</span>
<span>                         plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="calculating_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 6</span></span></span>
<span><span class="co">#&gt;   strata srasterFreq sampleFreq diffFreq nSamp  need</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>      1        0.25       0.25        0    50     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>      2        0.25       0.25        0    50     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>      3        0.25       0.25        0    50     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>      4        0.25       0.25        0    50     0</span></span></code></pre>
<p>Presence of very small (negligible) differences between <code>srasterFreq</code> and <code>sampleFreq</code> is common. <strong>In these situations, it is important for the user to determine whether to add or remove the samples.</strong></p>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="dist">
<code>calculate_distance</code><a class="anchor" aria-label="anchor" href="#dist"></a>
</h2>
<p><code><a href="../reference/calculate_distance.html">calculate_distance()</a></code> function takes the input <code>raster</code> and <code>access</code> data and outputs the per pixel distance to the nearest access point. This function has a specific value for constraining the sampling protocols, such as the <code><a href="../reference/sample_clhs.html">sample_clhs()</a></code> function, where the output raster layer can be used as the <code>cost</code> for the constraint. The output raster consists of the input appended with the calculated distance layer (<code>dist2access</code>).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/calculate_distance.html">calculate_distance</a></span><span class="op">(</span>raster <span class="op">=</span> <span class="va">sraster</span>, <span class="co"># input</span></span>
<span>                   access <span class="op">=</span> <span class="va">access</span>, <span class="co"># define access road network</span></span>
<span>                   plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># plot</span></span></code></pre></div>
<p><img src="calculating_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; class       : SpatRaster </span></span>
<span><span class="co">#&gt; dimensions  : 277, 373, 2  (nrow, ncol, nlyr)</span></span>
<span><span class="co">#&gt; resolution  : 20, 20  (x, y)</span></span>
<span><span class="co">#&gt; extent      : 431100, 438560, 5337700, 5343240  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">#&gt; coord. ref. : UTM Zone 17, Northern Hemisphere </span></span>
<span><span class="co">#&gt; sources     : memory  </span></span>
<span><span class="co">#&gt;               memory  </span></span>
<span><span class="co">#&gt; names       :      strata, dist2access </span></span>
<span><span class="co">#&gt; min values  : 1.000000000, 0.006621213 </span></span>
<span><span class="co">#&gt; max values  :        4.00,     1061.66</span></span></code></pre>
<p><em>Access network polygons with a large number of features and/or large spatial extent could result in slow processing times.</em></p>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="calculate_pcomp">
<code>calculate_pcomp</code><a class="anchor" aria-label="anchor" href="#calculate_pcomp"></a>
</h2>
<p><code><a href="../reference/calculate_pcomp.html">calculate_pcomp()</a></code> function takes <code>mraster</code> as the input and performs principal component analysis. The number of components defined by the <code>nComp</code> parameter specifies the number of components that will be rasterized onto the output.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/calculate_pcomp.html">calculate_pcomp</a></span><span class="op">(</span>mraster <span class="op">=</span> <span class="va">mraster</span>, <span class="co"># input</span></span>
<span>                nComp <span class="op">=</span> <span class="fl">3</span>, <span class="co"># number of components to output</span></span>
<span>                plot <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># plot</span></span>
<span>                details <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># details about the principal component analysis appended</span></span></code></pre></div>
<p><img src="calculating_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; $pca</span></span>
<span><span class="co">#&gt; Standard deviations (1, .., p=3):</span></span>
<span><span class="co">#&gt; [1] 1.5479878 0.7359109 0.2493371</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Rotation (n x k) = (3 x 3):</span></span>
<span><span class="co">#&gt;                PC1        PC2        PC3</span></span>
<span><span class="co">#&gt; zq90     0.6286296 -0.1795433 -0.7566961</span></span>
<span><span class="co">#&gt; pzabove2 0.5104140  0.8293596  0.2272450</span></span>
<span><span class="co">#&gt; zsd      0.5867729 -0.5290812  0.6130014</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $raster</span></span>
<span><span class="co">#&gt; class       : SpatRaster </span></span>
<span><span class="co">#&gt; dimensions  : 277, 373, 3  (nrow, ncol, nlyr)</span></span>
<span><span class="co">#&gt; resolution  : 20, 20  (x, y)</span></span>
<span><span class="co">#&gt; extent      : 431100, 438560, 5337700, 5343240  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">#&gt; coord. ref. : UTM Zone 17, Northern Hemisphere </span></span>
<span><span class="co">#&gt; sources     : memory  </span></span>
<span><span class="co">#&gt;               memory  </span></span>
<span><span class="co">#&gt;               memory  </span></span>
<span><span class="co">#&gt; names       :       PC1,       PC2,       PC3 </span></span>
<span><span class="co">#&gt; min values  : -4.402269, -5.357801, -1.446156 </span></span>
<span><span class="co">#&gt; max values  :  5.282663,  2.155242,  1.510955</span></span></code></pre>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="calculate_sampsize">
<code>calculate_sampsize</code><a class="anchor" aria-label="anchor" href="#calculate_sampsize"></a>
</h2>
<p><code><a href="../reference/calculate_sampsize.html">calculate_sampsize()</a></code> function allows the user to estimate an appropriate sample size using the relative standard error (<code>rse</code>) of input metrics. If the input <code>mraster</code> contains multiple layers, the sample sizes will be determined for all layers. If <code>plot = TRUE</code> and <code>rse</code> is defined, a sequence of <code>rse</code> values will be visualized with the indicators and the values for the matching sample size.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- determine sample size based on relative standard error (rse) of 1% ---#</span></span>
<span><span class="fu"><a href="../reference/calculate_sampsize.html">calculate_sampsize</a></span><span class="op">(</span>mraster <span class="op">=</span> <span class="va">mraster</span>,</span>
<span>                   rse <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span></span>
<span><span class="co">#&gt;   nSamp  rse      var</span></span>
<span><span class="co">#&gt; 1  1394 0.01     zq90</span></span>
<span><span class="co">#&gt; 2  1341 0.01 pzabove2</span></span>
<span><span class="co">#&gt; 3  1859 0.01      zsd</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- change default threshold sequence values ---# </span></span>
<span><span class="co">#--- if increment and rse are not divisible the closest value will be taken ---#</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_sampsize.html">calculate_sampsize</a></span><span class="op">(</span>mraster <span class="op">=</span> <span class="va">mraster</span>,</span>
<span>                   rse <span class="op">=</span> <span class="fl">0.025</span>,</span>
<span>                   start <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>                   end <span class="op">=</span> <span class="fl">0.08</span>,</span>
<span>                   increment <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>                   plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'rse' not perfectly divisible by 'increment'. Selecting closest sample size (rse = 0.03) based on values.</span></span>
<span></span>
<span><span class="va">p</span></span>
<span><span class="co">#&gt; $nSamp</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 3</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   var [3]</span></span></span>
<span><span class="co">#&gt;   nSamp   rse var     </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>   157  0.03 zq90    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>   151  0.03 pzabove2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>   211  0.03 zsd     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $plot</span></span></code></pre></div>
<p><img src="calculating_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="calculate_allocation">
<code>calculate_allocation</code><a class="anchor" aria-label="anchor" href="#calculate_allocation"></a>
</h2>
<p><code><a href="../reference/calculate_allocation.html">calculate_allocation()</a></code> function determines how to allocate samples based on the desired number of samples (<code>nSamp</code>) and the input <code>sraster</code>. This function is used internally in a number of functions, including <a href="#strat"><code>sample_strat</code></a>. Currently, there are three methods for allocations included: proportional (<code>prop</code>; default), optimal (<code>optim</code>), equal (<code>equal</code>), and manual (<code>manual</code>) allocation.</p>
<ul>
<li>Proportional - Samples are allocated based on the coverage area of the strata. This is the default allocation method.</li>
<li>Optimal - Samples are allocated based on the variation within the strata.</li>
<li>Equal - Same number of samples ( defined by <code>nSamp</code>) are allocated to each strata.</li>
<li>Manual - Numeric vector <code>weights</code> is provided allowing users to manually assign weights to strata.</li>
</ul>
<div class="section level3 unnumbered">
<h3 class="unnumbered" id="proportional">Proportional allocation<a class="anchor" aria-label="anchor" href="#proportional"></a>
</h3>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- perform grid sampling ---#</span></span>
<span><span class="fu"><a href="../reference/calculate_allocation.html">calculate_allocation</a></span><span class="op">(</span>sraster <span class="op">=</span> <span class="va">sraster</span>, </span>
<span>                     nSamp <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span>
<span><span class="co">#&gt;   strata total</span></span>
<span><span class="co">#&gt; 1      1    50</span></span>
<span><span class="co">#&gt; 2      2    50</span></span>
<span><span class="co">#&gt; 3      3    50</span></span>
<span><span class="co">#&gt; 4      4    50</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- calculate existing samples to include ---#</span></span>
<span><span class="va">e.sr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_strata.html">extract_strata</a></span><span class="op">(</span>sraster <span class="op">=</span> <span class="va">sraster</span>, </span>
<span>                       existing <span class="op">=</span> <span class="va">existing</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/calculate_allocation.html">calculate_allocation</a></span><span class="op">(</span>sraster <span class="op">=</span> <span class="va">sraster</span>, </span>
<span>                     nSamp <span class="op">=</span> <span class="fl">200</span>, </span>
<span>                     existing <span class="op">=</span> <span class="va">e.sr</span><span class="op">)</span></span>
<span><span class="co">#&gt;   strata total need</span></span>
<span><span class="co">#&gt; 1      1     0   50</span></span>
<span><span class="co">#&gt; 2      2     0   50</span></span>
<span><span class="co">#&gt; 3      3     0   50</span></span>
<span><span class="co">#&gt; 4      4     0   50</span></span></code></pre></div>
<p>Notice that some of the values under <code>total</code> from the result above are negative. The negative value indicates that the <code>existing</code> samples over represent those strata and that some of the samples could removed to prevent over-representation. <code>$total</code> indicates the number of samples that could be added or removed.</p>
</div>
<div class="section level3 unnumbered">
<h3 class="unnumbered" id="optimal">Optimal Allocation<a class="anchor" aria-label="anchor" href="#optimal"></a>
</h3>
<p>Optimal allocation method uses the variation within the strata metric to allocate samples. This means that in addition to providing and <code>sraster</code>, that a specific metric (<code>mraster</code>) must be provided to calculate variation to optimally allocate samples.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/calculate_allocation.html">calculate_allocation</a></span><span class="op">(</span>sraster <span class="op">=</span> <span class="va">sraster</span>, <span class="co"># stratified raster</span></span>
<span>                     nSamp <span class="op">=</span> <span class="fl">200</span>, <span class="co"># desired sample number</span></span>
<span>                     existing <span class="op">=</span> <span class="va">e.sr</span>, <span class="co">#existing samples</span></span>
<span>                     allocation <span class="op">=</span> <span class="st">"optim"</span>, <span class="co"># optimal allocation</span></span>
<span>                     mraster <span class="op">=</span> <span class="va">mraster</span><span class="op">$</span><span class="va">zq90</span>, <span class="co"># metric raster</span></span>
<span>                     force <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># force nSamp number</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 3</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Rowwise: </span></span></span>
<span><span class="co">#&gt;   strata total  need</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>      1    27    77</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>      2   -<span style="color: #BB0000;">14</span>    36</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>      3   -<span style="color: #BB0000;">25</span>    25</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>      4    12    63</span></span></code></pre></div>
</div>
<div class="section level3 unnumbered">
<h3 class="unnumbered" id="equal">Equal allocation<a class="anchor" aria-label="anchor" href="#equal"></a>
</h3>
<p>There may be situations where the user wants to have the same number of samples allocated to each strata. In these situations use <code>allocation = equal</code>. In this case, <code>nSamp</code> refers to the total number of samples per strata, instead of the overall total number of samples.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/calculate_allocation.html">calculate_allocation</a></span><span class="op">(</span>sraster <span class="op">=</span> <span class="va">sraster</span>, <span class="co"># stratified raster</span></span>
<span>                     nSamp <span class="op">=</span> <span class="fl">20</span>, <span class="co"># desired sample number</span></span>
<span>                     allocation <span class="op">=</span> <span class="st">"equal"</span><span class="op">)</span> <span class="co"># optimal allocation</span></span>
<span><span class="co">#&gt; Implementing equal allocation of samples.</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 2</span></span></span>
<span><span class="co">#&gt;   strata total</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>      1    20</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>      2    20</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>      3    20</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>      4    20</span></span></code></pre></div>
<p>The code in the demonstration above yields a total of 80 samples (20 <code>nSamp</code> for each of the 4 strata in <code>sraster</code>).</p>
</div>
<div class="section level3 unnumbered">
<h3 class="unnumbered" id="manual">Manual allocation<a class="anchor" aria-label="anchor" href="#manual"></a>
</h3>
<p>The user may wish to manually assign weights to strata. In this case, <code>allocation = manual</code> can be used and <code>weights</code> must be provided as a numeric vector (e.g. <code>weights = c(0.2, 0.2, 0.2, 0.4)</code> where <code>sum(weights) == 1</code>). In this case, <code>nSamp</code> will be allocated based on <code>weights</code>.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weights</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.4</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/calculate_allocation.html">calculate_allocation</a></span><span class="op">(</span>sraster <span class="op">=</span> <span class="va">sraster</span>, <span class="co"># stratified raster</span></span>
<span>                     nSamp <span class="op">=</span> <span class="fl">20</span>, <span class="co"># desired sample number</span></span>
<span>                     allocation <span class="op">=</span> <span class="st">"manual"</span>, <span class="co"># manual allocation</span></span>
<span>                     weights <span class="op">=</span> <span class="va">weights</span><span class="op">)</span> <span class="co"># weights adding to 1</span></span>
<span><span class="co">#&gt; Implementing allocation of samples based on user-defined weights.</span></span>
<span><span class="co">#&gt;   strata total</span></span>
<span><span class="co">#&gt; 1      1     4</span></span>
<span><span class="co">#&gt; 2      2     4</span></span>
<span><span class="co">#&gt; 3      3     4</span></span>
<span><span class="co">#&gt; 4      4     8</span></span></code></pre></div>
<p>The code in the demonstration above yields a total of 20 samples with plots being allocated based on the <code>weights</code> provided in ascending strata order.</p>
</div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="sampeval">Sample evaluation algorithms<a class="anchor" aria-label="anchor" href="#sampeval"></a>
</h2>
<p>The following algorithms were initially developed by Dr. Brendan Malone from the University of Sydney. Dr. Brendan Malone and his colleagues graciously supplied an in depth description of the functionality of these algorithms, which were originally developed to improve soil sampling strategies. These functions were modified and implemented to be used for structurally guided sampling approaches. Many thanks to Dr. Malone for his excellent collaboration and being a proponent of open source algorithms.</p>
<p>Please consult the original reference for these scripts and ideas as their paper holds extremely helpful and valuable information to understand their rationale for sampling and algorithm development.</p>
<p><em>Malone BP, Minansy B, Brungard C. 2019. Some methods to improve the utility of conditioned Latin hypercube sampling. PeerJ 7:e6451 DOI 10.7717/peerj.6451</em></p>
<div class="section level3 unnumbered">
<h3 class="unnumbered" id="coobs">
<code>calculate_coobs</code><a class="anchor" aria-label="anchor" href="#coobs"></a>
</h3>
<p><code><a href="../reference/calculate_coobs.html">calculate_coobs()</a></code> function performs the COunt of OBServations (coobs) algorithm using <code>existing</code> sample data and <code>mraster</code> covariates. This algorithm helps the user understand how the <code>existing</code> sample data set is distributed among the landscape in relation to the <code>mraster</code> covariates. The output coobs raster can be used to constrain clhs sampling using the <code><a href="../reference/sample_clhs.html">sample_clhs()</a></code> function to the areas that are under-represented.</p>
<p>The coobs raster determines how many observations are similar in terms of the covariate space at every pixel. This function takes advantage of parallel processing routines.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/calculate_coobs.html">calculate_coobs</a></span><span class="op">(</span>mraster <span class="op">=</span> <span class="va">mraster</span>, <span class="co"># input</span></span>
<span>                existing <span class="op">=</span> <span class="va">existing</span>, <span class="co"># existing samples</span></span>
<span>                cores <span class="op">=</span> <span class="fl">4</span>, <span class="co"># parallel cores to use</span></span>
<span>                details <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># provide details from algorithm output</span></span>
<span>                plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># plot</span></span></code></pre></div>
</div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="lhseval">Latin hypercube sampling evaluation algorithms<a class="anchor" aria-label="anchor" href="#lhseval"></a>
</h2>
<p>The following 2 algorithms presents the means to maximize the effectiveness of the <a href="#clhs">latin hypercube sampling</a> protocols.</p>
<div class="section level3 unnumbered">
<h3 class="unnumbered" id="lhspop">
<code>calculate_pop</code><a class="anchor" aria-label="anchor" href="#lhspop"></a>
</h3>
<p><code><a href="../reference/calculate_pop.html">calculate_pop()</a></code> function calculates population level statistics of the <code>mraster</code> covariates that are being used, which includes calculating the principal components, quantile &amp; covariate distributions, and Kullback-Leibler divergence testing. The outputs produced from this functions are required to use the <code><a href="../reference/calculate_lhsOpt.html">calculate_lhsOpt()</a></code> function described in the following section. Additionally, this algorithm can be pre-emptively used to calculate <code>matQ</code> and <code>MatCov</code>, two values that are used for the <code><a href="../reference/sample_ahels.html">sample_ahels()</a></code> function. This will save processing time during sampling.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- by default all statistical data are calculated ---#</span></span>
<span><span class="fu"><a href="../reference/calculate_pop.html">calculate_pop</a></span><span class="op">(</span>mraster <span class="op">=</span> <span class="va">mraster</span><span class="op">)</span> <span class="co"># input </span></span></code></pre></div>
<p>The output list contains the following:</p>
<ul>
<li><p><code>$values</code> - Pixel values from <code>mraster</code></p></li>
<li><p><code>$pcaLoad</code> - PCA loadings</p></li>
<li><p><code>$matQ</code> - Quantile matrix</p></li>
<li><p><code>$matCov</code> - Covariate matrix</p></li>
</ul>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- statistical analyses can be chosen by setting their parameter to `FALSE` ---#</span></span>
<span><span class="va">mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_pop.html">calculate_pop</a></span><span class="op">(</span>mraster <span class="op">=</span> <span class="va">mraster</span>, <span class="co"># input</span></span>
<span>                     nQuant <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="co"># desired number of quantiles</span></span>
<span></span>
<span><span class="co">#--- use matrix output within sample ahels algorithm ---#</span></span>
<span><span class="fu"><a href="../reference/sample_ahels.html">sample_ahels</a></span><span class="op">(</span>mraster <span class="op">=</span> <span class="va">mraster</span>, </span>
<span>             existing <span class="op">=</span> <span class="va">existing</span>, </span>
<span>             nQuant <span class="op">=</span> <span class="fl">10</span>, </span>
<span>             nSamp <span class="op">=</span> <span class="fl">50</span>,</span>
<span>             matCov <span class="op">=</span> <span class="va">mat</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3 unnumbered">
<h3 class="unnumbered" id="lhsopt">
<code>calculate_lhsOpt</code><a class="anchor" aria-label="anchor" href="#lhsopt"></a>
</h3>
<p><code><a href="../reference/calculate_lhsOpt.html">calculate_lhsOpt()</a></code> function performs a bootstrapped latin hypercube sampling approach where population level analysis of <code>mraster</code> data is performed to determine the optimal latin hypercube sample size.</p>
<p>Using data calculated using the <code><a href="../reference/calculate_pop.html">calculate_pop()</a></code> and varying sample sizes defined by <code>minSamp</code>, <code>maxSamp</code>, <code>step</code> and <code>rep</code>. Sampling protocols are conducted and statistical effectiveness of those sampling outcomes are evaluated to determine where sample size is minimized and statistical representation is maximized.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- calculate lhsPop details ---#</span></span>
<span><span class="va">poplhs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_pop.html">calculate_pop</a></span><span class="op">(</span>mraster <span class="op">=</span> <span class="va">mr</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/calculate_lhsOpt.html">calculate_lhsOpt</a></span><span class="op">(</span>popLHS <span class="op">=</span> <span class="va">poplhs</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/calculate_lhsOpt.html">calculate_lhsOpt</a></span><span class="op">(</span>popLHS <span class="op">=</span> <span class="va">poplhs</span>, </span>
<span>                 PCA <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>                 iter <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://scholar.google.ca/citations?user=C_qdYDsAAAAJ&amp;hl=en" class="external-link">Tristan RH Goodbody</a>, <a href="https://forestry.ubc.ca/faculty-profile/nicholas-coops/" class="external-link">Nicholas C Coops</a>, <a href="https://www.researchgate.net/profile/Martin-Queinnec" class="external-link">Martin Queinnec</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
