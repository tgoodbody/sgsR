<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Stratification â€¢ sgsR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Stratification">
<meta name="description" content="Learn how to use strat* functions.
">
<meta property="og:description" content="Learn how to use strat* functions.
">
<meta property="og:image" content="/reference/figures/logo.png">
<!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-115082821-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-115082821-1');
</script><script defer data-domain="pkgdown.r-lib.org,all.tidyverse.org" src="https://plausible.io/js/plausible.js"></script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">sgsR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.5.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/sgsR.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/calculating.html">Calculating</a></li>
    <li><a class="dropdown-item" href="../articles/sampling.html">Sampling</a></li>
    <li><a class="dropdown-item" href="../articles/stratification.html">Stratification</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/tgoodbody/sgsR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Stratification</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/tgoodbody/sgsR/blob/v1.5.0/vignettes/stratification.Rmd" class="external-link"><code>vignettes/stratification.Rmd</code></a></small>
      <div class="d-none name"><code>stratification.Rmd</code></div>
    </div>

    
    
<style type="text/css">
.infobox {
  padding: 1em 1em 1em 4em;
  margin-bottom: 10px;
  border: 2px solid #43602d;
  border-radius: 10px;
  background: #738e41 5px center/3em no-repeat;
}

.caution {
  background-image: url("https://tgoodbody.github.io/sgsR/logo.png");
}

</style>
<p>Fundamental to many structurally guided sampling approaches is the
use of stratification methods that allow for more effective and
representative sampling protocols. It is important to note that the data
sets being used as inputs are considered to be populations.</p>
<p>Currently, there are 5 functions associated with the
<code>strat</code> verb in the <code>sgsR</code> package:</p>
<table style="width:100%;" class="table">
<colgroup>
<col width="33%">
<col width="44%">
<col width="22%">
</colgroup>
<thead><tr class="header">
<th align="center">Algorithm</th>
<th align="center">Description</th>
<th align="center">Approach</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center"><a href="#kmeans"><code>strat_kmeans()</code></a></td>
<td align="center">kmeans</td>
<td align="center">Unsupervised</td>
</tr>
<tr class="even">
<td align="center"><a href="#quantiles"><code>strat_quantiles()</code></a></td>
<td align="center">Quantiles</td>
<td align="center">Either</td>
</tr>
<tr class="odd">
<td align="center"><a href="#breaks"><code>strat_breaks()</code></a></td>
<td align="center">User-defined breaks</td>
<td align="center">Supervised</td>
</tr>
<tr class="even">
<td align="center"><a href="#poly"><code>strat_poly()</code></a></td>
<td align="center">Polygons</td>
<td align="center">Supervised</td>
</tr>
<tr class="odd">
<td align="center"><a href="#map"><code>strat_map()</code></a></td>
<td align="center">Maps (combines) <code>srasters</code>
</td>
<td align="center">Unsupervised</td>
</tr>
</tbody>
</table>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="kmeans">
<code>strat_kmeans</code><a class="anchor" aria-label="anchor" href="#kmeans"></a>
</h2>
<p><code><a href="../reference/strat_kmeans.html">strat_kmeans()</a></code> uses kmeans clustering to produce an
<code>sraster</code> output.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- perform stratification using k-means ---#</span></span>
<span><span class="fu"><a href="../reference/strat_kmeans.html">strat_kmeans</a></span><span class="op">(</span></span>
<span>  mraster <span class="op">=</span> <span class="va">mraster</span>, <span class="co"># input</span></span>
<span>  nStrata <span class="op">=</span> <span class="fl">5</span></span>
<span><span class="op">)</span> <span class="co"># algorithm will produce 4 strata</span></span>
<span><span class="co">#&gt; class       : SpatRaster </span></span>
<span><span class="co">#&gt; size        : 277, 373, 1  (nrow, ncol, nlyr)</span></span>
<span><span class="co">#&gt; resolution  : 20, 20  (x, y)</span></span>
<span><span class="co">#&gt; extent      : 431100, 438560, 5337700, 5343240  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">#&gt; coord. ref. : UTM Zone 17, Northern Hemisphere </span></span>
<span><span class="co">#&gt; source(s)   : memory</span></span>
<span><span class="co">#&gt; varname     : mraster </span></span>
<span><span class="co">#&gt; name        : strata </span></span>
<span><span class="co">#&gt; min value   :      1 </span></span>
<span><span class="co">#&gt; max value   :      5</span></span></code></pre></div>
<div class="infobox caution">
<p><strong>TIP!</strong></p>
<p><code>plot = FALSE</code> is the default for all functions.
<code>plot = TRUE</code> will visualize raster and vector ouputs.</p>
</div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/strat_kmeans.html">strat_kmeans</a></span><span class="op">(</span></span>
<span>  mraster <span class="op">=</span> <span class="va">mraster</span>, <span class="co"># input</span></span>
<span>  nStrata <span class="op">=</span> <span class="fl">10</span>, <span class="co"># algorithm will produce 10 strata</span></span>
<span>  iter <span class="op">=</span> <span class="fl">1000</span>, <span class="co"># set minimum number of iterations to determine kmeans centers</span></span>
<span>  algorithm <span class="op">=</span> <span class="st">"MacQueen"</span>, <span class="co"># use MacQueen algorithm</span></span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span> <span class="co"># plot output</span></span></code></pre></div>
<p><img src="stratification_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; class       : SpatRaster </span></span>
<span><span class="co">#&gt; size        : 277, 373, 1  (nrow, ncol, nlyr)</span></span>
<span><span class="co">#&gt; resolution  : 20, 20  (x, y)</span></span>
<span><span class="co">#&gt; extent      : 431100, 438560, 5337700, 5343240  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">#&gt; coord. ref. : UTM Zone 17, Northern Hemisphere </span></span>
<span><span class="co">#&gt; source(s)   : memory</span></span>
<span><span class="co">#&gt; varname     : mraster </span></span>
<span><span class="co">#&gt; name        : strata </span></span>
<span><span class="co">#&gt; min value   :      1 </span></span>
<span><span class="co">#&gt; max value   :     10</span></span></code></pre>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="quantiles">
<code>strat_quantiles</code><a class="anchor" aria-label="anchor" href="#quantiles"></a>
</h2>
<p>The <code><a href="../reference/strat_quantiles.html">strat_quantiles()</a></code> algorithm divides data into
equally sized strata (<code>nStrata</code>). Similar to
<code><a href="../reference/strat_breaks.html">strat_breaks()</a></code>, this function is vectorized to allow users
to input any number of metrics to stratify (<code>mraster</code>) so
long as <code>nStrata</code> is a list containing a matching number of
numeric objects. <code>nStrata</code> can be either <code>nStrata</code>
can be either a scalar integer representing the number of desired output
strata, or a numeric vector of probabilities between 0-1 demarcating
quantile break points. The <code>nStrata</code> list can be a mix of
these (e.g.Â <code>nStrata = list(c(0.1,0.8,1), 4, 9)</code> where
<code>mraster</code> would have 3 layers) to allow users to define both
explicit quantile breaks or a desired strata number that is converted to
quantiles breaks internally. Specifying <code>map = TRUE</code> will
combine (map) stratifications of all input <code>mraster</code> layers
to produce a combined stratified output.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- perform quantiles stratification ---#</span></span>
<span><span class="fu"><a href="../reference/strat_quantiles.html">strat_quantiles</a></span><span class="op">(</span></span>
<span>  mraster <span class="op">=</span> <span class="va">mraster</span><span class="op">$</span><span class="va">zq90</span>,</span>
<span>  nStrata <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="stratification_files/figure-html/unnamed-chunk-7-1.png" width="700"><img src="stratification_files/figure-html/unnamed-chunk-7-2.png" width="700"></p>
<pre><code><span><span class="co">#&gt; class       : SpatRaster </span></span>
<span><span class="co">#&gt; size        : 277, 373, 1  (nrow, ncol, nlyr)</span></span>
<span><span class="co">#&gt; resolution  : 20, 20  (x, y)</span></span>
<span><span class="co">#&gt; extent      : 431100, 438560, 5337700, 5343240  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">#&gt; coord. ref. : UTM Zone 17, Northern Hemisphere </span></span>
<span><span class="co">#&gt; source(s)   : memory</span></span>
<span><span class="co">#&gt; varname     : mraster </span></span>
<span><span class="co">#&gt; name        : strata </span></span>
<span><span class="co">#&gt; min value   :      1 </span></span>
<span><span class="co">#&gt; max value   :      6</span></span>
<span></span>
<span><span class="co">#--- vectorized ---#</span></span>
<span><span class="fu"><a href="../reference/strat_quantiles.html">strat_quantiles</a></span><span class="op">(</span></span>
<span>  mraster <span class="op">=</span> <span class="va">mraster</span><span class="op">[[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, <span class="co"># two metric layers</span></span>
<span>  nStrata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.4</span>, <span class="fl">0.8</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>, <span class="co"># list with two objects - 1 probability breaks, 1 scalar integer</span></span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># plot output srasters</span></span>
<span>  map <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span> <span class="co"># combine stratifications to a mapped output</span></span></code></pre>
<p><img src="stratification_files/figure-html/unnamed-chunk-7-3.png" width="700"><img src="stratification_files/figure-html/unnamed-chunk-7-4.png" width="700"></p>
<pre><code><span><span class="co">#&gt; class       : SpatRaster </span></span>
<span><span class="co">#&gt; size        : 277, 373, 3  (nrow, ncol, nlyr)</span></span>
<span><span class="co">#&gt; resolution  : 20, 20  (x, y)</span></span>
<span><span class="co">#&gt; extent      : 431100, 438560, 5337700, 5343240  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">#&gt; coord. ref. : UTM Zone 17, Northern Hemisphere </span></span>
<span><span class="co">#&gt; source(s)   : memory</span></span>
<span><span class="co">#&gt; varnames    : mraster </span></span>
<span><span class="co">#&gt;               mraster </span></span>
<span><span class="co">#&gt;               mraster </span></span>
<span><span class="co">#&gt; names       : strata_zq90, strata_pzabove2, strata </span></span>
<span><span class="co">#&gt; min values  :           1,               1,      1 </span></span>
<span><span class="co">#&gt; max values  :           4,               3,     12</span></span></code></pre>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="breaks">
<code>strat_breaks</code><a class="anchor" aria-label="anchor" href="#breaks"></a>
</h2>
<p><code><a href="../reference/strat_breaks.html">strat_breaks()</a></code> stratifies data based on user-defined
breaks in <code>mraster</code>. This algorithm is vectorized. The user
can provide an <code>mraster</code> with as many layers as they wish as
long as the <code>breaks</code> parameters is a list of equal length
comprised of numeric vectors. Like <code><a href="../reference/strat_quantiles.html">strat_quantiles()</a></code> this
function has the <code>map</code> parameter to combine input
stratifications to generate a mapped output.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- perform stratification using user-defined breaks ---#</span></span>
<span></span>
<span><span class="co">#--- define breaks for metric ---#</span></span>
<span><span class="va">br.pz2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">40</span>, <span class="fl">60</span>, <span class="fl">80</span><span class="op">)</span></span>
<span></span>
<span><span class="va">br.pz2</span></span>
<span><span class="co">#&gt; [1] 20 40 60 80</span></span>
<span></span>
<span><span class="co">#--- perform stratification using user-defined breaks ---#</span></span>
<span></span>
<span><span class="co">#--- define breaks for metric ---#</span></span>
<span><span class="va">br.zq90</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">5</span>, <span class="fl">11</span>, <span class="fl">18</span><span class="op">)</span></span>
<span></span>
<span><span class="va">br.zq90</span></span>
<span><span class="co">#&gt; [1]  3  5 11 18</span></span></code></pre></div>
<p>Once the breaks are created, we can use them as input into the
<code><a href="../reference/strat_breaks.html">strat_breaks()</a></code> function using the <code>breaks</code>
parameter.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- stratify on 1 metric only ---#</span></span>
<span><span class="fu"><a href="../reference/strat_breaks.html">strat_breaks</a></span><span class="op">(</span></span>
<span>  mraster <span class="op">=</span> <span class="va">mraster</span><span class="op">$</span><span class="va">pzabove2</span>, <span class="co"># single raster</span></span>
<span>  breaks <span class="op">=</span> <span class="va">br.pz2</span>, <span class="co"># single set of breaks</span></span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span> <span class="co"># plot output</span></span></code></pre></div>
<p><img src="stratification_files/figure-html/unnamed-chunk-9-1.png" width="700"><img src="stratification_files/figure-html/unnamed-chunk-9-2.png" width="700"></p>
<pre><code><span><span class="co">#&gt; class       : SpatRaster </span></span>
<span><span class="co">#&gt; size        : 277, 373, 1  (nrow, ncol, nlyr)</span></span>
<span><span class="co">#&gt; resolution  : 20, 20  (x, y)</span></span>
<span><span class="co">#&gt; extent      : 431100, 438560, 5337700, 5343240  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">#&gt; coord. ref. : UTM Zone 17, Northern Hemisphere </span></span>
<span><span class="co">#&gt; source(s)   : memory</span></span>
<span><span class="co">#&gt; varname     : mraster </span></span>
<span><span class="co">#&gt; name        : strata </span></span>
<span><span class="co">#&gt; min value   :      1 </span></span>
<span><span class="co">#&gt; max value   :      5</span></span></code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- vectorized ---#</span></span>
<span><span class="fu"><a href="../reference/strat_breaks.html">strat_breaks</a></span><span class="op">(</span></span>
<span>  mraster <span class="op">=</span> <span class="va">mraster</span><span class="op">[[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, <span class="co"># two metrics</span></span>
<span>  breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">br.zq90</span>, <span class="va">br.pz2</span><span class="op">)</span>, <span class="co"># list of two breaks vectors</span></span>
<span>  map <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># map final output</span></span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span> <span class="co"># plot outputs</span></span></code></pre></div>
<p><img src="stratification_files/figure-html/unnamed-chunk-10-1.png" width="700"><img src="stratification_files/figure-html/unnamed-chunk-10-2.png" width="700"></p>
<pre><code><span><span class="co">#&gt; class       : SpatRaster </span></span>
<span><span class="co">#&gt; size        : 277, 373, 3  (nrow, ncol, nlyr)</span></span>
<span><span class="co">#&gt; resolution  : 20, 20  (x, y)</span></span>
<span><span class="co">#&gt; extent      : 431100, 438560, 5337700, 5343240  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">#&gt; coord. ref. : UTM Zone 17, Northern Hemisphere </span></span>
<span><span class="co">#&gt; source(s)   : memory</span></span>
<span><span class="co">#&gt; varnames    : mraster </span></span>
<span><span class="co">#&gt;               mraster </span></span>
<span><span class="co">#&gt;               mraster </span></span>
<span><span class="co">#&gt; names       : strata_zq90, strata_pzabove2, strata </span></span>
<span><span class="co">#&gt; min values  :           1,               1,      1 </span></span>
<span><span class="co">#&gt; max values  :           5,               5,     22</span></span></code></pre>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="poly">
<code>strat_poly</code><a class="anchor" aria-label="anchor" href="#poly"></a>
</h2>
<p>Forest inventories with polygon coverages summarizing forest
attributes such as species, management type, or photo-interpreted
estimates of volume can be stratified using
<code><a href="../reference/strat_poly.html">strat_poly()</a></code>.</p>
<div class="infobox caution">
<p><strong>TIP!</strong></p>
<p>Users may wish to stratify based on categorical or empirical
variables that are not available through raster data (e.g.Â species from
forest inventory polygons).</p>
</div>
<p>Users define the input <code>poly</code> and its associated
<code>attribute</code>. A <code>raster</code> layer must be defined to
guide the spatial extent and resolution for the output stratification
polygon. Based on the vector or list of <code>features</code>,
stratification is applied and the polygon is rasterized into its
appropriate strata.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- load in polygon coverage ---#</span></span>
<span><span class="va">poly</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"inventory_polygons.shp"</span>, package <span class="op">=</span> <span class="st">"sgsR"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fri</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">st_read</a></span><span class="op">(</span><span class="va">poly</span><span class="op">)</span></span>
<span><span class="co">#&gt; Reading layer `inventory_polygons' from data source </span></span>
<span><span class="co">#&gt;   `/home/runner/work/_temp/Library/sgsR/extdata/inventory_polygons.shp' </span></span>
<span><span class="co">#&gt;   using driver `ESRI Shapefile'</span></span>
<span><span class="co">#&gt; Simple feature collection with 632 features and 3 fields</span></span>
<span><span class="co">#&gt; Geometry type: MULTIPOLYGON</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431100 ymin: 5337700 xmax: 438560 ymax: 5343240</span></span>
<span><span class="co">#&gt; Projected CRS: UTM_Zone_17_Northern_Hemisphere</span></span>
<span></span>
<span><span class="co">#--- specify polygon attribute to stratify ---#</span></span>
<span></span>
<span><span class="va">attribute</span> <span class="op">&lt;-</span> <span class="st">"NUTRIENTS"</span></span>
<span></span>
<span><span class="co">#--- specify features within attribute &amp; how they should be grouped ---#</span></span>
<span><span class="co">#--- as a single vector ---#</span></span>
<span></span>
<span><span class="va">features</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"poor"</span>, <span class="st">"rich"</span>, <span class="st">"medium"</span><span class="op">)</span></span></code></pre></div>
<p>In our example, <code>attribute = "NUTRIENTS"</code> and features
within, <code>c("poor", "rich", "medium")</code>, define the 3 desired
strata.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- stratify polygon coverage ---#</span></span>
<span></span>
<span><span class="va">srasterpoly</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/strat_poly.html">strat_poly</a></span><span class="op">(</span></span>
<span>  poly <span class="op">=</span> <span class="va">fri</span>, <span class="co"># input polygon</span></span>
<span>  attribute <span class="op">=</span> <span class="va">attribute</span>, <span class="co"># attribute to stratify by</span></span>
<span>  features <span class="op">=</span> <span class="va">features</span>, <span class="co"># features within attribute</span></span>
<span>  raster <span class="op">=</span> <span class="va">sraster</span>, <span class="co"># raster to define extent and resolution for output</span></span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span> <span class="co"># plot output</span></span></code></pre></div>
<p><img src="stratification_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
<p><code>features</code> can be grouped. In our example below,
<code>rich</code> and <code>medium</code> features are combined into a
single strata, while <code>low</code> is left in isolation. The 2
vectors are specified into a list, which will result in the output of 2
strata (low &amp; rich/medium).</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- or as multiple lists ---#</span></span>
<span><span class="va">g1</span> <span class="op">&lt;-</span> <span class="st">"poor"</span></span>
<span><span class="va">g2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rich"</span>, <span class="st">"medium"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">features</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">g1</span>, <span class="va">g2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/strat_poly.html">strat_poly</a></span><span class="op">(</span></span>
<span>  poly <span class="op">=</span> <span class="va">fri</span>,</span>
<span>  attribute <span class="op">=</span> <span class="va">attribute</span>,</span>
<span>  features <span class="op">=</span> <span class="va">features</span>,</span>
<span>  raster <span class="op">=</span> <span class="va">sraster</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  details <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="stratification_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; $raster</span></span>
<span><span class="co">#&gt; class       : SpatRaster </span></span>
<span><span class="co">#&gt; size        : 277, 373, 1  (nrow, ncol, nlyr)</span></span>
<span><span class="co">#&gt; resolution  : 20, 20  (x, y)</span></span>
<span><span class="co">#&gt; extent      : 431100, 438560, 5337700, 5343240  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">#&gt; coord. ref. : UTM Zone 17, Northern Hemisphere </span></span>
<span><span class="co">#&gt; source(s)   : memory</span></span>
<span><span class="co">#&gt; varname     : mraster </span></span>
<span><span class="co">#&gt; name        : strata </span></span>
<span><span class="co">#&gt; min value   :      1 </span></span>
<span><span class="co">#&gt; max value   :      2 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $lookUp</span></span>
<span><span class="co">#&gt;   strata features</span></span>
<span><span class="co">#&gt; 1      1     poor</span></span>
<span><span class="co">#&gt; 2      2     rich</span></span>
<span><span class="co">#&gt; 3      2   medium</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $poly</span></span>
<span><span class="co">#&gt;  class       : SpatVector </span></span>
<span><span class="co">#&gt;  geometry    : polygons </span></span>
<span><span class="co">#&gt;  dimensions  : 524, 2  (geometries, attributes)</span></span>
<span><span class="co">#&gt;  extent      : 431100, 438560, 5337700, 5343240  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">#&gt;  coord. ref. : UTM_Zone_17_Northern_Hemisphere </span></span>
<span><span class="co">#&gt;  names       : features strata</span></span>
<span><span class="co">#&gt;  type        :    &lt;chr&gt;  &lt;int&gt;</span></span>
<span><span class="co">#&gt;  values      :     poor      1</span></span>
<span><span class="co">#&gt;                    poor      1</span></span>
<span><span class="co">#&gt;                    poor      1</span></span></code></pre>
<div class="infobox caution">
<p><strong><code>details</code></strong></p>
<p><code>details</code> returns the output <code>outRaster</code>, the
stratification <code>$lookUp</code> table, and the polygon
(<code>$poly</code>) used to drive the stratification based on
attributes and features specified by the users.</p>
</div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="map">
<code>strat_map</code><a class="anchor" aria-label="anchor" href="#map"></a>
</h2>
<p>Users may wish to pair stratifications. <code><a href="../reference/strat_map.html">strat_map()</a></code>
facilitates vectorized mapping of <code>sraster</code> layers to
generate a unique mapped strata output based on stratum pairings. The
<code>stack</code> parameter will output a multilayer
<code>sraster</code> with the inputs
(<code>strata_1, strata_2 ...</code>) and mapped output
(<code>strata</code>).</p>
<p>This facilitates the user to generate stratifications detailing
quantitative and qualitative measures such as structure by species, or
multiple qualitative measures such as species by management type.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- stack srasters together ---#</span></span>
<span></span>
<span><span class="va">srasters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">srasterpoly</span>, <span class="va">sraster</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">srasters</span><span class="op">)</span></span></code></pre></div>
<p><img src="stratification_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- map srasters ---#</span></span>
<span><span class="fu"><a href="../reference/strat_map.html">strat_map</a></span><span class="op">(</span></span>
<span>  sraster <span class="op">=</span> <span class="va">srasters</span>, <span class="co"># two layer sraster</span></span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="stratification_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; class       : SpatRaster </span></span>
<span><span class="co">#&gt; size        : 277, 373, 1  (nrow, ncol, nlyr)</span></span>
<span><span class="co">#&gt; resolution  : 20, 20  (x, y)</span></span>
<span><span class="co">#&gt; extent      : 431100, 438560, 5337700, 5343240  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">#&gt; coord. ref. : UTM Zone 17, Northern Hemisphere </span></span>
<span><span class="co">#&gt; source(s)   : memory</span></span>
<span><span class="co">#&gt; varname     : mraster </span></span>
<span><span class="co">#&gt; name        : strata </span></span>
<span><span class="co">#&gt; min value   :     11 </span></span>
<span><span class="co">#&gt; max value   :     34</span></span></code></pre>
<p>The convention for the numeric value of the output strata is the
concatenation (merging) of <code>sraster</code> layers. Check
<code>$lookUP</code> for a clear depiction of this step.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/strat_map.html">strat_map</a></span><span class="op">(</span></span>
<span>  sraster <span class="op">=</span> <span class="va">srasters</span>, <span class="co"># input with 2 sraster layers</span></span>
<span>  stack <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># output stacked input (strata_1, strata_2) and output (strata) layers</span></span>
<span>  details <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># provide additional details</span></span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span> <span class="co"># plot output</span></span>
<span><span class="co">#&gt; Stacking srasters and their combination (strata).</span></span></code></pre></div>
<p><img src="stratification_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; $raster</span></span>
<span><span class="co">#&gt; class       : SpatRaster </span></span>
<span><span class="co">#&gt; size        : 277, 373, 3  (nrow, ncol, nlyr)</span></span>
<span><span class="co">#&gt; resolution  : 20, 20  (x, y)</span></span>
<span><span class="co">#&gt; extent      : 431100, 438560, 5337700, 5343240  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">#&gt; coord. ref. : UTM Zone 17, Northern Hemisphere </span></span>
<span><span class="co">#&gt; source(s)   : memory</span></span>
<span><span class="co">#&gt; varnames    : mraster </span></span>
<span><span class="co">#&gt;               mraster </span></span>
<span><span class="co">#&gt;               mraster </span></span>
<span><span class="co">#&gt; names       : strata_1, strata_2, strata </span></span>
<span><span class="co">#&gt; min values  :        1,        1,     11 </span></span>
<span><span class="co">#&gt; max values  :        3,        4,     34 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $lookUp</span></span>
<span><span class="co">#&gt;    strata_1 strata_2 strata</span></span>
<span><span class="co">#&gt; 1         1        1     11</span></span>
<span><span class="co">#&gt; 2         1        2     12</span></span>
<span><span class="co">#&gt; 3         1        3     13</span></span>
<span><span class="co">#&gt; 4         1        4     14</span></span>
<span><span class="co">#&gt; 5         2        1     21</span></span>
<span><span class="co">#&gt; 6         2        2     22</span></span>
<span><span class="co">#&gt; 7         2        3     23</span></span>
<span><span class="co">#&gt; 8         2        4     24</span></span>
<span><span class="co">#&gt; 9         3        1     31</span></span>
<span><span class="co">#&gt; 10        3        2     32</span></span>
<span><span class="co">#&gt; 11        3        3     33</span></span>
<span><span class="co">#&gt; 12        3        4     34</span></span></code></pre>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://scholar.google.ca/citations?user=C_qdYDsAAAAJ&amp;hl=en" class="external-link">Tristan RH Goodbody</a>, <a href="https://forestry.ubc.ca/faculty-profile/nicholas-coops/" class="external-link">Nicholas C Coops</a>, <a href="https://www.researchgate.net/profile/Martin-Queinnec" class="external-link">Martin Queinnec</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
