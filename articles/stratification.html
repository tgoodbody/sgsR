<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Learn how to use strat* functions.
">
<title>stratification • sgsR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="stratification">
<meta property="og:description" content="Learn how to use strat* functions.
">
<meta property="og:image" content="/reference/figures/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-115082821-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-115082821-1');
</script><script defer data-domain="pkgdown.r-lib.org,all.tidyverse.org" src="https://plausible.io/js/plausible.js"></script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">sgsR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.3.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/sgsR.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/calculating.html">calculating</a>
    <a class="dropdown-item" href="../articles/sampling.html">sampling</a>
    <a class="dropdown-item" href="../articles/stratification.html">stratification</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/tgoodbody/sgsR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>stratification</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/tgoodbody/sgsR/blob/HEAD/vignettes/stratification.Rmd" class="external-link"><code>vignettes/stratification.Rmd</code></a></small>
      <div class="d-none name"><code>stratification.Rmd</code></div>
    </div>

    
    
<p>Fundamental to many structurally guided sampling approaches is the
use of stratification methods that allow for more effective and
representative sampling protocols. Below, I will identify the
stratification methods included in <code>sgsR</code> and demonstrate
some worked examples for each functions.</p>
<p>Currently, there are 5 functions associated with the
<code>strat</code> verb in the <code>sgsR</code> package:</p>
<ul>
<li><p><code><a href="../reference/strat_kmeans.html">strat_kmeans()</a></code> - kmeans stratification</p></li>
<li><p><code><a href="../reference/strat_quantiles.html">strat_quantiles()</a></code>- quantile stratification</p></li>
<li><p><code><a href="../reference/strat_breaks.html">strat_breaks()</a></code> - user-defined break
stratification</p></li>
<li><p><code><a href="../reference/strat_poly.html">strat_poly()</a></code> - polygon attribute
stratification</p></li>
<li><p><code><a href="../reference/strat_map.html">strat_map()</a></code> - maps (combines) 2
stratifications</p></li>
</ul>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="kmeans">
<code>strat_kmeans</code><a class="anchor" aria-label="anchor" href="#kmeans"></a>
</h2>
<p>We will demonstrate a preliminary example of using the
<code><a href="../reference/strat_kmeans.html">strat_kmeans()</a></code> algorithm to prepare our
<code>sraster</code> input data and provide additional examples
below.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- perform stratification using k-means ---#</span></span>
<span><span class="fu"><a href="../reference/strat_kmeans.html">strat_kmeans</a></span><span class="op">(</span>mraster <span class="op">=</span> <span class="va">mraster</span>, <span class="co"># input</span></span>
<span>             nStrata <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="co"># algorithm will produce 4 strata</span></span>
<span><span class="co">#&gt; class       : SpatRaster </span></span>
<span><span class="co">#&gt; dimensions  : 277, 373, 1  (nrow, ncol, nlyr)</span></span>
<span><span class="co">#&gt; resolution  : 20, 20  (x, y)</span></span>
<span><span class="co">#&gt; extent      : 431100, 438560, 5337700, 5343240  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">#&gt; coord. ref. : UTM Zone 17, Northern Hemisphere </span></span>
<span><span class="co">#&gt; source      : memory </span></span>
<span><span class="co">#&gt; name        : strata </span></span>
<span><span class="co">#&gt; min value   :      1 </span></span>
<span><span class="co">#&gt; max value   :      5</span></span></code></pre></div>
<p>Notice that the code above did not plot anything. This is because
<code>plot = FALSE</code> is set as the default for all functions in the
<code>sgsR</code> package. Below, we will demonstrate examples where the
<code>plot = TRUE</code> was set.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/strat_kmeans.html">strat_kmeans</a></span><span class="op">(</span>mraster <span class="op">=</span> <span class="va">mraster</span>, <span class="co"># input</span></span>
<span>             nStrata <span class="op">=</span> <span class="fl">10</span>, <span class="co"># algorithm will produce 10 strata</span></span>
<span>             iter <span class="op">=</span> <span class="fl">1000</span>, <span class="co"># set minimum number of iterations to determine kmeans centers</span></span>
<span>             algorithm <span class="op">=</span> <span class="st">"MacQueen"</span>, <span class="co"># use MacQueen algorithm</span></span>
<span>             plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># plot output</span></span></code></pre></div>
<p><img src="stratification_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; class       : SpatRaster </span></span>
<span><span class="co">#&gt; dimensions  : 277, 373, 1  (nrow, ncol, nlyr)</span></span>
<span><span class="co">#&gt; resolution  : 20, 20  (x, y)</span></span>
<span><span class="co">#&gt; extent      : 431100, 438560, 5337700, 5343240  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">#&gt; coord. ref. : UTM Zone 17, Northern Hemisphere </span></span>
<span><span class="co">#&gt; source      : memory </span></span>
<span><span class="co">#&gt; name        : strata </span></span>
<span><span class="co">#&gt; min value   :      1 </span></span>
<span><span class="co">#&gt; max value   :     10</span></span></code></pre>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="strat_quantiles">
<code>strat_quantiles</code><a class="anchor" aria-label="anchor" href="#strat_quantiles"></a>
</h2>
<p>The <code><a href="../reference/strat_quantiles.html">strat_quantiles()</a></code> algorithm divides data into
equally sized strata (<code>nStrata</code>). Similar to the
<code><a href="../reference/strat_breaks.html">strat_breaks()</a></code> function, the (quantile) algorithm have the
capability to perform stratification on a single <code>mraster</code>;
users can also input a secondary <code>mraster</code>
(<code>mraster2</code>) and specify the number associated with the
desired strata (<code>nStrata2</code>). Note that the dual
stratification output will result in a product of <span class="math inline">\(nStrata * nStrata2\)</span>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- perform quantiles stratification ---#</span></span>
<span><span class="fu"><a href="../reference/strat_quantiles.html">strat_quantiles</a></span><span class="op">(</span>mraster <span class="op">=</span> <span class="va">mraster</span><span class="op">$</span><span class="va">zq90</span>,</span>
<span>                nStrata <span class="op">=</span> <span class="fl">6</span>,</span>
<span>                plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="stratification_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; class       : SpatRaster </span></span>
<span><span class="co">#&gt; dimensions  : 277, 373, 1  (nrow, ncol, nlyr)</span></span>
<span><span class="co">#&gt; resolution  : 20, 20  (x, y)</span></span>
<span><span class="co">#&gt; extent      : 431100, 438560, 5337700, 5343240  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">#&gt; coord. ref. : UTM Zone 17, Northern Hemisphere </span></span>
<span><span class="co">#&gt; source      : memory </span></span>
<span><span class="co">#&gt; name        : strata </span></span>
<span><span class="co">#&gt; min value   :      1 </span></span>
<span><span class="co">#&gt; max value   :      6</span></span>
<span></span>
<span><span class="co">#--- dual stratification - will produce 12 output strata ---#</span></span>
<span><span class="fu"><a href="../reference/strat_quantiles.html">strat_quantiles</a></span><span class="op">(</span>mraster <span class="op">=</span> <span class="va">mraster</span><span class="op">$</span><span class="va">zq90</span>, </span>
<span>                mraster2 <span class="op">=</span> <span class="va">mraster</span><span class="op">$</span><span class="va">zsd</span>,</span>
<span>                nStrata <span class="op">=</span> <span class="fl">3</span>, </span>
<span>                nStrata2 <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="co">#&gt; class       : SpatRaster </span></span>
<span><span class="co">#&gt; dimensions  : 277, 373, 1  (nrow, ncol, nlyr)</span></span>
<span><span class="co">#&gt; resolution  : 20, 20  (x, y)</span></span>
<span><span class="co">#&gt; extent      : 431100, 438560, 5337700, 5343240  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">#&gt; coord. ref. : UTM Zone 17, Northern Hemisphere </span></span>
<span><span class="co">#&gt; source      : memory </span></span>
<span><span class="co">#&gt; name        : strata </span></span>
<span><span class="co">#&gt; min value   :      1 </span></span>
<span><span class="co">#&gt; max value   :     12</span></span></code></pre>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="strat_breaks">
<code>strat_breaks</code><a class="anchor" aria-label="anchor" href="#strat_breaks"></a>
</h2>
<p><code><a href="../reference/strat_breaks.html">strat_breaks()</a></code> function stratifies the data based on the
breaks in covariates that the user defines. Single <code>mraster</code>
can be defined or additional <code>mraster2</code> can also be defined.
<code>breaks</code> and <code>breaks2</code> coincide with the user
defined breaks for <code>mraster</code> and <code>mraster2</code>
respectively.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- perform stratification using user-defined breaks ---#</span></span>
<span></span>
<span><span class="co">#--- define breaks for metric ---#</span></span>
<span><span class="va">breaks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">100</span>,<span class="fl">20</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">breaks</span></span>
<span><span class="co">#&gt; [1]   0  20  40  60  80 100</span></span>
<span></span>
<span><span class="co">#--- perform stratification using user-defined breaks ---#</span></span>
<span></span>
<span><span class="va">values</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">mraster</span><span class="op">$</span><span class="va">zq90</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#--- define breaks for metric ---#</span></span>
<span><span class="va">breaks2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">10</span>,<span class="fl">15</span>,<span class="fl">20</span>,<span class="fl">25</span><span class="op">)</span></span>
<span></span>
<span><span class="va">breaks2</span></span>
<span><span class="co">#&gt; [1]  5 10 15 20 25</span></span></code></pre></div>
<p>Once the breaks are created, we can use them as input into the
<code>strat_breaks</code> function using the <code>breaks</code> and
<code>breaks2</code> parameters.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- stratify on 1 metric only ---#</span></span>
<span><span class="fu"><a href="../reference/strat_breaks.html">strat_breaks</a></span><span class="op">(</span>mraster <span class="op">=</span> <span class="va">mraster</span><span class="op">$</span><span class="va">pzabove2</span>,</span>
<span>             breaks <span class="op">=</span> <span class="va">breaks</span>,</span>
<span>             plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="stratification_files/figure-html/unnamed-chunk-7-1.png" width="700"><img src="stratification_files/figure-html/unnamed-chunk-7-2.png" width="700"></p>
<pre><code><span><span class="co">#&gt; class       : SpatRaster </span></span>
<span><span class="co">#&gt; dimensions  : 277, 373, 1  (nrow, ncol, nlyr)</span></span>
<span><span class="co">#&gt; resolution  : 20, 20  (x, y)</span></span>
<span><span class="co">#&gt; extent      : 431100, 438560, 5337700, 5343240  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">#&gt; coord. ref. : UTM Zone 17, Northern Hemisphere </span></span>
<span><span class="co">#&gt; source      : memory </span></span>
<span><span class="co">#&gt; name        : strata </span></span>
<span><span class="co">#&gt; min value   :      1 </span></span>
<span><span class="co">#&gt; max value   :      6</span></span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- stratify on 1 metric only ---#</span></span>
<span><span class="fu"><a href="../reference/strat_breaks.html">strat_breaks</a></span><span class="op">(</span>mraster <span class="op">=</span> <span class="va">mraster</span><span class="op">$</span><span class="va">zq90</span>,</span>
<span>             breaks <span class="op">=</span> <span class="va">breaks2</span>,</span>
<span>             plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="stratification_files/figure-html/unnamed-chunk-8-1.png" width="700"><img src="stratification_files/figure-html/unnamed-chunk-8-2.png" width="700"></p>
<pre><code><span><span class="co">#&gt; class       : SpatRaster </span></span>
<span><span class="co">#&gt; dimensions  : 277, 373, 1  (nrow, ncol, nlyr)</span></span>
<span><span class="co">#&gt; resolution  : 20, 20  (x, y)</span></span>
<span><span class="co">#&gt; extent      : 431100, 438560, 5337700, 5343240  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">#&gt; coord. ref. : UTM Zone 17, Northern Hemisphere </span></span>
<span><span class="co">#&gt; source      : memory </span></span>
<span><span class="co">#&gt; name        : strata </span></span>
<span><span class="co">#&gt; min value   :      1 </span></span>
<span><span class="co">#&gt; max value   :      6</span></span></code></pre>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="strat_poly">
<code>strat_poly</code><a class="anchor" aria-label="anchor" href="#strat_poly"></a>
</h2>
<p>The <code><a href="../reference/strat_poly.html">strat_poly()</a></code> algorithm stratifies the input based on
spatial polygon attributes and features. Users may wish to stratify
based on categorical or empirical variables that are not available
through ALS data (e.g. species from forest inventory polygons). This
function allows the user to define the attribute of interest as well as
how the features within the attribute are to be grouped for
stratification.</p>
<p>Users define the input <code>poly</code> and its associated
<code>attribute</code>. A <code>raster</code> layer must be defined to
guide the spatial extent and resolution for the output stratification
polygon. Based on the vector or list of <code>features</code>,
stratification is applied and the polygon is rasterized into its
appropriate strata.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- load in polygon coverage ---#</span></span>
<span><span class="va">poly</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"inventory_polygons.shp"</span>, package <span class="op">=</span> <span class="st">"sgsR"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fri</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">st_read</a></span><span class="op">(</span><span class="va">poly</span><span class="op">)</span></span>
<span><span class="co">#&gt; Reading layer `inventory_polygons' from data source </span></span>
<span><span class="co">#&gt;   `/home/runner/work/_temp/Library/sgsR/extdata/inventory_polygons.shp' </span></span>
<span><span class="co">#&gt;   using driver `ESRI Shapefile'</span></span>
<span><span class="co">#&gt; Simple feature collection with 632 features and 3 fields</span></span>
<span><span class="co">#&gt; Geometry type: MULTIPOLYGON</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 431100 ymin: 5337700 xmax: 438560 ymax: 5343240</span></span>
<span><span class="co">#&gt; Projected CRS: UTM_Zone_17_Northern_Hemisphere</span></span></code></pre></div>
<p><code>attribute</code> column within the polygon must be defined and
the <code>features</code> (within the <code>attribute</code>) must be
specified to define the composition of the output strata. In our
demonstration below, <code>attribute = "NUTRIENTS"</code> and features
within <code>NUTRIENTS</code> (poor, rich, medium) will define the 3
desired output classes.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- stratify polygon coverage ---#</span></span>
<span><span class="co">#--- specify polygon attribute to stratify ---#</span></span>
<span></span>
<span><span class="va">attribute</span> <span class="op">&lt;-</span> <span class="st">"NUTRIENTS"</span></span>
<span></span>
<span><span class="co">#--- specify features within attribute &amp; how they should be grouped ---#</span></span>
<span><span class="co">#--- as a single vector ---#</span></span>
<span></span>
<span><span class="va">features</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"poor"</span>, <span class="st">"rich"</span>, <span class="st">"medium"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">srasterpoly</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/strat_poly.html">strat_poly</a></span><span class="op">(</span>poly <span class="op">=</span> <span class="va">fri</span>, <span class="co"># input polygon</span></span>
<span>                          attribute <span class="op">=</span> <span class="va">attribute</span>, <span class="co"># attribute to stratify by</span></span>
<span>                          features <span class="op">=</span> <span class="va">features</span>, <span class="co"># features within attribute</span></span>
<span>                          raster <span class="op">=</span> <span class="va">sraster</span>, <span class="co"># raster to define extent and resolution for output</span></span>
<span>                          plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># plot output</span></span></code></pre></div>
<p><img src="stratification_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<p><code>features</code> can be converted into amalgamated classes. In
our demonstration below, <code>rich</code> and <code>medium</code>
features are combined together, while <code>low</code> is left in
isolation. The 2 vectors are specified into a list, which will result in
the output of 2 classes (low &amp; rich/medium).</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- or as multiple lists ---#</span></span>
<span><span class="va">g1</span> <span class="op">&lt;-</span> <span class="st">"poor"</span></span>
<span><span class="va">g2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rich"</span>, <span class="st">"medium"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">features</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">g1</span>, <span class="va">g2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/strat_poly.html">strat_poly</a></span><span class="op">(</span>poly <span class="op">=</span> <span class="va">fri</span>,</span>
<span>           attribute <span class="op">=</span> <span class="va">attribute</span>,</span>
<span>           features <span class="op">=</span> <span class="va">features</span>,</span>
<span>           raster <span class="op">=</span> <span class="va">sraster</span>,</span>
<span>           plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>           details <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="stratification_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; $raster</span></span>
<span><span class="co">#&gt; class       : SpatRaster </span></span>
<span><span class="co">#&gt; dimensions  : 277, 373, 1  (nrow, ncol, nlyr)</span></span>
<span><span class="co">#&gt; resolution  : 20, 20  (x, y)</span></span>
<span><span class="co">#&gt; extent      : 431100, 438560, 5337700, 5343240  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">#&gt; coord. ref. : UTM Zone 17, Northern Hemisphere </span></span>
<span><span class="co">#&gt; source      : memory </span></span>
<span><span class="co">#&gt; name        : strata </span></span>
<span><span class="co">#&gt; min value   :      1 </span></span>
<span><span class="co">#&gt; max value   :      2 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $lookUp</span></span>
<span><span class="co">#&gt;   strata features</span></span>
<span><span class="co">#&gt; 1      1     poor</span></span>
<span><span class="co">#&gt; 2      2     rich</span></span>
<span><span class="co">#&gt; 3      2   medium</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $poly</span></span>
<span><span class="co">#&gt;  class       : SpatVector </span></span>
<span><span class="co">#&gt;  geometry    : polygons </span></span>
<span><span class="co">#&gt;  dimensions  : 524, 2  (geometries, attributes)</span></span>
<span><span class="co">#&gt;  extent      : 431100, 438560, 5337700, 5343240  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">#&gt;  coord. ref. : UTM_Zone_17_Northern_Hemisphere </span></span>
<span><span class="co">#&gt;  names       : features strata</span></span>
<span><span class="co">#&gt;  type        :    &lt;chr&gt;  &lt;int&gt;</span></span>
<span><span class="co">#&gt;  values      :     poor      1</span></span>
<span><span class="co">#&gt;                    poor      1</span></span>
<span><span class="co">#&gt;                    poor      1</span></span></code></pre>
<p>You may have noticed that the <code>details</code> parameter was
present in the demonstration code above. <code>details</code> parameter
returns the output <code>outRaster</code>, the <code>$lookUp</code>
table associated with the strata, and the polygon (<code>$poly</code>)
is created to drive the stratification based on attributes and features
specified by the users.</p>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="strat_map">
<code>strat_map</code><a class="anchor" aria-label="anchor" href="#strat_map"></a>
</h2>
<p>There are situations where multiple levels of stratification may be
sought-after. For instance, the user may wish to combine the output from
<code><a href="../reference/strat_poly.html">strat_poly()</a></code> (see the demonstration above) with 3 classes,
with the 4 class kmeans stratification generated above in this
vignette.</p>
<p>The total number of classes of the output is multiplicative of the
number of the strata. For example, if <code>sraster</code> has 3 strata
and <code>sraster2</code> has 4 strata, then the output of
<code><a href="../reference/strat_map.html">strat_map()</a></code> will be 12 strata in total. There may be
occasions where stratum do not interact spatially, this will result in
fewer output strata.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- map srasters ---#</span></span>
<span><span class="fu"><a href="../reference/strat_map.html">strat_map</a></span><span class="op">(</span>sraster <span class="op">=</span> <span class="va">srasterpoly</span>, <span class="co"># strat_poly 3 class stratification</span></span>
<span>          sraster2 <span class="op">=</span> <span class="va">sraster</span>, <span class="co"># strat_kmeans 4 class stratification</span></span>
<span>          plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="stratification_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; class       : SpatRaster </span></span>
<span><span class="co">#&gt; dimensions  : 277, 373, 1  (nrow, ncol, nlyr)</span></span>
<span><span class="co">#&gt; resolution  : 20, 20  (x, y)</span></span>
<span><span class="co">#&gt; extent      : 431100, 438560, 5337700, 5343240  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">#&gt; coord. ref. : UTM Zone 17, Northern Hemisphere </span></span>
<span><span class="co">#&gt; source      : memory </span></span>
<span><span class="co">#&gt; categories  : label </span></span>
<span><span class="co">#&gt; name        : strata </span></span>
<span><span class="co">#&gt; min value   :     11 </span></span>
<span><span class="co">#&gt; max value   :     34</span></span></code></pre>
<p>The convention for the numeric value of the output strata is the
concatenation (merging) of <code>sraster</code> strata and
<code>sraster2</code> strata. Check <code>$lookUP</code> for a clear
depiction of this step.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/strat_map.html">strat_map</a></span><span class="op">(</span>sraster <span class="op">=</span> <span class="va">srasterpoly</span>, <span class="co"># strat_poly 3 class stratification</span></span>
<span>          sraster2 <span class="op">=</span> <span class="va">sraster</span>, <span class="co"># strat_poly 3 class stratification</span></span>
<span>          stack <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># stack input and output strata into multi layer output raster</span></span>
<span>          details <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># provide additional details</span></span>
<span>          plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># plot output</span></span>
<span><span class="co">#&gt; Stacking sraster, sraster2, and their combination (stratamapped).</span></span></code></pre></div>
<p><img src="stratification_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; $raster</span></span>
<span><span class="co">#&gt; class       : SpatRaster </span></span>
<span><span class="co">#&gt; dimensions  : 277, 373, 3  (nrow, ncol, nlyr)</span></span>
<span><span class="co">#&gt; resolution  : 20, 20  (x, y)</span></span>
<span><span class="co">#&gt; extent      : 431100, 438560, 5337700, 5343240  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">#&gt; coord. ref. : UTM Zone 17, Northern Hemisphere </span></span>
<span><span class="co">#&gt; sources     : memory  </span></span>
<span><span class="co">#&gt;               memory  </span></span>
<span><span class="co">#&gt;               memory  </span></span>
<span><span class="co">#&gt; names       : strata, strata2, stratamapped </span></span>
<span><span class="co">#&gt; min values  :      1,       1,           11 </span></span>
<span><span class="co">#&gt; max values  :      3,       4,           34 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $lookUp</span></span>
<span><span class="co">#&gt;    strata strata2 stratamapped</span></span>
<span><span class="co">#&gt; 1       3       2           32</span></span>
<span><span class="co">#&gt; 2       3       1           31</span></span>
<span><span class="co">#&gt; 3       1       3           13</span></span>
<span><span class="co">#&gt; 4       1       4           14</span></span>
<span><span class="co">#&gt; 5       3       4           34</span></span>
<span><span class="co">#&gt; 6       3       3           33</span></span>
<span><span class="co">#&gt; 7       1       2           12</span></span>
<span><span class="co">#&gt; 8       1       1           11</span></span>
<span><span class="co">#&gt; 9       2       2           22</span></span>
<span><span class="co">#&gt; 10      2       3           23</span></span>
<span><span class="co">#&gt; 11      2       4           24</span></span>
<span><span class="co">#&gt; 12      2       1           21</span></span></code></pre>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://scholar.google.ca/citations?user=C_qdYDsAAAAJ&amp;hl=en" class="external-link">Tristan RH Goodbody</a>, <a href="https://forestry.ubc.ca/faculty-profile/nicholas-coops/" class="external-link">Nicholas C Coops</a>, <a href="https://www.researchgate.net/profile/Martin-Queinnec" class="external-link">Martin Queinnec</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
