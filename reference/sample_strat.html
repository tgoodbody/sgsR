<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Stratified sampling — sample_strat • sgsR</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Stratified sampling — sample_strat"><meta property="og:description" content="Sampling based on a stratified raster."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sgsR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/sgsR.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/calculating.html">calculating</a>
    </li>
    <li>
      <a href="../articles/sampling.html">sampling</a>
    </li>
    <li>
      <a href="../articles/stratification.html">stratification</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/tgoodbody/sgsR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Stratified sampling</h1>
    <small class="dont-index">Source: <a href="https://github.com/tgoodbody/sgsR/blob/HEAD/R/sample_strat.R" class="external-link"><code>R/sample_strat.R</code></a></small>
    <div class="hidden name"><code>sample_strat.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Sampling based on a stratified raster.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">sample_strat</span><span class="op">(</span>
  <span class="va">sraster</span>,
  <span class="va">nSamp</span>,
  allocation <span class="op">=</span> <span class="st">"prop"</span>,
  weights <span class="op">=</span> <span class="cn">NULL</span>,
  force <span class="op">=</span> <span class="cn">FALSE</span>,
  mraster <span class="op">=</span> <span class="cn">NULL</span>,
  mindist <span class="op">=</span> <span class="cn">NULL</span>,
  existing <span class="op">=</span> <span class="cn">NULL</span>,
  include <span class="op">=</span> <span class="cn">FALSE</span>,
  remove <span class="op">=</span> <span class="cn">FALSE</span>,
  access <span class="op">=</span> <span class="cn">NULL</span>,
  buff_inner <span class="op">=</span> <span class="cn">NULL</span>,
  buff_outer <span class="op">=</span> <span class="cn">NULL</span>,
  wrow <span class="op">=</span> <span class="fl">3</span>,
  wcol <span class="op">=</span> <span class="fl">3</span>,
  plot <span class="op">=</span> <span class="cn">FALSE</span>,
  details <span class="op">=</span> <span class="cn">FALSE</span>,
  filename <span class="op">=</span> <span class="cn">NULL</span>,
  overwrite <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>sraster</dt>
<dd><p>spatRaster. Stratification raster to be used for sampling.</p></dd>


<dt>nSamp</dt>
<dd><p>Numeric. Number of desired samples. <code>existing</code>, <code>include</code> and <code>force</code> influence this value.</p></dd>


<dt>allocation</dt>
<dd><p>Character. Allocation algorithm to be used. Either <code>prop</code> (default) for proportional allocation,
<code>optim</code> for optimal allocation (equal sampling cost), <code>equal</code> for equal number of samples (defined by <code>nSamp</code>)
for each strata, or <code>"manual"</code> for user defined strata weights defined using <code>weights</code>.</p></dd>


<dt>weights</dt>
<dd><p>Numeric. Only applicable when <code>allocation = "manual"</code>. Vector of weights where <code>sum(weights) == 1</code>. Vector length
must be equal to the number of unique strata where the first numeric value corresponds to stratum 1, second stratum 2 etc.</p></dd>


<dt>force</dt>
<dd><p>Logical. <code>Default = FALSE</code> - force <code>nSamp</code> to be exactly the user defined value
in cases where <code>nSamp</code> and <code>sraster</code> strata count are not equally divisible. Additional samples often need to be allocated or removed
based on rounding differences resulting from proportional differences between <code>nSamp</code> and strata coverages in <code>sraster</code>.
In these instances samples are either added to strata with the lowest number of samples or are removed from strata with the highest number of samples.
Has no effect when <code>existing</code> is provided.</p></dd>


<dt>mraster</dt>
<dd><p>spatRaster. ALS metric raster. Required when <code>allocation = optim</code>.</p></dd>


<dt>mindist</dt>
<dd><p>Numeric. Minimum allowable distance between selected
samples. <code>Default = NULL</code>.</p></dd>


<dt>existing</dt>
<dd><p>sf 'POINT' or data.frame.  Existing plot network.</p></dd>


<dt>include</dt>
<dd><p>Logical. If <code>TRUE</code> include <code>existing</code> plots in <code>nSamp</code> total.</p></dd>


<dt>remove</dt>
<dd><p>Logical. If <code>TRUE</code> randomly remove samples from over represented strata to meet allocated sample numbers.
Used only when <code>existing</code> and <code>include</code> are both <code>TRUE</code>.</p></dd>


<dt>access</dt>
<dd><p>sf 'LINESTRING' or 'MULTILINESTRING'. Access network.</p></dd>


<dt>buff_inner</dt>
<dd><p>Numeric. Inner buffer boundary specifying distance
from access where plots cannot be sampled.</p></dd>


<dt>buff_outer</dt>
<dd><p>Numeric. Outer buffer boundary specifying distance
from access where plots can be sampled.</p></dd>


<dt>wrow</dt>
<dd><p>Numeric. Number of row in the focal window (<code>default = 3</code>).</p></dd>


<dt>wcol</dt>
<dd><p>Numeric. Number of columns in the focal window (<code>default = 3</code>).</p></dd>


<dt>plot</dt>
<dd><p>Logical. Plots samples of type `existing` (if provided; croses) and `new` (circles) along with <code>sraster</code>.</p></dd>


<dt>details</dt>
<dd><p>Logical. If <code>FALSE</code> (default) output is sf object of
stratified samples. If <code>TRUE</code> return a list
where <code>$details</code> additional sampling information and <code>$raster</code>
is an sf object of stratified samples.</p></dd>


<dt>filename</dt>
<dd><p>Character. Path to write output samples.</p></dd>


<dt>overwrite</dt>
<dd><p>Logical. Choice to overwrite existing <code>filename</code> if it exists.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>An sf object with <code>nSamp</code> stratified samples.</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>The sampling is performed in 2 stages:</p><ol><li><p><code>Rule 1</code> - Sample within grouped stratum pixels defined within the
<code>wrow, wcol</code> parameters</p></li>
<li><p><code>Rule 2</code> - If no samples exist to satisfy Rule 1
 individual stratum pixels are sampled.</p>
<p>The rule applied to allocate each sample is defined in the <code>rule</code> attribute of output samples.</p></li>
</ol><p><code>existing</code> may contain samples that fall in <code>sraster</code> cells that are `NA`. If this occurs and <code>include = TRUE</code>, `NA` samples
are separated during sampling and re-appended at the end of the sampling process.</p>
<p>If the <code>sraster</code> provided contains factor values, the algorithm will automatically convert these into the numeric factor levels and 
perform sampling using those values. The categories (factor values) will be extracted and appended to the algorithm output as the `category` attribute.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Queinnec, M., White, J. C., &amp; Coops, N. C. (2021).
Comparing airborne and spaceborne photon-counting LiDAR canopy
structural estimates across different boreal forest types.
Remote Sensing of Environment, 262 (August 2020), 112510.
https://doi.org/10.1016/j.rse.2021.112510</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>Other sample functions: 
<code><a href="sample_ahels.html">sample_ahels</a>()</code>,
<code><a href="sample_balanced.html">sample_balanced</a>()</code>,
<code><a href="sample_clhs.html">sample_clhs</a>()</code>,
<code><a href="sample_srs.html">sample_srs</a>()</code>,
<code><a href="sample_systematic.html">sample_systematic</a>()</code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Tristan R.H. Goodbody &amp; Martin Queinnec</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co">#--- Load raster and access files ---#</span></span>
<span class="r-in"><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"sraster.tif"</span>, package <span class="op">=</span> <span class="st">"sgsR"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">sr</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">#--- perform stratified sampling random sampling ---#</span></span>
<span class="r-in"><span class="va">sraster</span> <span class="op">&lt;-</span> <span class="fu">sample_strat</span><span class="op">(</span></span>
<span class="r-in">  sraster <span class="op">=</span> <span class="va">sr</span>,</span>
<span class="r-in">  nSamp <span class="op">=</span> <span class="fl">50</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Implementing proportional allocation of samples.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> nSamp of 50 is not perfectly divisible based on strata distribution. nSamp of 51 will be returned. Use 'force = TRUE' to brute force to 50.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Processing strata : 1</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Processing strata : 2</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Processing strata : 3</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Processing strata : 4</span>
<span class="r-in"></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Tristan RH Goodbody, Nicholas C Coops, Martin Queinnec.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.4.</p>
</div>

      </footer></div>

  


  

  </body></html>

