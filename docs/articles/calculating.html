<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>calculating • sgsR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="calculating">
<meta property="og:description" content="Learn how to use calculate_* functions.
">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sgsR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/sgsR.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/calculating.html">calculating</a>
    </li>
    <li>
      <a href="../articles/sampling.html">sampling</a>
    </li>
    <li>
      <a href="../articles/stratification.html">stratification</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>calculating</h1>
            
      
      
      <div class="hidden name"><code>calculating.Rmd</code></div>

    </div>

    
    
<div class="section level1 unnumbered">
<h1 class="unnumbered" id="calc">
<code>calculate_*</code> functions<a class="anchor" aria-label="anchor" href="#calc"></a>
</h1>
<p>A total of 7 <code>calculate</code> functions currently exist in the package:</p>
<ul>
<li><p><code>calculate_distance</code> - per pixel distance to closest access vector</p></li>
<li><p><code>calculate_pcomp</code>- calculate principal components on input <code>mraster</code></p></li>
<li><p><code>calculate_allocation</code> - calculate the number of samples needed for samples within an <code>sraster</code> - proportional / optimal / equal sampling</p></li>
<li><p><code>calculate_ahels</code> - apply the adapted Hypercube Evaluation of a Legacy Sample (ahels) algorithm to existing samples</p></li>
<li><p><code>calculate_coobs</code> - apply count of observations algorithm to existing samples</p></li>
<li><p><code>calculate_lhsPop</code> - calculate population covariate statistics for latin hypercube sampling</p></li>
<li><p><code>calculate_lhsOpt</code> - calculate optimal latin hypercube sampling paramters including sample number</p></li>
</ul>
<p>As mentioned in a few locations throughout this <code>sgsR</code> tutorial, the <code>calculate_*</code> functions serve as helper functions. In this section we outline how these functions can be used.</p>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="dist">
<code>calculate_distance</code><a class="anchor" aria-label="anchor" href="#dist"></a>
</h2>
<p>The <code>calculate_distance</code> function take input <code>raster</code> and <code>access</code> data and outputs a per pixel distance to the nearest access point. This function has particular value for constraining sampling protocols such the <a href="#clhs"><code>sample_clhs</code></a> function where the output raster layer can be used as a <code>cost</code> constraint.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/calculate_distance.html">calculate_distance</a></span><span class="op">(</span>raster <span class="op">=</span> <span class="va">sraster</span>, <span class="co"># input</span>
                   access <span class="op">=</span> <span class="va">access</span>, <span class="co"># define access road network</span>
                   plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># plot</span></code></pre></div>
<p><img src="calculating_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<pre><code><span class="co">#&gt; class       : SpatRaster </span>
<span class="co">#&gt; dimensions  : 277, 373, 2  (nrow, ncol, nlyr)</span>
<span class="co">#&gt; resolution  : 20, 20  (x, y)</span>
<span class="co">#&gt; extent      : 431100, 438560, 5337700, 5343240  (xmin, xmax, ymin, ymax)</span>
<span class="co">#&gt; coord. ref. : +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs </span>
<span class="co">#&gt; sources     : memory  </span>
<span class="co">#&gt;               memory  </span>
<span class="co">#&gt; names       : strata, dist2access </span>
<span class="co">#&gt; min values  :      1,           0 </span>
<span class="co">#&gt; max values  :      4,        1060</span></code></pre>
<p>The output raster is the input with the calculated <code>dist2access</code> layer appended.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/calculate_distance.html">calculate_distance</a></span><span class="op">(</span>raster <span class="op">=</span> <span class="va">mraster</span>, <span class="co"># input</span>
                   access <span class="op">=</span> <span class="va">access</span>, <span class="co"># define access road network</span>
                   filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".tif"</span><span class="op">)</span><span class="op">)</span> <span class="co"># write file to disc</span>
<span class="co">#&gt; class       : SpatRaster </span>
<span class="co">#&gt; dimensions  : 277, 373, 10  (nrow, ncol, nlyr)</span>
<span class="co">#&gt; resolution  : 20, 20  (x, y)</span>
<span class="co">#&gt; extent      : 431100, 438560, 5337700, 5343240  (xmin, xmax, ymin, ymax)</span>
<span class="co">#&gt; coord. ref. : +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs </span>
<span class="co">#&gt; sources     : wall_metrics.tif  (9 layers) </span>
<span class="co">#&gt;               memory  </span>
<span class="co">#&gt; names       :    zmax,   zmean,     zsd, pzabove2,    zq20,    zq50, ... </span>
<span class="co">#&gt; min values  :       0,       0,       0,        0,       0,       0, ... </span>
<span class="co">#&gt; max values  :   23.82,  100.00,   25.71,    18.08,   21.02,   27.60, ...</span></code></pre></div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="calculate_pcomp">
<code>calculate_pcomp</code><a class="anchor" aria-label="anchor" href="#calculate_pcomp"></a>
</h2>
<p>The <code>calculate_pcomp</code> function take a <code>mraster</code> as input and perform principal component analysis. The number of components defined by the <code>nComp</code> parameter specify the number of components that should be rasterized to output.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/calculate_pcomp.html">calculate_pcomp</a></span><span class="op">(</span>mraster <span class="op">=</span> <span class="va">mraster</span>, <span class="co"># input</span>
                nComp <span class="op">=</span> <span class="fl">5</span>, <span class="co"># number of components to output</span>
                plot <span class="op">=</span> <span class="cn">TRUE</span> <span class="op">)</span> <span class="co"># plot</span></code></pre></div>
<p><img src="calculating_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<pre><code><span class="co">#&gt; class       : SpatRaster </span>
<span class="co">#&gt; dimensions  : 277, 373, 5  (nrow, ncol, nlyr)</span>
<span class="co">#&gt; resolution  : 20, 20  (x, y)</span>
<span class="co">#&gt; extent      : 431100, 438560, 5337700, 5343240  (xmin, xmax, ymin, ymax)</span>
<span class="co">#&gt; coord. ref. : +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs </span>
<span class="co">#&gt; sources     : memory  </span>
<span class="co">#&gt;               memory  </span>
<span class="co">#&gt;               memory  </span>
<span class="co">#&gt;               ... and 2 more source(s)</span>
<span class="co">#&gt; names       :        PC1,        PC2,        PC3,        PC4,        PC5 </span>
<span class="co">#&gt; min values  :  -6.675657, -14.741405,  -1.735068,  -9.384677,  -1.272558 </span>
<span class="co">#&gt; max values  :  13.828171,   4.197435,   4.022076,   1.821104,   2.243303</span></code></pre>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/calculate_pcomp.html">calculate_pcomp</a></span><span class="op">(</span>mraster <span class="op">=</span> <span class="va">mraster</span>, <span class="co"># input</span>
                nComp <span class="op">=</span> <span class="fl">3</span>, <span class="co"># number of components to output</span>
                plot <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># plot</span>
                details <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># details about the principal component analysis appended</span></code></pre></div>
<p><img src="calculating_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<pre><code><span class="co">#&gt; $pca</span>
<span class="co">#&gt; Standard deviations (1, .., p=9):</span>
<span class="co">#&gt; [1] 2.66328897 1.09805898 0.66339469 0.41858538 0.22109594 0.14478794</span>
<span class="co">#&gt; [7] 0.09669328 0.07739106 0.02581106</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Rotation (n x k) = (9 x 9):</span>
<span class="co">#&gt;                PC1         PC2         PC3         PC4         PC5</span>
<span class="co">#&gt; zmax     0.3718561  0.05890652  0.13655303  0.18644188 -0.02967021</span>
<span class="co">#&gt; zmean    0.2892076  0.11179079 -0.94037185  0.11669464 -0.01101177</span>
<span class="co">#&gt; zsd      0.2902484 -0.57132611  0.07358411 -0.03485495 -0.12710815</span>
<span class="co">#&gt; pzabove2 0.2762415  0.57389014  0.11046261 -0.48982874 -0.53278380</span>
<span class="co">#&gt; zq20     0.3222793  0.42913513  0.17765055  0.04688184  0.69772164</span>
<span class="co">#&gt; zq50     0.3621931  0.06711670  0.16260903  0.50497308 -0.03554264</span>
<span class="co">#&gt; zq70     0.3669446 -0.07622676  0.13483825  0.33474905 -0.33679147</span>
<span class="co">#&gt; zq90     0.3576125 -0.24286784  0.04467110 -0.28486752  0.00494469</span>
<span class="co">#&gt; zq95     0.3463317 -0.27351876 -0.03548477 -0.50997312  0.31217248</span>
<span class="co">#&gt;                   PC6          PC7         PC8          PC9</span>
<span class="co">#&gt; zmax     -0.022902433  0.058181544  0.12813760 -0.885232514</span>
<span class="co">#&gt; zmean     0.061423536  0.005559276 -0.04493042  0.001085691</span>
<span class="co">#&gt; zsd       0.373461072 -0.062831197 -0.65029797 -0.015746780</span>
<span class="co">#&gt; pzabove2  0.007219003  0.005909104 -0.23569527  0.052045306</span>
<span class="co">#&gt; zq20      0.371793616 -0.128585416 -0.12943905  0.141020587</span>
<span class="co">#&gt; zq50     -0.525190662  0.398814446 -0.24627692  0.293390931</span>
<span class="co">#&gt; zq70      0.136444231 -0.587797301  0.42249155  0.270652072</span>
<span class="co">#&gt; zq90      0.287643242  0.607152727  0.49439800  0.184814994</span>
<span class="co">#&gt; zq95     -0.583751620 -0.320739852  0.05279230  0.005601089</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $raster</span>
<span class="co">#&gt; class       : SpatRaster </span>
<span class="co">#&gt; dimensions  : 277, 373, 3  (nrow, ncol, nlyr)</span>
<span class="co">#&gt; resolution  : 20, 20  (x, y)</span>
<span class="co">#&gt; extent      : 431100, 438560, 5337700, 5343240  (xmin, xmax, ymin, ymax)</span>
<span class="co">#&gt; coord. ref. : +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs </span>
<span class="co">#&gt; sources     : memory  </span>
<span class="co">#&gt;               memory  </span>
<span class="co">#&gt;               memory  </span>
<span class="co">#&gt; names       :        PC1,        PC2,        PC3 </span>
<span class="co">#&gt; min values  :  -6.675657, -14.741405,  -1.735068 </span>
<span class="co">#&gt; max values  :  13.828171,   4.197435,   4.022076</span></code></pre>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="calculate_allocation">
<code>calculate_allocation</code><a class="anchor" aria-label="anchor" href="#calculate_allocation"></a>
</h2>
<p>The <code>calculate_allocation</code> function calculates the total number of samples that should be allocated based on a total sample value (<code>nSamp</code>) and an input <code>sraster</code>. This function is utilized in a number of functions including <a href="#strat"><code>sample_strat</code></a>. Two methods for allocation are currently included: proportional (<code>prop</code>), and optimal (<code>optim</code>) allocation.</p>
<ul>
<li>Proportional - Samples are allocated based on the area coverage of strata. This is the default method.</li>
<li>Optimal - Samples are allocated based on the within strata variation.</li>
<li>Equal - The same number of samples (<code>nSamp</code>) are allocated to each strata.</li>
</ul>
<div class="section level3 unnumbered">
<h3 class="unnumbered" id="proportional">Proportional Allocation<a class="anchor" aria-label="anchor" href="#proportional"></a>
</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#--- perform grid sampling ---#</span>
<span class="fu"><a href="../reference/calculate_allocation.html">calculate_allocation</a></span><span class="op">(</span>sraster <span class="op">=</span> <span class="va">sraster</span>, 
                     nSamp <span class="op">=</span> <span class="fl">200</span><span class="op">)</span>
<span class="co">#&gt;   strata total</span>
<span class="co">#&gt; 1      1    72</span>
<span class="co">#&gt; 2      2    46</span>
<span class="co">#&gt; 3      3    42</span>
<span class="co">#&gt; 4      4    40</span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#--- calculate existing samples to include ---#</span>
<span class="va">e.sr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract.html">extract_strata</a></span><span class="op">(</span>sraster <span class="op">=</span> <span class="va">sraster</span>, 
                       existing <span class="op">=</span> <span class="va">existing</span><span class="op">)</span>

<span class="fu"><a href="../reference/calculate_allocation.html">calculate_allocation</a></span><span class="op">(</span>sraster <span class="op">=</span> <span class="va">sraster</span>, 
                     nSamp <span class="op">=</span> <span class="fl">200</span>, 
                     existing <span class="op">=</span> <span class="va">e.sr</span><span class="op">)</span>
<span class="co">#&gt;   strata total need</span>
<span class="co">#&gt; 1      1    -6   72</span>
<span class="co">#&gt; 2      2    -9   46</span>
<span class="co">#&gt; 3      3     3   42</span>
<span class="co">#&gt; 4      4    12   40</span></code></pre></div>
<p>Notice that some of the results in <code>total</code> above are negative. This indicates that the <code>existing</code> samples over represent those strata and that some samples should be removed to avoid over representation.</p>
</div>
<div class="section level3 unnumbered">
<h3 class="unnumbered" id="Optimal">Optimal Allocation<a class="anchor" aria-label="anchor" href="#Optimal"></a>
</h3>
<p>Proportional allocation determine the number of samples based on the weights of strata. Optimal allocation utilizes within strata variation to allocate samples. This means that in addition to providing and <code>sraster</code>, that an <code>mraster</code> and a specific metric must be provided to calculate variation and appropriately allocate samples.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/calculate_allocation.html">calculate_allocation</a></span><span class="op">(</span>sraster <span class="op">=</span> <span class="va">sraster</span>, <span class="co"># stratified raster</span>
                     nSamp <span class="op">=</span> <span class="fl">200</span>, <span class="co"># desired sample number</span>
                     existing <span class="op">=</span> <span class="va">e.sr</span>, <span class="co">#existing samples</span>
                     allocation <span class="op">=</span> <span class="st">"optim"</span>, <span class="co"># optimal allocation</span>
                     mraster <span class="op">=</span> <span class="va">mraster</span><span class="op">$</span><span class="va">zmax</span>, <span class="co"># metric raster</span>
                     force <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># force nSamp number</span>
<span class="co">#&gt;   strata total need</span>
<span class="co">#&gt; 1      1   -11   67</span>
<span class="co">#&gt; 2      2    -2   53</span>
<span class="co">#&gt; 3      3    -9   30</span>
<span class="co">#&gt; 4      4    22   50</span></code></pre></div>
</div>
<div class="section level3 unnumbered">
<h3 class="unnumbered" id="equal">Equal allocation<a class="anchor" aria-label="anchor" href="#equal"></a>
</h3>
<p>There may be an instance where a user wants to have the same number of samples allocated to each strata. In this case using <code>allocation = equal</code> is ideal.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/sample_strat.html">sample_strat</a></span><span class="op">(</span>sraster <span class="op">=</span> <span class="va">sraster</span>, <span class="co"># stratification raster</span>
             nSamp <span class="op">=</span> <span class="fl">20</span>, <span class="co"># desired number of samples for each strata</span>
             mindist <span class="op">=</span> <span class="fl">400</span>, <span class="co"># minimul distance between samples</span>
             allocation <span class="op">=</span> <span class="st">"equal"</span>, <span class="co"># allocation type</span>
             plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># plot output</span>
<span class="co">#&gt; Processing strata : 1</span>
<span class="co">#&gt; Processing strata : 2</span>
<span class="co">#&gt; Processing strata : 3</span>
<span class="co">#&gt; Processing strata : 4</span></code></pre></div>
<p><img src="calculating_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<pre><code><span class="co">#&gt; Simple feature collection with 80 features and 3 fields</span>
<span class="co">#&gt; Geometry type: POINT</span>
<span class="co">#&gt; Dimension:     XY</span>
<span class="co">#&gt; Bounding box:  xmin: 431150 ymin: 5337730 xmax: 438530 ymax: 5343190</span>
<span class="co">#&gt; CRS:           +proj=utm +zone=17 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs</span>
<span class="co">#&gt; First 10 features:</span>
<span class="co">#&gt;    strata type  rule               geometry</span>
<span class="co">#&gt; x       1  new rule1 POINT (437990 5339870)</span>
<span class="co">#&gt; x1      1  new rule1 POINT (434310 5341190)</span>
<span class="co">#&gt; x2      1  new rule1 POINT (435190 5340250)</span>
<span class="co">#&gt; x3      1  new rule1 POINT (437050 5339830)</span>
<span class="co">#&gt; x4      1  new rule1 POINT (433470 5342330)</span>
<span class="co">#&gt; x5      1  new rule1 POINT (432510 5341350)</span>
<span class="co">#&gt; x6      1  new rule1 POINT (432250 5338070)</span>
<span class="co">#&gt; x7      1  new rule1 POINT (432210 5339470)</span>
<span class="co">#&gt; x8      1  new rule1 POINT (432210 5342790)</span>
<span class="co">#&gt; x9      1  new rule1 POINT (437210 5338390)</span></code></pre>
<p>That yields a total of 80 samples (20 <code>nSamp</code> for each of the 4 strata in <code>sraster</code>.)</p>
</div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="sampeval">Sample evaluation algorithms<a class="anchor" aria-label="anchor" href="#sampeval"></a>
</h2>
<p>The following algorithms were initially developed by Dr. Brendan Malone from the University of Sydney. In their work they graciously provided an in depth description of the functionality of these algorithms that were originally developed to improve soil sampling strategies. I have taken the initial scripts Dr. Malone provided to the community and implemented functions so they can be used for structurally guided sampling approaches. Many thanks to Dr. Malone for being an excellent collaborator and proponent of open source algorithms.</p>
<p>Please consult the original reference for these ideas and scripts as they are extremely valuable and helpful for understanding their sampling rationale.</p>
<p><em>Malone BP, Minansy B, Brungard C. 2019. Some methods to improve the utility of conditioned Latin hypercube sampling. PeerJ 7:e6451 DOI 10.7717/peerj.6451</em></p>
<div class="section level3 unnumbered">
<h3 class="unnumbered" id="coobs">
<code>calculate_coobs</code><a class="anchor" aria-label="anchor" href="#coobs"></a>
</h3>
<p>The <code>calculate_coobs</code> function perform the COunt of OBServations (coobs) algorithm using <code>existing</code> sample data and <code>mraster</code> covariates. This algorithm aids the user in determining where additional samples could be located by comparing <code>existing</code> samples to each pixel and associated <code>mraster</code> covariates. The output coobs raster could be used to constrain clhs sampling using the <a href="#clhs"><code>sample_clhs</code></a> to areas that are underreprented.</p>
<p>The coobs raster determines how many observations are similar in terms of the covariate space at every pixel. Given that this is fairly computationally intensive, I have implemented parallel processing for this function, but users should be patient to allow processing to complete.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/calculate_coobs.html">calculate_coobs</a></span><span class="op">(</span>mraster <span class="op">=</span> <span class="va">mraster</span>, <span class="co"># input</span>
                existing <span class="op">=</span> <span class="va">existing</span>, <span class="co"># existing samples</span>
                cores <span class="op">=</span> <span class="fl">4</span>, <span class="co"># parallel cores to use</span>
                details <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># provide details from algorithm output</span>
                plot <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># plot</span>
                filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".tif"</span><span class="op">)</span><span class="op">)</span> <span class="co"># write output raster to tif</span></code></pre></div>
</div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="lhseval">Latin hypercube sampling evaluation algorithms<a class="anchor" aria-label="anchor" href="#lhseval"></a>
</h2>
<p>The following 2 algorithms provide a means to maximize the effectiveness of <a href="#clhs">latin hypercube sampling</a> protocols.</p>
<div class="section level3 unnumbered">
<h3 class="unnumbered" id="lhspop">
<code>calculate_lhsPop</code><a class="anchor" aria-label="anchor" href="#lhspop"></a>
</h3>
<p>The <code>calculate_lhsPop</code> function calculates population level statistics about the <code>mraster</code> covariates being used including calculating principal components, quantile distributions, and Kullback–Leibler divergence testing. The outputs from this function are mandatory for use of the <a href="#lhsopt"><code>calculate_lhsOpt</code></a> function described in the next section.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#--- by default all statistical data are calculated ---#</span>
<span class="fu"><a href="../reference/calculate_lhsPop.html">calculate_lhsPop</a></span><span class="op">(</span>mraster <span class="op">=</span> <span class="va">mraster</span><span class="op">)</span> <span class="co"># input </span></code></pre></div>
<p>The output details the following:</p>
<ul>
<li><p><code>$values</code> - Pixel values from <code>mraster</code></p></li>
<li><p><code>$pcaLoad</code> - PCA loadings</p></li>
<li><p><code>$matQ</code> - Quantile matrix</p></li>
<li><p><code>$matCov</code> - Covariate matrix</p></li>
</ul>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#--- statistical analyses can be chose by setting their parameter to `FALSE` ---#</span>
<span class="fu"><a href="../reference/calculate_lhsPop.html">calculate_lhsPop</a></span><span class="op">(</span>mraster <span class="op">=</span> <span class="va">mraster</span>, <span class="co"># input </span>
                 nQuant <span class="op">=</span> <span class="fl">10</span>, <span class="co"># desired number of quantiles</span>
                 PCA <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="co"># choose not to calculate PCA's</span></code></pre></div>
</div>
<div class="section level3 unnumbered">
<h3 class="unnumbered" id="lhsopt">
<code>calculate_lhsOpt</code><a class="anchor" aria-label="anchor" href="#lhsopt"></a>
</h3>
<p>The <code>calculate_lhsOpt</code> function performs an bootsrapped latin hypercube sampling approach where a population level analysis of <code>mraster</code> data is performed to determine the optimal Latin hypercube sample size.</p>
<p>Using statistical data calculated using the <code>calculate_lhsPop</code> and varying sample sizes defined by <code>minSamp</code>, <code>maxSamp</code>, <code>step</code> and <code>rep</code>. Sampling protocols are conducted and statistical effectiveness of those sampling outcomes are evaluated to determine where sample size is minimized and statistical representation is maximized.</p>
<p>This function is currently fairly slow to run as parallel is still being implemented.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#--- calculate lhsPop details ---#</span>
<span class="va">poplhs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_lhsPop.html">calculate_lhsPop</a></span><span class="op">(</span>mraster <span class="op">=</span> <span class="va">mr</span><span class="op">)</span>

<span class="fu"><a href="../reference/calculate_lhsOpt.html">calculate_lhsOpt</a></span><span class="op">(</span>popLHS <span class="op">=</span> <span class="va">poplhs</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/calculate_lhsOpt.html">calculate_lhsOpt</a></span><span class="op">(</span>popLHS <span class="op">=</span> <span class="va">poplhs</span>, 
                 PCA <span class="op">=</span> <span class="cn">FALSE</span>, 
                 iter <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></code></pre></div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="https://scholar.google.ca/citations?user=C_qdYDsAAAAJ&amp;hl=en" class="external-link">Tristan RH Goodbody</a>, <a href="https://forestry.ubc.ca/faculty-profile/nicholas-coops/" class="external-link">Nicholas C Coops</a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.9000.9000.9000.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
